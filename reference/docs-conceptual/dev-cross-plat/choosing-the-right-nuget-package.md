---
title: Auswählen des richtigen PowerShell NuGet-Pakets für Ihr .NET-Projekt
description: Zusätzlich zu den mit jedem PowerShell-Release veröffentlichten ausführbaren Paketen verwaltet das PowerShell-Team auch mehrere Pakete, die für NuGet verfügbar sind. Damit kann PowerShell als API-Plattform in .NET genutzt werden.
ms.date: 06/25/2020
ms.custom: rjmholt
ms.openlocfilehash: 39369ed872faa76ad2c41d813da5e0a98cf1c078
ms.sourcegitcommit: d0461273abb6db099c5e784ef00f57fd551be4a6
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/01/2020
ms.locfileid: "85795285"
---
# <a name="choosing-the-right-powershell-nuget-package-for-your-net-project"></a><span data-ttu-id="f5efc-104">Auswählen des richtigen PowerShell NuGet-Pakets für Ihr .NET-Projekt</span><span class="sxs-lookup"><span data-stu-id="f5efc-104">Choosing the right PowerShell NuGet package for your .NET project</span></span>

<span data-ttu-id="f5efc-105">Zusätzlich zu den mit jedem PowerShell-Release veröffentlichten ausführbaren `pwsh`-Paketen verwaltet das PowerShell-Team auch mehrere Pakete, die für [NuGet][] verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="f5efc-105">Alongside the `pwsh` executable packages published with each PowerShell release, the PowerShell team also maintains several packages available on [NuGet][].</span></span> <span data-ttu-id="f5efc-106">Damit kann PowerShell als API-Plattform in .NET genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-106">These packages allow targeting PowerShell as an API platform in .NET.</span></span>

<span data-ttu-id="f5efc-107">Damit PowerShell als .NET-Anwendung APIs bereitstellen und .NET-Bibliotheken laden kann, die eigene APIs (binäre Module) implementieren, muss es unbedingt in Form eines NuGet-Pakets verfügbar sein.</span><span class="sxs-lookup"><span data-stu-id="f5efc-107">As a .NET application that provides APIs and expects to load .NET libraries implementing its own (binary modules), it's essential that PowerShell be available in the form of a NuGet package.</span></span>

<span data-ttu-id="f5efc-108">Zurzeit enthalten mehrere NuGet-Pakete eine Darstellung der API-Oberfläche von PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f5efc-108">Currently there are several NuGet packages that provide some representation of the PowerShell API surface area.</span></span> <span data-ttu-id="f5efc-109">Dabei ist nicht immer klar erkennbar, welches Paket für ein bestimmtes Projekt geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="f5efc-109">Which package to use with a particular project hasn't always been made clear.</span></span> <span data-ttu-id="f5efc-110">In diesem Artikel werden einige häufige Szenarios für .NET-Projekte beschrieben, die PowerShell verwenden, sowie die Vorgehensweise bei der Auswahl des für Ihr .NET-Projekt geeigneten NuGet-Pakets.</span><span class="sxs-lookup"><span data-stu-id="f5efc-110">This article sheds some light on a few common scenarios for PowerShell-targeting .NET projects and how to choose the right NuGet package to target for your PowerShell-oriented .NET project.</span></span>

## <a name="hosting-vs-referencing"></a><span data-ttu-id="f5efc-111">Unterscheidung zwischen Hosting und Verweisen</span><span class="sxs-lookup"><span data-stu-id="f5efc-111">Hosting vs referencing</span></span>

<span data-ttu-id="f5efc-112">Bei einigen .NET-Projekten soll der geschriebene Code in eine vorhandene PowerShell-Laufzeit geladen werden (z. B. `pwsh`, `powershell.exe`, die integrierte PowerShell-Konsole oder die ISE), bei anderen soll PowerShell hingegen in einer eigenen Anwendung ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-112">Some .NET projects seek to write code to be loaded into a pre-existing PowerShell runtime (such as `pwsh`, `powershell.exe`, the PowerShell Integrated Console or the ISE), while others want to run PowerShell in their own applications.</span></span>

- <span data-ttu-id="f5efc-113">**Verweise** eignen sich für ein Projekt (in der Regel ein Modul), das in PowerShell geladen werden soll.</span><span class="sxs-lookup"><span data-stu-id="f5efc-113">**Referencing** is for when a project, usually a module, is intended to be loaded into PowerShell.</span></span>
  <span data-ttu-id="f5efc-114">Das Projekt muss für die von PowerShell bereitgestellten APIs kompiliert werden, damit eine Interaktion möglich ist. Dabei wird die PowerShell-Implementierung vom PowerShell-Prozess bereitgestellt, durch den es geladen wird.</span><span class="sxs-lookup"><span data-stu-id="f5efc-114">It must be compiled against the APIs that PowerShell provides in order to interact with it, but the PowerShell implementation is supplied by the PowerShell process loading it in.</span></span> <span data-ttu-id="f5efc-115">Für Verweise können vom Projekt als Kompilierungsziel [Verweisassemblys][] oder die tatsächlichen Laufzeitassemblys verwendet werden. Diese dürfen jedoch nicht mit dem Build veröffentlicht werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-115">For referencing, a project can use [reference assemblies][] or the actual runtime assemblies as a compilation target, but must ensure that it does not publish any of these with its build.</span></span>
- <span data-ttu-id="f5efc-116">Beim **Hosting** ist für ein Projekt eine eigene Implementierung von PowerShell erforderlich, da es sich dabei in der Regel um eine eigenständige Anwendung handelt, die PowerShell ausführen muss.</span><span class="sxs-lookup"><span data-stu-id="f5efc-116">**Hosting** is when a project needs its own implementation of PowerShell, usually because it is a standalone application that needs to run PowerShell.</span></span> <span data-ttu-id="f5efc-117">In diesem Fall können keine reinen Verweisassemblys verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-117">In this case, pure reference assemblies cannot be used.</span></span> <span data-ttu-id="f5efc-118">Stattdessen ist eine konkrete PowerShell-Implementierung erforderlich.</span><span class="sxs-lookup"><span data-stu-id="f5efc-118">Instead, a concrete PowerShell implementation must be depended upon.</span></span> <span data-ttu-id="f5efc-119">Aus diesem Grund muss für das Hosting eine bestimmte PowerShell-Version ausgewählt werden. Eine einzelne Hostanwendung kann nicht mehrere PowerShell-Versionen als Ziel verwenden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-119">Because a concrete PowerShell implementation must be used, a specific version of PowerShell must be chosen for hosting; a single host application cannot multi-target PowerShell versions.</span></span>

### <a name="publishing-projects-that-target-powershell-as-a-reference"></a><span data-ttu-id="f5efc-120">Veröffentlichen von Projekten, die auf PowerShell verweisen</span><span class="sxs-lookup"><span data-stu-id="f5efc-120">Publishing projects that target PowerShell as a reference</span></span>

> [!NOTE]
> <span data-ttu-id="f5efc-121">In diesem Artikel bezieht sich der Ausdruck **Veröffentlichen** auf das Ausführen des Befehls `dotnet publish`, mit dem eine .NET-Bibliothek mit allen Abhängigkeiten in ein Verzeichnis platziert wird, von wo aus sie zu einer bestimmten Laufzeit bereitgestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="f5efc-121">We use the term **publish** in this article to refer to running `dotnet publish`, which places a .NET library into a directory with all of its dependencies, ready for deployment to a particular runtime.</span></span>

<span data-ttu-id="f5efc-122">Damit Projektabhängigkeiten, die nur als Verweisziele für die Kompilierung verwendet werden, nicht veröffentlicht werden, wird das Festlegen des Attributs [PrivateAssets][] empfohlen:</span><span class="sxs-lookup"><span data-stu-id="f5efc-122">In order to prevent publishing project dependencies that are just being used as compilation reference targets, it is recommended to set the [PrivateAssets attribute][]:</span></span>

```xml
<PackageReference Include="PowerShellStandard.Library" Version="5.1.0.0" PrivateAssets="all" />
```

<span data-ttu-id="f5efc-123">Andernfalls entstehen bei Verwendung einer Verweisassembly als Ziel möglicherweise Probleme im Zusammenhang mit der Verwendung der Standardimplementierung der Verweisassembly anstelle der eigentlichen Implementierung.</span><span class="sxs-lookup"><span data-stu-id="f5efc-123">If you forget to do this and use a reference assembly as your target, you may see issues related to using the reference assembly's default implementation instead of the actual implementation.</span></span> <span data-ttu-id="f5efc-124">Dabei kann etwa `NullReferenceException` ausgelöst werden, da Verweisassemblys die Implementierungs-API häufig durch Rückgabe von `null` täuschen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-124">This may take the form of a `NullReferenceException`, since reference assemblies often mock the implementation API by simply returning `null`.</span></span>

## <a name="key-kinds-of-powershell-targeting-net-projects"></a><span data-ttu-id="f5efc-125">Wichtige Arten von .NET-Projekten mit PowerShell als Ziel</span><span class="sxs-lookup"><span data-stu-id="f5efc-125">Key kinds of PowerShell-targeting .NET projects</span></span>

<span data-ttu-id="f5efc-126">Alle .NET-Bibliotheken oder -Anwendungen können PowerShell zwar einbetten, doch es gibt einige gängige Szenarios, in denen PowerShell-APIs verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="f5efc-126">While any .NET library or application can embed PowerShell, there are some common scenarios that use PowerShell APIs:</span></span>

- <span data-ttu-id="f5efc-127">**Implementieren eines PowerShell-Binärmoduls**</span><span class="sxs-lookup"><span data-stu-id="f5efc-127">**Implementing a PowerShell binary module**</span></span>

  <span data-ttu-id="f5efc-128">PowerShell-Binärmodule sind von PowerShell geladene .NET-Bibliotheken, die PowerShell-APIs wie [PSCmdlet][] oder [CmdletProvider][] implementieren müssen, um Cmdlets bzw. Anbieter verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-128">PowerShell binary modules are .NET libraries loaded by PowerShell that must implement PowerShell APIs like the [PSCmdlet][] or [CmdletProvider][] types in order to expose cmdlets or providers respectively.</span></span> <span data-ttu-id="f5efc-129">Da sie geladen werden, versuchen die Module für Verweise auf PowerShell zu kompilieren, ohne sie im Build zu veröffentlichen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-129">Because they are loaded in, modules seek to compile against references to PowerShell without publishing it in their build.</span></span> <span data-ttu-id="f5efc-130">Häufig versuchen die Module auch, mehrere PowerShell-Versionen und -Plattformen zu unterstützen, und dies mit möglichst geringem zusätzlichem Speicherplatz, möglichst geringer Komplexität und möglichst wenigen Implementierungswiederholungen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-130">It's also common for modules to want to support multiple PowerShell versions and platforms, ideally with a minimum of overhead of disk space, complexity, or repeated implementation.</span></span> <span data-ttu-id="f5efc-131">Weitere Informationen zu Modulen finden Sie unter [about_Modules][].</span><span class="sxs-lookup"><span data-stu-id="f5efc-131">See [about_Modules][] for more information about modules.</span></span>

- <span data-ttu-id="f5efc-132">**Implementieren eines PowerShell-Hosts**</span><span class="sxs-lookup"><span data-stu-id="f5efc-132">**Implementing a PowerShell Host**</span></span>

  <span data-ttu-id="f5efc-133">Ein PowerShell-Host stellt für die PowerShell-Laufzeit eine Interaktionsebene bereit.</span><span class="sxs-lookup"><span data-stu-id="f5efc-133">A PowerShell Host provides an interaction layer for the PowerShell runtime.</span></span> <span data-ttu-id="f5efc-134">Dabei handelt es sich um eine bestimmte Form von _Hosting_, bei der eine [PSHost][]-Klasse als neue Benutzeroberfläche für PowerShell implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="f5efc-134">It is a specific form of _hosting_, where a [PSHost][] is implemented as a new user interface to PowerShell.</span></span> <span data-ttu-id="f5efc-135">Die PowerShell-Klasse „ConsoleHost“ stellt beispielsweise eine Terminalbenutzeroberfläche für ausführbare PowerShell-Dateien bereit, während der PowerShell-Host für Editor-Dienste und der ISE-Host eine im Editor integrierte, teilweise grafische Benutzeroberfläche für PowerShell bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-135">For example, the PowerShell ConsoleHost provides a terminal user interface for PowerShell executables, while the PowerShell Editor Services Host and the ISE Host both provide an editor-integrated partially graphical user interface around PowerShell.</span></span> <span data-ttu-id="f5efc-136">Es ist zwar möglich, einen Host in einen vorhandenen PowerShell-Prozess zu laden. Doch in den meisten Fällen fungiert die Hostimplementierung als eigenständige PowerShell-Implementierung, die die PowerShell-Engine neu verteilt.</span><span class="sxs-lookup"><span data-stu-id="f5efc-136">While it's possible to load a host onto an existing PowerShell process, it's much more common for a host implementation to act as a standalone PowerShell implementation that redistributes the PowerShell engine.</span></span>

- <span data-ttu-id="f5efc-137">**Aufrufen von PowerShell aus einer anderen .NET-Anwendung**</span><span class="sxs-lookup"><span data-stu-id="f5efc-137">**Calling into PowerShell from another .NET application**</span></span>

  <span data-ttu-id="f5efc-138">Wie jede Anwendung kann auch PowerShell als Teilprozess zum Ausführen von Workloads aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-138">As with any application, PowerShell can be called as a subprocess to run workloads.</span></span> <span data-ttu-id="f5efc-139">Als .NET-Anwendung kann PowerShell jedoch auch prozessintern aufgerufen werden, um vollständige .NET-Objekte zu erhalten, die innerhalb der aufrufenden Anwendung verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="f5efc-139">However, as a .NET application, it's also possible to invoke PowerShell in-process to get back full .NET objects for use within the calling application.</span></span> <span data-ttu-id="f5efc-140">Dies ist eine allgemeinere Form von _Hosting_, bei der die Anwendung über eine eigene PowerShell-Implementierung für die interne Verwendung verfügt.</span><span class="sxs-lookup"><span data-stu-id="f5efc-140">This is a more general form of _hosting_, where the application holds its own PowerShell implementation for internal use.</span></span> <span data-ttu-id="f5efc-141">Dabei kann es sich beispielsweise um einen Dienst oder Daemon handeln, der PowerShell zur Verwaltung des Computerstatus ausführt oder um eine Webanwendung, die PowerShell etwa zur Verwaltung von Cloudbereitstellungen ausführt.</span><span class="sxs-lookup"><span data-stu-id="f5efc-141">Examples of this might be a service or daemon running PowerShell to manage machine state or a web application that runs PowerShell on request to do something like manage cloud deployments.</span></span>

- <span data-ttu-id="f5efc-142">**Ausführen von Komponententests für PowerShell-Module über .NET**</span><span class="sxs-lookup"><span data-stu-id="f5efc-142">**Unit testing PowerShell modules from .NET**</span></span>

  <span data-ttu-id="f5efc-143">Module und andere Bibliotheken, die für die Bereitstellung von Funktionen in PowerShell entworfen wurden, sollten in erster Linie über PowerShell getestet werden (es wird [Pester][] empfohlen). Doch manchmal kann es erforderlich sein, Komponententests für APIs, die für ein PowerShell-Modul geschrieben wurden, über .NET auszuführen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-143">While modules and other libraries designed to expose functionality to PowerShell should be primarily tested from PowerShell (we recommend [Pester][]), sometimes it's necessary to unit test APIs written for a PowerShell module from .NET.</span></span> <span data-ttu-id="f5efc-144">In diesem Fall versucht der Modulcode, eine Reihe von PowerShell-Versionen als Ziel zu verwenden. Während des Tests sollte er jedoch für eine bestimmte, konkrete Implementierung ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-144">This situation involves the module code trying to target a number of PowerShell versions, while testing should run it on specific, concrete implementations.</span></span>

## <a name="powershell-nuget-packages-at-a-glance"></a><span data-ttu-id="f5efc-145">PowerShell NuGet-Pakete auf einen Blick</span><span class="sxs-lookup"><span data-stu-id="f5efc-145">PowerShell NuGet packages at a glance</span></span>

<span data-ttu-id="f5efc-146">In diesem Artikel werden die folgenden NuGet-Pakete behandelt, die PowerShell-APIs bereitstellen:</span><span class="sxs-lookup"><span data-stu-id="f5efc-146">In this article, we'll cover the following NuGet packages that expose PowerShell APIs:</span></span>

- <span data-ttu-id="f5efc-147">[PowerShellStandard.Library][]: Verweisassembly zum Erstellen einer einzelnen Assembly, die von mehreren PowerShell-Laufzeiten geladen werden kann.</span><span class="sxs-lookup"><span data-stu-id="f5efc-147">[PowerShellStandard.Library][], a reference assembly that enables building a single assembly that can be loaded by multiple PowerShell runtimes.</span></span>
- <span data-ttu-id="f5efc-148">[Microsoft.PowerShell.SDK][]: Methode zum Anvisieren und Zuweisen eines neuen Hosts für das gesamte PowerShell SDK.</span><span class="sxs-lookup"><span data-stu-id="f5efc-148">[Microsoft.PowerShell.SDK][], the way to target and rehost the whole PowerShell SDK</span></span>
- <span data-ttu-id="f5efc-149">[System.Management.Automation][]: Paket zur Implementierung der PowerShell-Laufzeit und -Engine, das bei minimalen gehosteten Implementierungen und versionsspezifischen Zielszenarios nützlich sein kann.</span><span class="sxs-lookup"><span data-stu-id="f5efc-149">The [System.Management.Automation][] package, the core PowerShell runtime and engine implementation, that can be useful in minimal hosted implementations and for version-specific targeting scenarios.</span></span>
- <span data-ttu-id="f5efc-150">**Windows PowerShell-Verweisassemblys**: Methode zum Anvisieren und effektiven Zuweisen von neuen Hosts für Windows PowerShell (PowerShell-Version 5.1 und früher).</span><span class="sxs-lookup"><span data-stu-id="f5efc-150">The **Windows PowerShell reference assemblies**, the way to target and effectively rehost Windows PowerShell (PowerShell versions 5.1 and below).</span></span>

> [!NOTE]
> <span data-ttu-id="f5efc-151">Bei dem [PowerShell NuGet][]-Paket handelt es sich nicht um ein .NET-Bibliothekspaket. Es stellt vielmehr die PowerShell-Implementierung der globalen dotnet-Tools bereit.</span><span class="sxs-lookup"><span data-stu-id="f5efc-151">The [PowerShell NuGet][] package is not a .NET library package at all, but instead provides the PowerShell dotnet global tool implementation.</span></span> <span data-ttu-id="f5efc-152">Es sollte nicht für Projekte verwendet werden, da es nur eine ausführbare Datei bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="f5efc-152">This should not be used by any projects, since it only provides an executable.</span></span>

## <a name="powershellstandardlibrary"></a><span data-ttu-id="f5efc-153">PowerShellStandard.Library</span><span class="sxs-lookup"><span data-stu-id="f5efc-153">PowerShellStandard.Library</span></span>

<span data-ttu-id="f5efc-154">Die PowerShell Standard-Bibliothek ist eine Verweisassembly, die eine Schnittmenge der APIs aus den PowerShell-Versionen 7, 6 und 5.1 erfasst.</span><span class="sxs-lookup"><span data-stu-id="f5efc-154">The PowerShell Standard library is a reference assembly that captures the intersection of the APIs of PowerShell versions 7, 6 and 5.1.</span></span> <span data-ttu-id="f5efc-155">Sie bietet eine zur Kompilierzeit überprüfte API-Oberfläche zur Kompilierung von .NET-Code, die eine Verwendung der PowerShell-Versionen 7, 6 und 5.1 als Ziel ermöglicht. Dabei wird ausgeschlossen, dass eine API aufgerufen wird, die gar nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="f5efc-155">This provides a compile-time-checked API surface to compile .NET code against, allowing .NET projects to target PowerShell versions 7, 6 and 5.1 without risking calling an API that won't be there.</span></span>

<span data-ttu-id="f5efc-156">PowerShell Standard wurde für das Schreiben von PowerShell-Modulen oder anderem Code konzipiert, der ausschließlich nach dem Laden in einen PowerShell-Prozess ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="f5efc-156">PowerShell Standard is intended for writing PowerShell modules, or other code only intended to be run after loading it into a PowerShell process.</span></span> <span data-ttu-id="f5efc-157">Da es sich um eine Verweisassembly handelt, enthält PowerShell Standard keine eigene Implementierung und bietet somit keine Funktionen für eigenständige Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-157">Because it is a reference assembly, PowerShell Standard contains no implementation itself, so provides no functionality for standalone applications.</span></span>

### <a name="using-powershell-standard-with-different-net-runtimes"></a><span data-ttu-id="f5efc-158">Verwenden von PowerShell Standard mit unterschiedlichen .NET-Laufzeiten</span><span class="sxs-lookup"><span data-stu-id="f5efc-158">Using PowerShell Standard with different .NET runtimes</span></span>

<span data-ttu-id="f5efc-159">PowerShell Standard wurde für die Ziellaufzeit [.NET Standard 2.0][] konzipiert, die eine Fassade für eine gemeinsame Oberfläche von .NET Framework und .NET Core darstellt.</span><span class="sxs-lookup"><span data-stu-id="f5efc-159">PowerShell Standard targets the [.NET Standard 2.0][] target runtime, which is a façade runtime designed to provide a common surface area shared by .NET Framework and .NET Core.</span></span> <span data-ttu-id="f5efc-160">Dadurch kann eine einzelne Ziellaufzeit eine einzelne Assembly erzeugen, die für mehrere PowerShell-Versionen verwendet werden kann. Dies hat jedoch die folgenden Konsequenzen:</span><span class="sxs-lookup"><span data-stu-id="f5efc-160">This allows targeting a single runtime to produce a single assembly that will work with multiple PowerShell versions, but has the following consequences:</span></span>

- <span data-ttu-id="f5efc-161">Die PowerShell-Mindestversion zum Laden des Moduls oder der Bibliothek lautet .NET 4.6.1. Die Versionen .NET 4.6 und .NET 4.5.2 unterstützen .NET Standard nicht.</span><span class="sxs-lookup"><span data-stu-id="f5efc-161">The PowerShell loading the module or library must be running a minimum of .NET 4.6.1; .NET 4.6 and .NET 4.5.2 do not support .NET Standard.</span></span> <span data-ttu-id="f5efc-162">Beachten Sie, dass eine neuere Windows PowerShell-Version nicht gleichbedeutend mit einer neueren .NET Framework-Version ist. Windows PowerShell 5.1 kann auch unter .NET 4.5.2 ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-162">Note that a newer Windows PowerShell version does not mean a newer .NET Framework version; Windows PowerShell 5.1 may run on .NET 4.5.2.</span></span>
- <span data-ttu-id="f5efc-163">Damit PowerShell mit .NET Framework 4.7.1 oder niedriger ausgeführt werden kann, ist die [NETStandard.Library][]-Implementierung .NET 4.6.1 erforderlich. Diese stellt in älteren .NET Framework-Versionen „netstandard.dll“ und andere Shim-Assemblys bereit.</span><span class="sxs-lookup"><span data-stu-id="f5efc-163">In order to work with a PowerShell running .NET Framework 4.7.1 or below, the .NET 4.6.1 [NETStandard.Library][] implementation is required to provide the netstandard.dll and other shim assemblies in older .NET Framework versions.</span></span>

<span data-ttu-id="f5efc-164">Ab PowerShell 6 stellen die Versionen eigene Shim-Assemblys für die Typweiterleitung von .NET Framework 4.6.1 (und höher) zu .NET Core bereit.</span><span class="sxs-lookup"><span data-stu-id="f5efc-164">PowerShell 6+ provides its own shim assemblies for type forwarding from .NET Framework 4.6.1 (and above) to .NET Core.</span></span> <span data-ttu-id="f5efc-165">Dies bedeutet, dass PowerShell 6 (und höher) Module laden und ausführen kann, die nur APIs verwenden, die in .NET Core vorhanden sind, wenn sie für .NET Framework 4.6.1 erstellt wurden (Ziellaufzeit `net461`).</span><span class="sxs-lookup"><span data-stu-id="f5efc-165">This means that as long as a module uses only APIs that exist in .NET Core, PowerShell 6+ can load and run it when it has been built for .NET Framework 4.6.1 (the `net461` runtime target).</span></span>

<span data-ttu-id="f5efc-166">Für Binärmodule, die mithilfe von PowerShell Standard mehrere PowerShell-Versionen mit einer einzelnen veröffentlichten DLL anvisieren, stehen daher zwei Optionen zur Verfügung:</span><span class="sxs-lookup"><span data-stu-id="f5efc-166">This means that binary modules using PowerShell Standard to target multiple PowerShell versions with a single published DLL have two options:</span></span>

1. <span data-ttu-id="f5efc-167">Sie veröffentlichen eine Assembly, die für die Ziellaufzeit `net461` erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="f5efc-167">Publishing an assembly built for the `net461` target runtime.</span></span> <span data-ttu-id="f5efc-168">Dies erfordert:</span><span class="sxs-lookup"><span data-stu-id="f5efc-168">This involves:</span></span>
   - <span data-ttu-id="f5efc-169">Veröffentlichen des Projekts für die Laufzeit `net461`</span><span class="sxs-lookup"><span data-stu-id="f5efc-169">Publishing the project for the `net461` runtime</span></span>
   - <span data-ttu-id="f5efc-170">Zusätzliches Kompilieren für die Laufzeit `netstandard2.0` (ohne Verwendung der Buildausgabe), um sicherzustellen, dass alle verwendeten APIs auch in .NET Core vorhanden sind</span><span class="sxs-lookup"><span data-stu-id="f5efc-170">Also compiling against the `netstandard2.0` runtime (without using its build output) to ensure that all APIs used are also present in .NET Core.</span></span>

1. <span data-ttu-id="f5efc-171">Sie veröffentlichen eine Assembly, die für die Ziellaufzeit `netstandard2.0` erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="f5efc-171">Publishing an assembly build for the `netstandard2.0` target runtime.</span></span> <span data-ttu-id="f5efc-172">Dies erfordert:</span><span class="sxs-lookup"><span data-stu-id="f5efc-172">This requires:</span></span>
   - <span data-ttu-id="f5efc-173">Veröffentlichen des Projekts für die Laufzeit `netstandard2.0`</span><span class="sxs-lookup"><span data-stu-id="f5efc-173">Publishing the project for the `netstandard2.0` runtime</span></span>
   - <span data-ttu-id="f5efc-174">Kopieren der `net461`-Abhängigkeiten von NETStandard.Library und Einfügen in den Speicherort der Veröffentlichung der Projektassembly, damit die Assembly per Typweiterleitung in .NET Framework korrigiert wird</span><span class="sxs-lookup"><span data-stu-id="f5efc-174">Taking the `net461` dependencies of NETStandard.Library and copying them into the project assembly's publish location so that the assembly is type-forwarded corrected in .NET Framework.</span></span>

<span data-ttu-id="f5efc-175">Wenn Sie PowerShell-Module oder -Bibliotheken mit älteren .NET Framework-Versionen als Ziel erstellen möchten, sollten Sie mehrere .NET-Laufzeiten anvisieren.</span><span class="sxs-lookup"><span data-stu-id="f5efc-175">To build PowerShell modules or libraries targeting older .NET Framework versions, it may be preferable to target multiple .NET runtimes.</span></span> <span data-ttu-id="f5efc-176">Dadurch wird für jede Ziellaufzeit eine Assembly veröffentlicht. Die richtige Assembly muss dann zur Ladezeit des Moduls geladen werden (z. B. mit einer kleinen PSM1-Datei als Stammmodul).</span><span class="sxs-lookup"><span data-stu-id="f5efc-176">This will publish an assembly for each target runtime, and the correct assembly will need to be loaded at module load time (for example with a small psm1 as the root module).</span></span>

### <a name="testing-powershell-standard-projects-in-net"></a><span data-ttu-id="f5efc-177">Testen von PowerShell Standard-Projekten in .NET</span><span class="sxs-lookup"><span data-stu-id="f5efc-177">Testing PowerShell Standard projects in .NET</span></span>

<span data-ttu-id="f5efc-178">Beachten Sie, dass beim Testen des Moduls in einem .NET-Testprogramm wie xUnit die Überprüfungen zur Kompilierzeit nur bis zu diesem Punkt ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="f5efc-178">When it comes to testing your module in .NET test runners like xUnit, remember that compile-time checks can only go so far.</span></span> <span data-ttu-id="f5efc-179">Sie müssen das Modul für die entsprechenden PowerShell-Plattformen testen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-179">You must test your module against the relevant PowerShell platforms.</span></span>

<span data-ttu-id="f5efc-180">Damit Sie APIs für PowerShell Standard in .NET testen können, fügen Sie .NET Core `Microsoft.Powershell.SDK` als Testabhängigkeit hinzu (und legen Sie die Version auf die gewünschte PowerShell-Version fest) sowie .NET Framework die entsprechenden Windows PowerShell-Verweisassemblys.</span><span class="sxs-lookup"><span data-stu-id="f5efc-180">To test APIs built against PowerShell Standard in .NET, you should add `Microsoft.Powershell.SDK` as a testing dependency with .NET Core (with the version set to match the desired PowerShell version), and the appropriate Windows PowerShell reference assemblies with .NET Framework.</span></span>

<span data-ttu-id="f5efc-181">Weitere Informationen zu PowerShell Standard und der Vorgehensweise beim Schreiben eines Binärmoduls zur Verwendung mit mehreren PowerShell-Versionen finden Sie in diesem [Blogbeitrag][].</span><span class="sxs-lookup"><span data-stu-id="f5efc-181">For more information on PowerShell Standard and using it to write a binary module that works in multiple PowerShell versions, see [this blog post][].</span></span> <span data-ttu-id="f5efc-182">Weitere Informationen finden Sie auch im [PowerShell Standard-Repository][] auf GitHub.</span><span class="sxs-lookup"><span data-stu-id="f5efc-182">Also see the [PowerShell Standard repository][] on GitHub.</span></span>

## <a name="microsoftpowershellsdk"></a><span data-ttu-id="f5efc-183">Microsoft.PowerShell.SDK</span><span class="sxs-lookup"><span data-stu-id="f5efc-183">Microsoft.PowerShell.SDK</span></span>

<span data-ttu-id="f5efc-184">`Microsoft.PowerShell.SDK` ist ein Metapaket, das alle Komponenten des PowerShell SDK in einem einzelnen NuGet-Paket zusammenfasst.</span><span class="sxs-lookup"><span data-stu-id="f5efc-184">`Microsoft.PowerShell.SDK` is a meta-package that pulls together all of the components of the PowerShell SDK into a single NuGet package.</span></span> <span data-ttu-id="f5efc-185">Eine eigenständige .NET-Anwendung kann „Microsoft.PowerShell.SDK“ verwenden, um beliebige PowerShell-Funktionen ohne Abhängigkeit von externen PowerShell-Installationen oder -Bibliotheken auszuführen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-185">A self-contained .NET application can use Microsoft.PowerShell.SDK to run arbitrary PowerShell functionality without depending on any external PowerShell installations or libraries.</span></span>

> [!NOTE]
> <span data-ttu-id="f5efc-186">Das PowerShell SDK umfasst alle Komponentenpakete von PowerShell, die für die .NET-Entwicklung mit PowerShell verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="f5efc-186">The PowerShell SDK just refers to all the component packages that make up PowerShell, and which can be used for .NET development with PowerShell.</span></span>

<span data-ttu-id="f5efc-187">Eine bestimmte `Microsoft.Powershell.SDK`-Version enthält die konkrete Implementierung derselben Version der PowerShell-Anwendung. So enthält Version 7.0 etwa die Implementierung von PowerShell 7.0, und die Ausführung von Befehlen oder Skripts ist größtenteils identisch mit deren Ausführung in PowerShell 7.0.</span><span class="sxs-lookup"><span data-stu-id="f5efc-187">A given `Microsoft.Powershell.SDK` version contains the concrete implementation of the same version of the PowerShell application; version 7.0 contains the implementation of PowerShell 7.0 and running commands or scripts with it will largely behave like running them in PowerShell 7.0.</span></span>

<span data-ttu-id="f5efc-188">Die Ausführung von PowerShell-Befehlen im SDK ist größtenteils, aber nicht vollständig, identisch mit deren Ausführung in `pwsh`.</span><span class="sxs-lookup"><span data-stu-id="f5efc-188">Running PowerShell commands from the SDK is mostly, but not totally, the same as running them from `pwsh`.</span></span> <span data-ttu-id="f5efc-189">So ist [Start-Job][] derzeit beispielsweise abhängig von der ausführbaren `pwsh`-Datei und funktioniert daher standardmäßig nicht mit `Microsoft.Powershell.SDK`.</span><span class="sxs-lookup"><span data-stu-id="f5efc-189">For example, [Start-Job][] currently depends on the `pwsh` executable being available, and so will not work with `Microsoft.Powershell.SDK` by default.</span></span>

<span data-ttu-id="f5efc-190">Wird `Microsoft.Powershell.SDK` von einer .NET-Anwendung als Ziel verwendet, kann mit allen Implementierungsassemblys von PowerShell, wie etwa `System.Management.Automation`, `Microsoft.PowerShell.Management` und anderen Modulassemblys, integriert werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-190">Targeting `Microsoft.Powershell.SDK` from a .NET application allows you to integrate with all of PowerShell's implementation assemblies, such as `System.Management.Automation`, `Microsoft.PowerShell.Management`, and other module assemblies.</span></span>

<span data-ttu-id="f5efc-191">Bei der Veröffentlichung einer Anwendung mit `Microsoft.Powershell.SDK` als Ziel sind alle diese Assemblys sowie alle von PowerShell benötigten Abhängigkeiten enthalten.</span><span class="sxs-lookup"><span data-stu-id="f5efc-191">Publishing an application targeting `Microsoft.Powershell.SDK` will include all these assemblies, and any dependencies PowerShell requires.</span></span> <span data-ttu-id="f5efc-192">Außerdem sind weitere Ressourcen enthalten, die PowerShell für den Buildvorgang benötigt, wie die Modulmanifeste für `Microsoft.PowerShell.*`-Module sowie das für [Add-Type][] erforderliche `ref`-Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="f5efc-192">It will also include other assets that PowerShell required in its build, such as the module manifests for `Microsoft.PowerShell.*` modules and the `ref` directory required by [Add-Type][].</span></span>

<span data-ttu-id="f5efc-193">Angesichts der Vollständigkeit von `Microsoft.Powershell.SDK` ist es bestens für folgende Vorgänge geeignet:</span><span class="sxs-lookup"><span data-stu-id="f5efc-193">Given the completeness of `Microsoft.Powershell.SDK`, it's best suited for:</span></span>

- <span data-ttu-id="f5efc-194">Implementieren von PowerShell-Hosts</span><span class="sxs-lookup"><span data-stu-id="f5efc-194">Implementation of PowerShell hosts.</span></span>
- <span data-ttu-id="f5efc-195">Ausführen von xUnit-Tests für Bibliotheken mit PowerShell-Verweisassemblys als Ziel</span><span class="sxs-lookup"><span data-stu-id="f5efc-195">xUnit testing of libraries targeting PowerShell reference assemblies.</span></span>
- <span data-ttu-id="f5efc-196">Prozessinternes Aufrufen von PowerShell aus einer .NET-Anwendung</span><span class="sxs-lookup"><span data-stu-id="f5efc-196">Invoking PowerShell in-process from a .NET application.</span></span>

<span data-ttu-id="f5efc-197">`Microsoft.PowerShell.SDK` kann auch als Verweisziel verwendet werden, wenn ein .NET-Projekt als Modul verwendet oder anderweitig von PowerShell geladen werden soll, aber von APIs abhängig ist, die nur in einer bestimmten PowerShell-Version vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="f5efc-197">`Microsoft.PowerShell.SDK` may also be used as a reference target when a .NET project is intended to be used as a module or otherwise loaded by PowerShell, but depends on APIs only present in a particular version of PowerShell.</span></span> <span data-ttu-id="f5efc-198">Beachten Sie, dass eine für eine bestimmte Version von `Microsoft.PowerShell.SDK` veröffentlichte Assembly nur in dieser PowerShell-Version sicher geladen und verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="f5efc-198">Note that an assembly published against a specific version of `Microsoft.PowerShell.SDK` will only be safe to load and use in that version of PowerShell.</span></span> <span data-ttu-id="f5efc-199">Für mehrere PowerShell-Versionen mit bestimmten APIs als Ziel sind mehrere Builds erforderlich, von denen jede die eigene Version von `Microsoft.Powershell.SDK` als Ziel verwendet.</span><span class="sxs-lookup"><span data-stu-id="f5efc-199">To target multiple PowerShell versions with specific APIs, multiple builds are required, each targeting their own version of `Microsoft.Powershell.SDK`.</span></span>

> [!NOTE]
> <span data-ttu-id="f5efc-200">Das PowerShell SDK ist erst ab PowerShell-Version 6 verfügbar.</span><span class="sxs-lookup"><span data-stu-id="f5efc-200">The PowerShell SDK is only available for PowerShell versions 6 and up.</span></span> <span data-ttu-id="f5efc-201">Verwenden Sie die unten beschriebenen Windows PowerShell-Verweisassemblys, um die entsprechenden Funktionen für Windows PowerShell bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-201">To provide equivalent functionality with Windows PowerShell, use the Windows PowerShell reference assemblies described below.</span></span>

## <a name="systemmanagementautomation"></a><span data-ttu-id="f5efc-202">System.Management.Automation</span><span class="sxs-lookup"><span data-stu-id="f5efc-202">System.Management.Automation</span></span>

<span data-ttu-id="f5efc-203">Das `System.Management.Automation`-Paket ist das Kernstück des PowerShell SDK.</span><span class="sxs-lookup"><span data-stu-id="f5efc-203">The `System.Management.Automation` package is the heart of the PowerShell SDK.</span></span> <span data-ttu-id="f5efc-204">In NuGet dient es hauptsächlich dazu, von `Microsoft.Powershell.SDK` als Ressource abgerufen zu werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-204">It exists on NuGet, primarily, as an asset for `Microsoft.Powershell.SDK` to pull in.</span></span> <span data-ttu-id="f5efc-205">Es kann jedoch auch direkt als Paket für kleinere Hostingszenarios und Module mit Versionszielen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-205">However, it can also be used directly as a package for smaller hosting scenarios and version-targeting modules.</span></span>

<span data-ttu-id="f5efc-206">In den folgenden Fällen ist das `System.Management.Automation`-Paket besonders als Anbieter von PowerShell-Funktionen geeignet:</span><span class="sxs-lookup"><span data-stu-id="f5efc-206">Specifically, the `System.Management.Automation` package may be a preferable provider of PowerShell functionality when:</span></span>

- <span data-ttu-id="f5efc-207">Wenn Sie nur PowerShell-Sprachfunktionen verwenden möchten (im Namespace `System.Management.Automation.Language`), wie z. B. den PowerShell-Parser, die AST und AST-Besucher-APIs (etwa zur statischen Analyse von PowerShell).</span><span class="sxs-lookup"><span data-stu-id="f5efc-207">You're only looking to use PowerShell language functionality (in the `System.Management.Automation.Language` namespace) like the PowerShell parser, AST, and AST visitor APIs (for example for static analysis of PowerShell).</span></span>
- <span data-ttu-id="f5efc-208">Wenn Sie im `Microsoft.PowerShell.Core`-Modul nur bestimmte Befehle ausführen möchten und diese in einem mit der Factorymethode [CreateDefault2][] erstellten Sitzungszustand ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="f5efc-208">You only wish to execute specific commands from the `Microsoft.PowerShell.Core` module and can execute them in a session state created with the [CreateDefault2][] factory method.</span></span>

<span data-ttu-id="f5efc-209">Auch in den folgenden Situationen ist `System.Management.Automation` als Verweisassembly nützlich:</span><span class="sxs-lookup"><span data-stu-id="f5efc-209">Additionally, `System.Management.Automation` is a useful reference assembly when:</span></span>

- <span data-ttu-id="f5efc-210">Wenn Sie APIs als Ziel verwenden möchten, die nur in einer bestimmten PowerShell-Version verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="f5efc-210">You wish to target APIs that are only present within a specific PowerShell version</span></span>
- <span data-ttu-id="f5efc-211">Wenn Sie nicht von Typen abhängig sind, die außerhalb der `System.Management.Automation`-Assembly auftreten (wie etwa von Cmdlets in `Microsoft.PowerShell.*`-Module exportierte Typen).</span><span class="sxs-lookup"><span data-stu-id="f5efc-211">You won't be depending on types occurring outside the `System.Management.Automation` assembly (for example, types exported by cmdlets in `Microsoft.PowerShell.*` modules).</span></span>

## <a name="windows-powershell-reference-assemblies"></a><span data-ttu-id="f5efc-212">Windows PowerShell-Verweisassemblys</span><span class="sxs-lookup"><span data-stu-id="f5efc-212">Windows PowerShell reference assemblies</span></span>

<span data-ttu-id="f5efc-213">Für die PowerShell-Versionen 5.1 und älter (Windows PowerShell) gibt es keine SDKs, die eine Implementierung von PowerShell bereitstellen, da die Implementierung von Windows PowerShell Teil von Windows ist.</span><span class="sxs-lookup"><span data-stu-id="f5efc-213">For PowerShell versions 5.1 and older (Windows PowerShell), there is no SDK to provide an implementation of PowerShell, since Windows PowerShell's implementation is a part of Windows.</span></span>

<span data-ttu-id="f5efc-214">Dafür bieten die Windows PowerShell-Verweisassemblys sowohl Verweisziele als auch eine Möglichkeit, Windows PowerShell einen neuen Host zuzuweisen. Damit erfüllen sie denselben Zweck wie das PowerShell SDK für die Versionen 6 und höher.</span><span class="sxs-lookup"><span data-stu-id="f5efc-214">Instead, the Windows PowerShell reference assemblies provide both reference targets and a way to rehost Windows PowerShell, acting the same as the PowerShell SDK does for versions 6 and up.</span></span>

<span data-ttu-id="f5efc-215">Die Windows PowerShell-Verweisassemblys werden nicht nach Version unterschieden, sondern nach der jeweiligen Version von Windows PowerShell:</span><span class="sxs-lookup"><span data-stu-id="f5efc-215">Rather than being differentiated by version, Windows PowerShell reference assemblies have a different package for each version of Windows PowerShell:</span></span>

- [<span data-ttu-id="f5efc-216">PowerShell 5.1</span><span class="sxs-lookup"><span data-stu-id="f5efc-216">PowerShell 5.1</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.5.ReferenceAssemblies/)
- [<span data-ttu-id="f5efc-217">PowerShell 4</span><span class="sxs-lookup"><span data-stu-id="f5efc-217">PowerShell 4</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.4.ReferenceAssemblies/)
- [<span data-ttu-id="f5efc-218">PowerShell 3</span><span class="sxs-lookup"><span data-stu-id="f5efc-218">PowerShell 3</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.3.ReferenceAssemblies/)

<span data-ttu-id="f5efc-219">Informationen zur Verwendung der Windows PowerShell-Verweisassemblys finden Sie im [Windows PowerShell SDK][].</span><span class="sxs-lookup"><span data-stu-id="f5efc-219">Information on how to use the Windows PowerShell reference assemblies can be found in the [Windows PowerShell SDK][].</span></span>

## <a name="real-world-examples-using-these-nuget-packages"></a><span data-ttu-id="f5efc-220">Praktische Beispiele für die Verwendung der neuen NuGet-Pakete</span><span class="sxs-lookup"><span data-stu-id="f5efc-220">Real-world examples using these NuGet packages</span></span>

<span data-ttu-id="f5efc-221">Je nach Anforderungen unterscheiden sich PowerShell-Toolprojekte in den PowerShell NuGet-Paketen, die sie als Ziel verwenden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-221">Different PowerShell tooling projects target different PowerShell NuGet packages depending on their needs.</span></span> <span data-ttu-id="f5efc-222">Nachfolgend sind einige wichtige Beispiele aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="f5efc-222">Listed here are some notable examples.</span></span>

### <a name="psreadline"></a><span data-ttu-id="f5efc-223">PSReadLine</span><span class="sxs-lookup"><span data-stu-id="f5efc-223">PSReadLine</span></span>

<span data-ttu-id="f5efc-224">Das PowerShell-Modul [PSReadLine][] stellt einen Großteil der umfassenden Konsolenfunktionen von PowerShell bereit. Es verwendet PowerShell Standard anstelle einer bestimmten PowerShell-Version als Abhängigkeit sowie die .NET-Laufzeit `net461` in der Datei [CSPROJ][] als Ziel.</span><span class="sxs-lookup"><span data-stu-id="f5efc-224">[PSReadLine][], the PowerShell module that provides much of PowerShell's rich console experience, targets PowerShell Standard as a dependency rather than a specific PowerShell version, and targets the `net461` .NET runtime in its [csproj][].</span></span>

<span data-ttu-id="f5efc-225">Ab PowerShell 6 werden eigene Shim-Assemblys bereitgestellt, mit denen eine DLL die `net461`-Laufzeit nur als Ziel verwendet, wenn sie geladen wurde (durch Weiterleiten der Bindung von `mscorlib.dll` von .NET Framework an die entsprechende .NET Core-Assembly).</span><span class="sxs-lookup"><span data-stu-id="f5efc-225">PowerShell 6+ supplies its own shim assemblies that allow a DLL targeting the `net461` runtime to "just work" when loaded in (by redirecting binding to .NET Framework's `mscorlib.dll` to the relevant .NET Core assembly).</span></span>

<span data-ttu-id="f5efc-226">Dadurch werden das Layout und die Übermittlung des PSReadLine-Moduls erheblich vereinfacht, da durch PowerShell Standard sichergestellt wird, dass nur APIs verwendet werden, die sowohl in PowerShell 5.1 als auch in den Versionen ab PowerShell 6 vorhanden sind. Gleichzeitig umfasst das Modul nur eine einzige Assembly.</span><span class="sxs-lookup"><span data-stu-id="f5efc-226">This simplifies PSReadLine's module layout and delivery significantly, since PowerShell Standard ensures the only APIs used will be present in both PowerShell 5.1 and PowerShell 6+, while also allowing the module to ship with only a single assembly.</span></span>

<span data-ttu-id="f5efc-227">Jedoch bedeutet die Auswahl von .NET 4.6.1 als Ziel, dass die Ausführung von Windows PowerShell unter .NET 4.5.2 und .NET 4.6 nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="f5efc-227">The .NET 4.6.1 target does mean that Windows PowerShell running on .NET 4.5.2 and .NET 4.6 is not supported though.</span></span>

### <a name="powershell-editor-services"></a><span data-ttu-id="f5efc-228">Editor-Dienste von PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5efc-228">PowerShell Editor Services</span></span>

<span data-ttu-id="f5efc-229">Die [Editor-Dienste von PowerShell (PowerShell Editor Services)][] (PSES) stellen das Back-End der [PowerShell-Erweiterung][] für [Visual Studio Code][] dar. Dabei handelt es sich um eine Form des PowerShell-Moduls, das von einer ausführbaren PowerShell-Datei geladen wird, den Prozess übernimmt und anschließend PowerShell intern selbst hostet. Gleichzeitig werden Sprachdienstprotokoll- und Debugadapterfunktionen bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="f5efc-229">[PowerShell Editor Services][] (PSES) is the backend for the [PowerShell extension][] for [Visual Studio Code][], and is actually a form of PowerShell module that gets loaded by a PowerShell executable and then takes over that process to rehost PowerShell within itself while also providing Language Service Protocol and Debug Adapter features.</span></span>

<span data-ttu-id="f5efc-230">PSES bietet konkrete Implementierungsziele für `netcoreapp2.1`, um PowerShell 6 und höher als Ziel zu verwenden (da die `netcoreapp3.1`-Laufzeit von PowerShell 7 abwärts kompatibel ist) sowie für `net461` mit Windows PowerShell 5.1 als Ziel. Der Großteil der Logik ist jedoch in einer zweiten Assembly enthalten mit `netstandard2.0` und PowerShell Standard als Ziel.</span><span class="sxs-lookup"><span data-stu-id="f5efc-230">PSES provides concrete implementation targets for `netcoreapp2.1` to target PowerShell 6+ (since PowerShell 7's `netcoreapp3.1` runtime is backwards compatible) and `net461` to target Windows PowerShell 5.1, but contains most of its logic in a second assembly that targets `netstandard2.0` and PowerShell Standard.</span></span> <span data-ttu-id="f5efc-231">Dadurch ist es möglich, die für .NET Core- und .NET Framework-Plattformen erforderlichen Abhängigkeiten abzurufen, während die Codebasis gleichzeitig durch eine einheitliche Abstraktion vereinfacht wird.</span><span class="sxs-lookup"><span data-stu-id="f5efc-231">This allows it to pull in dependencies required for .NET Core and .NET Framework platforms, while still simplifying most of the codebase behind a uniform abstraction.</span></span>

<span data-ttu-id="f5efc-232">Da PSES für PowerShell Standard entwickelt wurde, ist für ordnungsgemäße Tests eine Laufzeitimplementierung von PowerShell erforderlich.</span><span class="sxs-lookup"><span data-stu-id="f5efc-232">Because it is built against PowerShell Standard, PSES requires a runtime implementation of PowerShell in order to be tested correctly.</span></span> <span data-ttu-id="f5efc-233">Zu diesem Zweck rufen die [xUnit-Tests][] von PSES `Microsoft.PowerShell.SDK` und `Microsoft.PowerShell.5.ReferenceAssemblies` ab, um in der Testumgebung eine PowerShell-Implementierung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-233">To do this, [PSES's xUnit][] tests pull in `Microsoft.PowerShell.SDK` and `Microsoft.PowerShell.5.ReferenceAssemblies` in order to provide a PowerShell implementation in the test environment.</span></span>

<span data-ttu-id="f5efc-234">Wie PSReadLine bietet auch PSES keine Unterstützung für .NET 4.6 und frühere Versionen. Doch es führt zur Laufzeit eine [Überprüfung][] aus, bevor APIs aufgerufen werden, die möglicherweise für niedrigere .NET Framework-Laufzeiten einen Absturz verursachen.</span><span class="sxs-lookup"><span data-stu-id="f5efc-234">As with PSReadLine, PSES cannot support .NET 4.6 and below, but it [performs a check][] at runtime before calling any of the APIs that could cause a crash on the lower .NET Framework runtimes.</span></span>

### <a name="psscriptanalyzer"></a><span data-ttu-id="f5efc-235">PSScriptAnalyzer</span><span class="sxs-lookup"><span data-stu-id="f5efc-235">PSScriptAnalyzer</span></span>

<span data-ttu-id="f5efc-236">[PSScriptAnalyzer][] ist der Linter für PowerShell und visiert syntaktische Elemente an, die nur in bestimmten PowerShell-Versionen eingeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-236">[PSScriptAnalyzer][], the linter for PowerShell, must target syntactic elements only introduced in certain versions of PowerShell.</span></span> <span data-ttu-id="f5efc-237">Da das Erkennen dieser syntaktischen Elemente auf der Implementierung von [AstVisitor2][] beruht, kann PowerShell Standard nicht verwendet werden, wenn gleichzeitig AST-Besuchermethoden für neuere PowerShell-Syntax implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-237">Because recognition of these syntactic elements is accomplished by implementing an [AstVisitor2][], it's not possible to use PowerShellStandard and also implement AST visitor methods for newer PowerShell syntaxes.</span></span>

<span data-ttu-id="f5efc-238">Stattdessen visiert PSScriptAnalyzer [jede PowerShell-Version][] als Buildkonfiguration an und produziert jeweils eine separate DLL.</span><span class="sxs-lookup"><span data-stu-id="f5efc-238">Instead, PSScriptAnalyzer [targets each PowerShell version][] as a build configuration, and produces a separate DLL for each of them.</span></span> <span data-ttu-id="f5efc-239">Dies erhöht die Buildgröße und -komplexität, ermöglicht jedoch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="f5efc-239">This increases build size and complexity, but allows:</span></span>

- <span data-ttu-id="f5efc-240">Versionsspezifische Verwendung von APIs als Ziel</span><span class="sxs-lookup"><span data-stu-id="f5efc-240">Version-specific API targeting</span></span>
- <span data-ttu-id="f5efc-241">Implementierung von versionsspezifischen Funktionen praktisch ohne Laufzeitkosten</span><span class="sxs-lookup"><span data-stu-id="f5efc-241">Version-specific functionality to be implemented with essentially no runtime cost</span></span>
- <span data-ttu-id="f5efc-242">Vollständige Unterstützung für Windows PowerShell bis .NET Framework 4.5.2</span><span class="sxs-lookup"><span data-stu-id="f5efc-242">Total support for Windows PowerShell all the way down to .NET Framework 4.5.2</span></span>

## <a name="summary"></a><span data-ttu-id="f5efc-243">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="f5efc-243">Summary</span></span>

<span data-ttu-id="f5efc-244">In diesem Artikel wurden die NuGet-Pakete aufgelistet und erläutert, die bei der Implementierung eines .NET-Projekts, das PowerShell verwendet, als Ziel verfügbar sind. Zudem haben Sie die Vorteile der jeweiligen Pakete kennengelernt.</span><span class="sxs-lookup"><span data-stu-id="f5efc-244">In this article, we've listed and discussed the NuGet packages available to target when implementing a .NET project that uses PowerShell, and the reasons you might have for using one over another.</span></span>

<span data-ttu-id="f5efc-245">Die wichtigsten Erkenntnisse dieses Artikels lassen sich in den folgenden allgemeinen Empfehlungen zusammenfassen:</span><span class="sxs-lookup"><span data-stu-id="f5efc-245">If you've skipped to the summary, some broad recommendations are:</span></span>

- <span data-ttu-id="f5efc-246">Sie sollten PowerShell-**Module** für PowerShell Standard kompilieren, wenn Sie nur APIs benötigen, die in verschiedenen PowerShell-Versionen vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="f5efc-246">PowerShell **modules** should compile against PowerShell Standard if they only require APIs common to different PowerShell versions.</span></span>
- <span data-ttu-id="f5efc-247">Für **Hosts und Anwendungen** von PowerShell, die PowerShell intern ausführen müssen, sollten Sie als Ziel das PowerShell SDK für Versionen ab PowerShell 6 oder die entsprechenden Windows PowerShell-Verweisassemblys für Windows PowerShell verwenden.</span><span class="sxs-lookup"><span data-stu-id="f5efc-247">PowerShell **hosts and applications** that need to run PowerShell internally should target the PowerShell SDK for PowerShell 6+ or the relevant Windows PowerShell reference assemblies for Windows PowerShell.</span></span>
- <span data-ttu-id="f5efc-248">Für PowerShell-Module, die **versionsspezifische APIs** benötigen, sollten Sie als Ziel das PowerShell SDK oder die Windows PowerShell-Verweisassemblys für die erforderlichen PowerShell-Versionen verwenden. Verwenden Sie diese als Verweisassemblys (d. h. dass Sie die PowerShell-Abhängigkeiten nicht veröffentlichen).</span><span class="sxs-lookup"><span data-stu-id="f5efc-248">PowerShell modules that need **version-specific APIs** should target the PowerShell SDK or Windows PowerShell reference assemblies for the required PowerShell versions, using them as reference assemblies (that is, not publishing the PowerShell dependencies).</span></span>

<!--link references -->

[.NET-Standard 2.0]: /dotnet/standard/net-standard
[.NET Standard 2.0]: /dotnet/standard/net-standard
[about_Modules]: /powershell/module/microsoft.powershell.core/about/about_modules
[Add-Type]: /powershell/module/microsoft.powershell.utility/add-type
[AstVisitor2]: /dotnet/api/system.management.automation.language.astvisitor2
[CmdletProvider]: /dotnet/api/system.management.automation.provider.cmdletprovider
[CreateDefault2]: /dotnet/api/system.management.automation.runspaces.initialsessionstate.createdefault2
[CSPROJ]: https://github.com/PowerShell/PSReadLine/blob/master/PSReadLine/PSReadLine.csproj
[csproj]: https://github.com/PowerShell/PSReadLine/blob/master/PSReadLine/PSReadLine.csproj
[Microsoft.PowerShell.SDK]: https://www.nuget.org/packages/Microsoft.PowerShell.SDK/
[NETStandard.Library]: https://www.nuget.org/packages/NETStandard.Library/
[NuGet]: https://www.nuget.org/
[Überprüfung]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/src/PowerShellEditorServices.Hosting/EditorServicesLoader.cs#L231-L251
[performs a check]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/src/PowerShellEditorServices.Hosting/EditorServicesLoader.cs#L231-L251
[Pester]: https://github.com/Pester/Pester
[Editor-Dienste von PowerShell]: https://github.com/PowerShell/PowerShellEditorServices/
[PowerShell Editor Services]: https://github.com/PowerShell/PowerShellEditorServices/
[PowerShell-Erweiterung]: https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell
[PowerShell extension]: https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell
[PowerShell NuGet]: https://www.nuget.org/packages/PowerShell/
[PowerShell Standard-Repository]: https://github.com/PowerShell/PowerShellStandard
[PowerShell Standard repository]: https://github.com/PowerShell/PowerShellStandard
[PowerShellStandard.Library]: https://www.nuget.org/packages/PowerShellStandard.Library/
[PSCmdlet]: /dotnet/api/system.management.automation.pscmdlet
[xUnit von PSES]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/test/PowerShellEditorServices.Test/PowerShellEditorServices.Test.csproj#L15-L20
[PSES's xUnit]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/test/PowerShellEditorServices.Test/PowerShellEditorServices.Test.csproj#L15-L20
[PSHost]: /dotnet/api/system.management.automation.host.pshost
[PrivateAssets-Attribut]: /dotnet/core/tools/csproj#packagereference
[PrivateAssets attribute]: /dotnet/core/tools/csproj#packagereference
[PSReadLine]: https://github.com/PowerShell/PSReadLine
[PSScriptAnalyzer]: https://github.com/powershell/psscriptanalyzer
[Verweisassemblys]: https://github.com/dotnet/standard/blob/master/docs/history/evolution-of-design-time-assemblies.md#definitions
[reference assemblies]: https://github.com/dotnet/standard/blob/master/docs/history/evolution-of-design-time-assemblies.md#definitions
[Start-Job]: /powershell/module/microsoft.powershell.core/start-job
[System.Management.Automation]: https://www.nuget.org/packages/System.Management.Automation/
[jede PowerShell-Version als Ziel verwenden]: https://github.com/PowerShell/PSScriptAnalyzer/blob/master/Engine/Engine.csproj
[targets each PowerShell version]: https://github.com/PowerShell/PSScriptAnalyzer/blob/master/Engine/Engine.csproj
[dieser Blogbeitrag]: https://devblogs.microsoft.com/powershell/powershell-standard-library-build-single-module-that-works-across-windows-powershell-and-powershell-core/
[this blog post]: https://devblogs.microsoft.com/powershell/powershell-standard-library-build-single-module-that-works-across-windows-powershell-and-powershell-core/
[Visual Studio Code]: https://code.visualstudio.com/
[Windows PowerShell SDK]: /powershell/scripting/developer/windows-powershell
