---
ms.date: 02/03/2020
ms.topic: reference
title: Importieren eines PowerShell-Moduls
description: Importieren eines PowerShell-Moduls
ms.openlocfilehash: 688509c0943a9a0289e75b80543f278e16cfedfe
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/10/2020
ms.locfileid: "92658786"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="97688-103">Importieren eines PowerShell-Moduls</span><span class="sxs-lookup"><span data-stu-id="97688-103">Importing a PowerShell Module</span></span>

<span data-ttu-id="97688-104">Wenn Sie ein Modul auf einem System installiert haben, möchten Sie wahrscheinlich das Modul importieren.</span><span class="sxs-lookup"><span data-stu-id="97688-104">Once you have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="97688-105">Beim Importieren wird das Modul in den aktiven Arbeitsspeicher geladen, sodass ein Benutzer in der PowerShell-Sitzung auf das Modul zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="97688-105">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="97688-106">In PowerShell 2,0 können Sie ein neu installiertes PowerShell-Modul mit dem Cmdlet " [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) " importieren.</span><span class="sxs-lookup"><span data-stu-id="97688-106">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="97688-107">In PowerShell 3,0 kann PowerShell ein Modul implizit importieren, wenn eine der Funktionen oder Cmdlets im Modul von einem Benutzer aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="97688-107">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="97688-108">Beachten Sie, dass bei beiden Versionen angenommen wird, dass Sie das Modul an einem Speicherort installieren, an dem PowerShell ihn finden kann. Weitere Informationen finden Sie unter [Installieren eines PowerShell-Moduls](./installing-a-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="97688-108">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span>
<span data-ttu-id="97688-109">Mithilfe eines Modul Manifests können Sie einschränken, welche Teile des Moduls exportiert werden, und Sie können Parameter des `Import-Module` Aufrufes verwenden, um einzuschränken, welche Teile importiert werden.</span><span class="sxs-lookup"><span data-stu-id="97688-109">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="97688-110">Importieren einer Snap-In (PowerShell 1,0)</span><span class="sxs-lookup"><span data-stu-id="97688-110">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="97688-111">Module waren in PowerShell 1,0 nicht vorhanden: stattdessen mussten Sie Snap-Ins registrieren und verwenden. Es wird jedoch nicht empfohlen, diese Technologie zu diesem Zeitpunkt zu verwenden, da Module im Allgemeinen einfacher zu installieren und zu importieren sind.</span><span class="sxs-lookup"><span data-stu-id="97688-111">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="97688-112">Weitere Informationen finden Sie unter [Erstellen eines Windows PowerShell-Snap-Ins](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="97688-112">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="97688-113">Importieren eines Moduls mit Import-Module (PowerShell 2,0)</span><span class="sxs-lookup"><span data-stu-id="97688-113">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="97688-114">PowerShell 2,0 verwendet das entsprechend benannte Cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) zum Importieren von Modulen.</span><span class="sxs-lookup"><span data-stu-id="97688-114">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="97688-115">Wenn dieses Cmdlet ausgeführt wird, sucht Windows PowerShell in den Verzeichnissen, die in der Variablen angegeben sind, nach dem angegebenen Modul `PSModulePath` .</span><span class="sxs-lookup"><span data-stu-id="97688-115">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="97688-116">Wenn das angegebene Verzeichnis gefunden wird, sucht Windows PowerShell nach Dateien in der folgenden Reihenfolge: Modul Manifest-Dateien (. psd1), Skript Moduldateien (. psm1), binäre Moduldateien (. dll).</span><span class="sxs-lookup"><span data-stu-id="97688-116">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="97688-117">Weitere Informationen zum Hinzufügen von Verzeichnissen zur Suche finden Sie unter [Ändern des psmodulepath-Installations Pfads](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="97688-117">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span>
<span data-ttu-id="97688-118">Im folgenden Code wird beschrieben, wie Sie ein Modul importieren:</span><span class="sxs-lookup"><span data-stu-id="97688-118">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="97688-119">Wenn sich MyModule im Verzeichnis befindet `PSModulePath` , lädt PowerShell MyModule in den aktiven Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="97688-119">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="97688-120">Wenn "MyModule" nicht in einem `PSModulePath` Pfad gefunden wurde, können Sie PowerShell trotzdem explizit mitteilen, wo Sie Sie finden:</span><span class="sxs-lookup"><span data-stu-id="97688-120">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="97688-121">Sie können auch den `-Verbose` -Parameter verwenden, um zu ermitteln, was aus dem Modul exportiert wird und was in den aktiven Speicher importiert wird.</span><span class="sxs-lookup"><span data-stu-id="97688-121">You can also use the `-Verbose` parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="97688-122">Sowohl Exporte als auch Importe schränken die Informationen ein, die dem Benutzer zur Verfügung stehen: der Unterschied besteht darin, wer die Sichtbarkeit steuert.</span><span class="sxs-lookup"><span data-stu-id="97688-122">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="97688-123">Im Grunde werden Exporte durch Code im Modul gesteuert.</span><span class="sxs-lookup"><span data-stu-id="97688-123">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="97688-124">Im Gegensatz dazu werden Importe durch den-Befehl gesteuert `Import-Module` .</span><span class="sxs-lookup"><span data-stu-id="97688-124">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="97688-125">Weitere Informationen finden Sie weiter unten unter **Einschränken von importierten** Membern.</span><span class="sxs-lookup"><span data-stu-id="97688-125">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="97688-126">Implizites Importieren eines Moduls (PowerShell 3,0)</span><span class="sxs-lookup"><span data-stu-id="97688-126">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="97688-127">Ab Windows PowerShell 3.0 werden Module automatisch importiert, wenn ein Cmdlet oder eine Funktion im Modul in einem Befehl verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="97688-127">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="97688-128">Diese Funktion funktioniert in jedem Modul in einem Verzeichnis, das in den Wert der **psmodulepath** -Umgebungsvariablen eingeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="97688-128">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="97688-129">Wenn Sie das Modul jedoch nicht unter einem gültigen Pfad speichern, können Sie es dennoch mithilfe der oben beschriebenen expliziten [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) -Option laden.</span><span class="sxs-lookup"><span data-stu-id="97688-129">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="97688-130">Mit den folgenden Aktionen wird das automatische Importieren eines Moduls, auch bekannt als "Automatisches Laden von Modulen", auslöst.</span><span class="sxs-lookup"><span data-stu-id="97688-130">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="97688-131">Verwenden eines Cmdlets in einem-Befehl.</span><span class="sxs-lookup"><span data-stu-id="97688-131">Using a cmdlet in a command.</span></span> <span data-ttu-id="97688-132">Wenn Sie z. b. eingeben, wird `Get-ExecutionPolicy` das Microsoft. PowerShell. Security-Modul importiert, das das `Get-ExecutionPolicy` Cmdlet enthält.</span><span class="sxs-lookup"><span data-stu-id="97688-132">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="97688-133">Verwenden des Cmdlets [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) , um den Befehl zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="97688-133">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span> <span data-ttu-id="97688-134">Wenn Sie z. b. eingeben, wird `Get-Command Get-JobTrigger` das **psscheduledjob** -Modul importiert, das das `Get-JobTrigger` Cmdlet enthält.</span><span class="sxs-lookup"><span data-stu-id="97688-134">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="97688-135">Ein `Get-Command` Befehl, der Platzhalter Zeichen enthält, wird als Ermittlung angesehen und löst nicht das Importieren eines Moduls aus.</span><span class="sxs-lookup"><span data-stu-id="97688-135">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="97688-136">Verwenden des Cmdlets " [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) ", um Hilfe zu einem Cmdlet zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="97688-136">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="97688-137">Wenn Sie z. b. eingeben, wird `Get-Help Get-WinEvent` das Microsoft. PowerShell. Diagnostics-Modul importiert, das das `Get-WinEvent` Cmdlet enthält.</span><span class="sxs-lookup"><span data-stu-id="97688-137">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="97688-138">Um das automatische Importieren von Modulen zu unterstützen, ruft das `Get-Command` Cmdlet alle Cmdlets und Funktionen in allen installierten Modulen ab, auch wenn das Modul nicht in die Sitzung importiert wird.</span><span class="sxs-lookup"><span data-stu-id="97688-138">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="97688-139">Weitere Informationen finden Sie im Hilfethema für das Cmdlet " [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) ".</span><span class="sxs-lookup"><span data-stu-id="97688-139">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="97688-140">Der Import Vorgang.</span><span class="sxs-lookup"><span data-stu-id="97688-140">The Importing Process</span></span>

<span data-ttu-id="97688-141">Wenn ein Modul importiert wird, wird ein neuer Sitzungs Status für das Modul erstellt, und ein [System. Management. Automation. psmoduleinfo](/dotnet/api/System.Management.Automation.PSModuleInfo) -Objekt wird im Arbeitsspeicher erstellt.</span><span class="sxs-lookup"><span data-stu-id="97688-141">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="97688-142">Ein Sitzungszustand wird für jedes importierte Modul erstellt (Dies schließt das Stamm Modul und alle in der Tabelle enthaltenen Module ein).</span><span class="sxs-lookup"><span data-stu-id="97688-142">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="97688-143">Die Elemente, die aus dem Stamm Modul exportiert werden, einschließlich aller Member, die von einem der in das Stamm Modul exportierten Module exportiert wurden, werden dann in den Sitzungszustand des Aufrufers importiert.</span><span class="sxs-lookup"><span data-stu-id="97688-143">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="97688-144">Die Metadaten von Membern, die aus einem Modul exportiert werden, verfügen über eine ModuleName-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="97688-144">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="97688-145">Diese Eigenschaft wird mit dem Namen des Moduls aufgefüllt, das Sie exportiert hat.</span><span class="sxs-lookup"><span data-stu-id="97688-145">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="97688-146">Wenn der Name eines exportierten Members ein nicht genehmigtes Verb verwendet oder der Name des Members eingeschränkte Zeichen verwendet, wird beim Ausführen des [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) -Cmdlets eine Warnung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="97688-146">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="97688-147">Standardmäßig gibt das [Import-Module-](/powershell/module/Microsoft.PowerShell.Core/Import-Module) Cmdlet keine Objekte an die Pipeline zurück.</span><span class="sxs-lookup"><span data-stu-id="97688-147">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="97688-148">Allerdings unterstützt das Cmdlet einen **passthru** -Parameter, mit dem ein [System. Management. Automation. psmoduleinfo](/dotnet/api/System.Management.Automation.PSModuleInfo) -Objekt für jedes importierte Modul zurückgegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="97688-148">However, the cmdlet supports a **PassThru** parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="97688-149">Um die Ausgabe an den Host zu senden, müssen Benutzer das Cmdlet " [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) " ausführen.</span><span class="sxs-lookup"><span data-stu-id="97688-149">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="97688-150">Einschränken der importierten Member</span><span class="sxs-lookup"><span data-stu-id="97688-150">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="97688-151">Wenn ein Modul mithilfe des [Import-Module-](/powershell/module/Microsoft.PowerShell.Core/Import-Module) Cmdlets importiert wird, werden standardmäßig alle exportierten Modul Elemente in die Sitzung importiert, einschließlich aller Befehle, die von einem Netz Modul in das Modul exportiert werden.</span><span class="sxs-lookup"><span data-stu-id="97688-151">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="97688-152">Standardmäßig werden Variablen und Aliase nicht exportiert.</span><span class="sxs-lookup"><span data-stu-id="97688-152">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="97688-153">Verwenden Sie ein [Modul Manifest](./how-to-write-a-powershell-module-manifest.md), um die exportierten Member einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="97688-153">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span>
<span data-ttu-id="97688-154">Verwenden Sie die folgenden Parameter des Cmdlets, um die importierten Member einzuschränken `Import-Module` .</span><span class="sxs-lookup"><span data-stu-id="97688-154">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="97688-155">**Function**: dieser Parameter schränkt die exportierten Funktionen ein.</span><span class="sxs-lookup"><span data-stu-id="97688-155">**Function**: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="97688-156">(Wenn Sie ein Modul Manifest verwenden, finden Sie weitere Informationen unter dem functionstoexport-Schlüssel.)</span><span class="sxs-lookup"><span data-stu-id="97688-156">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="97688-157">\`**Cmdlet**: dieser Parameter schränkt die exportierten Cmdlets ein (wenn Sie ein Modul Manifest verwenden, finden Sie weitere Informationen unter dem cmdletstoexport-Schlüssel.)</span><span class="sxs-lookup"><span data-stu-id="97688-157">\`**Cmdlet**: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="97688-158">**Variable**: dieser Parameter schränkt die exportierten Variablen ein (wenn Sie ein Modul Manifest verwenden, finden Sie weitere Informationen unter variablestoexport-Schlüssel.)</span><span class="sxs-lookup"><span data-stu-id="97688-158">**Variable**: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="97688-159">**Alias**: dieser Parameter schränkt die exportierten Aliase ein (wenn Sie ein Modul Manifest verwenden, finden Sie weitere Informationen unter dem Schlüssel "aliasestoexport").</span><span class="sxs-lookup"><span data-stu-id="97688-159">**Alias**: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="97688-160">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="97688-160">See Also</span></span>

[<span data-ttu-id="97688-161">Schreiben eines Windows PowerShell-Moduls</span><span class="sxs-lookup"><span data-stu-id="97688-161">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
