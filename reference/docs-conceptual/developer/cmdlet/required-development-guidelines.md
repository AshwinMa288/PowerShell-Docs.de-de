---
title: Erforderliche Entwicklungs Richtlinien | Microsoft-Dokumentation
ms.date: 09/13/2016
ms.openlocfilehash: ca0168050e3c1c2e7537036f96da62f52d50982e
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/05/2020
ms.locfileid: "87781697"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="9fe8a-102">Erforderliche Entwicklungsrichtlinien</span><span class="sxs-lookup"><span data-stu-id="9fe8a-102">Required Development Guidelines</span></span>

<span data-ttu-id="9fe8a-103">Die folgenden Richtlinien müssen befolgt werden, wenn Sie die Cmdlets schreiben.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="9fe8a-104">Sie sind in Richtlinien zum Entwerfen von Cmdlets und Richtlinien zum Schreiben des Cmdlet-Codes unterteilt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="9fe8a-105">Wenn Sie diese Richtlinien nicht befolgen, können Ihre Cmdlets fehlschlagen, und die Benutzer haben möglicherweise eine schlechte Benutzer Leistung, wenn Sie Ihre Cmdlets verwenden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="9fe8a-106">In diesem Thema</span><span class="sxs-lookup"><span data-stu-id="9fe8a-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="9fe8a-107">Entwurfsrichtlinien</span><span class="sxs-lookup"><span data-stu-id="9fe8a-107">Design Guidelines</span></span>

- [<span data-ttu-id="9fe8a-108">Nur genehmigte Verben verwenden (RD01)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="9fe8a-109">Cmdlet-Namen: Zeichen, die nicht verwendet werden können (RD02)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="9fe8a-110">Parameternamen, die nicht verwendet werden können (RD03)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="9fe8a-111">Unterstützung von Bestätigungs Anforderungen (RD04)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="9fe8a-112">Unterstützung des Force-Parameters für interaktive Sitzungen (RD05)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="9fe8a-113">Dokument Ausgabe Objekte (RD06)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="9fe8a-114">Code Richtlinien</span><span class="sxs-lookup"><span data-stu-id="9fe8a-114">Code Guidelines</span></span>

- [<span data-ttu-id="9fe8a-115">Ableiten von Cmdlets oder PSCmdlet-Klassen (RC01)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="9fe8a-116">Angeben des Cmdlet-Attributs (RC02)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="9fe8a-117">Überschreiben einer Eingabe Verarbeitungsmethode (RC03)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="9fe8a-118">Angeben des OutputType-Attributs (RC04)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="9fe8a-119">Handles für Ausgabe Objekte nicht beibehalten (RC05)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="9fe8a-120">Fehler robuster behandeln (RC06)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="9fe8a-121">Verwenden eines Windows PowerShell-Moduls zum Bereitstellen von Cmdlets (RC07)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="9fe8a-122">Entwurfsrichtlinien</span><span class="sxs-lookup"><span data-stu-id="9fe8a-122">Design Guidelines</span></span>

<span data-ttu-id="9fe8a-123">Beim Entwerfen von Cmdlets müssen die folgenden Richtlinien befolgt werden, um eine konsistente Benutzer Darstellung zwischen der Verwendung ihrer Cmdlets und anderer Cmdlets sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="9fe8a-124">Wenn Sie eine Entwurfsrichtlinie finden, die für Ihre Situation gilt, sollten Sie sich die Code Richtlinien für ähnliche Richtlinien ansehen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="9fe8a-125">Nur genehmigte Verben verwenden (RD01)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="9fe8a-126">Das im Cmdlet-Attribut angegebene Verb muss aus dem erkannten Satz von Verben stammen, die von Windows PowerShell bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="9fe8a-127">Es darf sich nicht um eines der unzulässigen Synonyme handeln.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="9fe8a-128">Verwenden Sie die Konstanten Zeichen folgen, die durch die folgenden Enumerationen definiert werden, um Cmdlet-Verben anzugeben:</span><span class="sxs-lookup"><span data-stu-id="9fe8a-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="9fe8a-129">System. Management. Automation. verbscommon</span><span class="sxs-lookup"><span data-stu-id="9fe8a-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="9fe8a-130">System. Management. Automation. verbscommunications</span><span class="sxs-lookup"><span data-stu-id="9fe8a-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="9fe8a-131">System. Management. Automation. verbsdata</span><span class="sxs-lookup"><span data-stu-id="9fe8a-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="9fe8a-132">System. Management. Automation. verbsdiagnostic</span><span class="sxs-lookup"><span data-stu-id="9fe8a-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="9fe8a-133">System. Management. Automation. verbslifecycle</span><span class="sxs-lookup"><span data-stu-id="9fe8a-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="9fe8a-134">System. Management. Automation. verbssecurity</span><span class="sxs-lookup"><span data-stu-id="9fe8a-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="9fe8a-135">System. Management. Automation. verbsother</span><span class="sxs-lookup"><span data-stu-id="9fe8a-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="9fe8a-136">Weitere Informationen zu den genehmigten Verb Namen finden Sie unter [Cmdlet-Verben](./approved-verbs-for-windows-powershell-commands.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="9fe8a-137">Benutzer benötigen einen Satz erkennbarer und erwarteter Cmdlet-Namen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="9fe8a-138">Verwenden Sie das geeignete Verb, damit der Benutzer eine schnelle Bewertung der Funktionsweise eines Cmdlets durchführen und die Funktionen des Systems problemlos ermitteln kann.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="9fe8a-139">Beispielsweise wird mit dem folgenden Befehlszeilen Befehl eine Liste aller Befehle auf dem System abgerufen, deren Namen mit "Start" beginnen: `get-command start-*` .</span><span class="sxs-lookup"><span data-stu-id="9fe8a-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="9fe8a-140">Verwenden Sie die Substantiven in ihren Cmdlets, um ihre Cmdlets von anderen Cmdlets zu unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="9fe8a-141">Das Substantiv gibt die Ressource an, für die der Vorgang ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="9fe8a-142">Der Vorgang selbst wird durch das Verb dargestellt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="9fe8a-143">Cmdlet-Namen: Zeichen, die nicht verwendet werden können (RD02)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="9fe8a-144">Wenn Sie Cmdlets benennen, dürfen Sie keines der folgenden Sonderzeichen verwenden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="9fe8a-145">Zeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-145">Character</span></span>|<span data-ttu-id="9fe8a-146">Name</span><span class="sxs-lookup"><span data-stu-id="9fe8a-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="9fe8a-147">Nummernzeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-147">number sign</span></span>|
|<span data-ttu-id="9fe8a-148">,</span><span class="sxs-lookup"><span data-stu-id="9fe8a-148">,</span></span>|<span data-ttu-id="9fe8a-149">Komma</span><span class="sxs-lookup"><span data-stu-id="9fe8a-149">comma</span></span>|
|<span data-ttu-id="9fe8a-150">()</span><span class="sxs-lookup"><span data-stu-id="9fe8a-150">()</span></span>|<span data-ttu-id="9fe8a-151">Klammern</span><span class="sxs-lookup"><span data-stu-id="9fe8a-151">parentheses</span></span>|
|{}|<span data-ttu-id="9fe8a-152">Klammern</span><span class="sxs-lookup"><span data-stu-id="9fe8a-152">braces</span></span>|
|<span data-ttu-id="9fe8a-153">[]</span><span class="sxs-lookup"><span data-stu-id="9fe8a-153">[]</span></span>|<span data-ttu-id="9fe8a-154">angegeben</span><span class="sxs-lookup"><span data-stu-id="9fe8a-154">brackets</span></span>|
|&|<span data-ttu-id="9fe8a-155">kaufmännisches und</span><span class="sxs-lookup"><span data-stu-id="9fe8a-155">ampersand</span></span>|
|-|<span data-ttu-id="9fe8a-156">Bindestrich **Hinweis:** der Bindestrich kann verwendet werden, um das Verb vom Substantiv zu trennen, aber es kann nicht innerhalb des Substantiv oder innerhalb des Verbs verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="9fe8a-157">Schrägstrich</span><span class="sxs-lookup"><span data-stu-id="9fe8a-157">slash mark</span></span>|
|<span data-ttu-id="9fe8a-158">\\| umgekehrter Schrägstrich</span><span class="sxs-lookup"><span data-stu-id="9fe8a-158">\\|backslash</span></span>|
|$|<span data-ttu-id="9fe8a-159">Dollarzeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-159">dollar sign</span></span>|
|^|<span data-ttu-id="9fe8a-160">caret</span><span class="sxs-lookup"><span data-stu-id="9fe8a-160">caret</span></span>|
|<span data-ttu-id="9fe8a-161">;</span><span class="sxs-lookup"><span data-stu-id="9fe8a-161">;</span></span>|<span data-ttu-id="9fe8a-162">Semikolon</span><span class="sxs-lookup"><span data-stu-id="9fe8a-162">semicolon</span></span>|
|<span data-ttu-id="9fe8a-163">:</span><span class="sxs-lookup"><span data-stu-id="9fe8a-163">:</span></span>|<span data-ttu-id="9fe8a-164">Doppelpunkt</span><span class="sxs-lookup"><span data-stu-id="9fe8a-164">colon</span></span>|
|<span data-ttu-id="9fe8a-165">"</span><span class="sxs-lookup"><span data-stu-id="9fe8a-165">"</span></span>|<span data-ttu-id="9fe8a-166">doppeltes Anführungszeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-166">double quotation mark</span></span>|
|<span data-ttu-id="9fe8a-167">'</span><span class="sxs-lookup"><span data-stu-id="9fe8a-167">'</span></span>|<span data-ttu-id="9fe8a-168">Einfaches Anführungszeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="9fe8a-169">spitzen Klammern</span><span class="sxs-lookup"><span data-stu-id="9fe8a-169">angle brackets</span></span>|
|<span data-ttu-id="9fe8a-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="9fe8a-170">&#124;</span></span>|<span data-ttu-id="9fe8a-171">senkrechter Strich</span><span class="sxs-lookup"><span data-stu-id="9fe8a-171">vertical bar</span></span>|
|<span data-ttu-id="9fe8a-172">?</span><span class="sxs-lookup"><span data-stu-id="9fe8a-172">?</span></span>|<span data-ttu-id="9fe8a-173">Fragezeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-173">question mark</span></span>|
|@|<span data-ttu-id="9fe8a-174">@-Zeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-174">at sign</span></span>|
|`|<span data-ttu-id="9fe8a-175">Backtick (großes Akzent)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-175">back tick (grave accent)</span></span>|
|*|<span data-ttu-id="9fe8a-176">Sternchen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-176">asterisk</span></span>|
|%|<span data-ttu-id="9fe8a-177">Prozentzeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-177">percent sign</span></span>|
|+|<span data-ttu-id="9fe8a-178">Pluszeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-178">plus sign</span></span>|
|=|<span data-ttu-id="9fe8a-179">Gleichheitszeichen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-179">equals sign</span></span>|
|~|<span data-ttu-id="9fe8a-180">Tilde</span><span class="sxs-lookup"><span data-stu-id="9fe8a-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="9fe8a-181">Parameternamen, die nicht verwendet werden können (RD03)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="9fe8a-182">Windows PowerShell bietet einen gemeinsamen Satz von Parametern für alle Cmdlets sowie zusätzliche Parameter, die in bestimmten Situationen hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="9fe8a-183">Beim Entwerfen Ihrer eigenen Cmdlets können Sie die folgenden Namen nicht verwenden: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction und Verbose.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="9fe8a-184">Weitere Informationen zu diesen Parametern finden Sie unter [Allgemeine Parameternamen](./common-parameter-names.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="9fe8a-185">Unterstützung von Bestätigungs Anforderungen (RD04)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="9fe8a-186">Für Cmdlets, die einen Vorgang ausführen, der das System ändert, sollten Sie die [System. Management. Automation. Cmdlet. Schulter dprocess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) -Methode zum Anfordern der Bestätigung und in speziellen Fällen die [System. Management. Automation. Cmdlet. Schulter dcontinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) -Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="9fe8a-187">(Die [System. Management. Automation. Cmdlet. schuldcontinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) -Methode sollte nur aufgerufen werden, nachdem die [System. Management. Automation. Cmdlet. Schulter Name Process \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) -Methode aufgerufen wurde.)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="9fe8a-188">Um diese Aufrufe vorzunehmen, muss das Cmdlet angeben, dass es Bestätigungs Anforderungen unterstützt, indem das- `SupportsShouldProcess` Schlüsselwort des Cmdlet-Attributs festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="9fe8a-189">Weitere Informationen zum Festlegen dieses Attributs finden [Sie unter Cmdlet-Attribut Deklaration](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="9fe8a-190">Wenn das Cmdlet-Attribut der Cmdlet-Klasse anzeigt, dass das Cmdlet Aufrufe der [System. Management. Automation. Cmdlet. Schulter dprocess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) -Methode unterstützt, und das Cmdlet den Aufruf der [System. Management. Automation. Cmdlet. Schulter dprocess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) -Methode nicht ausführen kann, kann der Benutzer das System unerwartet ändern.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="9fe8a-191">Verwenden Sie die [System. Management. Automation. Cmdlet. Schulter dprocess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) -Methode für jede System Änderung.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="9fe8a-192">Eine Benutzereinstellung und der `WhatIf` Parameter steuern die [System. Management. Automation. Cmdlet. schuldprocess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) -Methode.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="9fe8a-193">Im Gegensatz dazu führt der [System. Management. Automation. Cmdlet. schuldcontinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) -Befehl eine zusätzliche Überprüfung auf potenziell gefährliche Änderungen aus.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="9fe8a-194">Diese Methode wird nicht von einer Benutzereinstellung oder dem- `WhatIf` Parameter gesteuert.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="9fe8a-195">Wenn das Cmdlet die [System. Management. Automation. Cmdlet. tiondcontinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) -Methode aufruft, muss es über einen Parameter verfügen, `Force` der die Aufrufe an diese beiden Methoden umgeht und den Vorgang fortsetzt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="9fe8a-196">Dies ist wichtig, da das Cmdlet in nicht interaktiven Skripts und Hosts verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="9fe8a-197">Wenn die Cmdlets diese Aufrufe unterstützen, kann der Benutzer bestimmen, ob die Aktion tatsächlich ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="9fe8a-198">Beispielsweise ruft das Cmdlet " [Stopp-Process](/powershell/module/microsoft.powershell.management/stop-process) " die [System. Management. Automation. Cmdlet. tiondcontinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) -Methode auf, bevor es eine Reihe kritischer Prozesse stoppt, einschließlich der System-, Winlogon-und spoolsv-Prozesse.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="9fe8a-199">Weitere Informationen zur Unterstützung dieser Methoden finden Sie unter [Anfordern einer Bestätigung](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="9fe8a-200">Unterstützung des Force-Parameters für interaktive Sitzungen (RD05)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="9fe8a-201">Wenn das Cmdlet interaktiv verwendet wird, stellen Sie immer einen Force-Parameter bereit, um die interaktiven Aktionen außer Kraft zu setzen, z. b. Eingabe Aufforderungen oder Lesen von Eingabezeilen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="9fe8a-202">Dies ist wichtig, da das Cmdlet in nicht interaktiven Skripts und Hosts verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="9fe8a-203">Die folgenden Methoden können von einem interaktiven Host implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="9fe8a-204">System. Management. Automation. Host. pshostuserinterface. prompt \*</span><span class="sxs-lookup"><span data-stu-id="9fe8a-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="9fe8a-205">System. Management. Automation. Host. pshostuserinterface. promptforchoice</span><span class="sxs-lookup"><span data-stu-id="9fe8a-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="9fe8a-206">System. Management. Automation. Host. ihostuisupportsmultiplechoiceselection. promptforchoice</span><span class="sxs-lookup"><span data-stu-id="9fe8a-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="9fe8a-207">System. Management. Automation. Host. pshostuserinterface. promptforcredential \*</span><span class="sxs-lookup"><span data-stu-id="9fe8a-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="9fe8a-208">System. Management. Automation. Host. pshostuserinterface. read line \*</span><span class="sxs-lookup"><span data-stu-id="9fe8a-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="9fe8a-209">System. Management. Automation. Host. pshostuserinterface. Read lineassecurestring \*</span><span class="sxs-lookup"><span data-stu-id="9fe8a-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="9fe8a-210">Dokument Ausgabe Objekte (RD06)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="9fe8a-211">Windows PowerShell verwendet die Objekte, die in die Pipeline geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="9fe8a-212">Damit Benutzer die von jedem Cmdlet zurückgegebenen Objekte nutzen können, müssen Sie die zurückgegebenen Objekte dokumentieren, und Sie müssen dokumentieren, wofür die Member dieser zurückgegebenen Objekte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="9fe8a-213">Code Richtlinien</span><span class="sxs-lookup"><span data-stu-id="9fe8a-213">Code Guidelines</span></span>

<span data-ttu-id="9fe8a-214">Die folgenden Richtlinien müssen befolgt werden, wenn der Cmdlet-Code geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="9fe8a-215">Wenn Sie eine Code Richtlinie finden, die für Ihre Situation gilt, achten Sie darauf, dass Sie die Entwurfs Richtlinien für ähnliche Richtlinien untersuchen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="9fe8a-216">Ableiten von Cmdlets oder PSCmdlet-Klassen (RC01)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="9fe8a-217">Ein Cmdlet muss entweder von der [System. Management. Automation. Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) -oder der [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) -Basisklasse abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="9fe8a-218">Cmdlets, die von der [System. Management. Automation. Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) -Klasse abgeleitet sind, sind nicht von der Windows PowerShell-Laufzeit abhängig.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="9fe8a-219">Sie können direkt von jeder beliebigen Microsoft .NET Framework-Sprache aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="9fe8a-220">Cmdlets, die von der [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) -Klasse abgeleitet sind, hängen von der Windows PowerShell-Laufzeit ab.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="9fe8a-221">Aus diesem Grund werden Sie innerhalb eines Runspace ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="9fe8a-222">Alle von Ihnen implementierten Cmdlet-Klassen müssen öffentliche Klassen sein.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="9fe8a-223">Weitere Informationen zu diesen Cmdlet-Klassen finden Sie in der [Cmdlet-Übersicht](./cmdlet-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="9fe8a-224">Angeben des Cmdlet-Attributs (RC02)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="9fe8a-225">Damit ein Cmdlet von Windows PowerShell erkannt wird, muss die .NET Framework Klasse mit dem Cmdlet-Attribut versehen werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="9fe8a-226">Dieses Attribut gibt die folgenden Features des Cmdlets an.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="9fe8a-227">Das Verb-und-Substantiv-Paar, das das Cmdlet identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="9fe8a-228">Der Standardparameter Satz, der verwendet wird, wenn mehrere Parametersätze angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="9fe8a-229">Der Standardparameter Satz wird verwendet, wenn Windows PowerShell nicht über genügend Informationen verfügt, um zu bestimmen, welcher Parameter verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="9fe8a-230">Gibt an, ob das Cmdlet Aufrufe der [System. Management. Automation. Cmdlet. Schulter dprocess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) -Methode unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="9fe8a-231">Diese Methode zeigt dem Benutzer eine Bestätigungsmeldung an, bevor das Cmdlet eine Änderung am System vornimmt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="9fe8a-232">Weitere Informationen zur Vorgehensweise bei Bestätigungs Anforderungen finden Sie unter [Anfordern einer Bestätigung](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="9fe8a-233">Geben Sie die Auswirkungs Stufe (oder den Schweregrad) der Aktion an, die der Bestätigungsmeldung zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="9fe8a-234">In den meisten Fällen sollte der Standardwert Mittel verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="9fe8a-235">Weitere Informationen darüber, wie sich die Auswirkung auf die Bestätigungs Anforderungen auswirkt, die dem Benutzer angezeigt werden, finden Sie unter [Anfordern einer Bestätigung](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="9fe8a-236">Weitere Informationen zum Deklarieren des Cmdlet-Attributs finden Sie unter [CmdletAttribute-Deklaration](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="9fe8a-237">Überschreiben einer Eingabe Verarbeitungsmethode (RC03)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="9fe8a-238">Damit das Cmdlet an der Windows PowerShell-Umgebung teilnimmt, muss es mindestens eine der folgenden *Eingabe Verarbeitungsmethoden*überschreiben.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="9fe8a-239">[System. Management. Automation. Cmdlet. BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) diese Methode wird einmal aufgerufen und wird verwendet, um Vorverarbeitungs Funktionen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="9fe8a-240">[System. Management. Automation. Cmdlet. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) diese Methode wird mehrmals aufgerufen und dient zur Bereitstellung von Daten Satz Funktionen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="9fe8a-241">[System. Management. Automation. Cmdlet. EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) diese Methode wird einmal aufgerufen, und Sie wird verwendet, um nach Verarbeitungsfunktionen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="9fe8a-242">Angeben des OutputType-Attributs (RC04)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="9fe8a-243">Das OutputType-Attribut (eingeführt in Windows PowerShell 2,0) gibt den .NET Framework Typ an, den das Cmdlet an die Pipeline zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="9fe8a-244">Indem Sie den Ausgabetyp ihrer Cmdlets angeben, machen Sie fest, dass die von Ihrem Cmdlet zurückgegebenen Objekte durch andere Cmdlets leichter erkennbar sind.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="9fe8a-245">Weitere Informationen zum zieren der Cmdlet-Klasse mit diesem Attribut finden Sie unter [OutputType-Attribut Deklaration](./outputtype-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="9fe8a-246">Handles für Ausgabe Objekte nicht beibehalten (RC05)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="9fe8a-247">Ihr Cmdlet sollte keine Handles an den Objekten aufbewahren, die an die [System. Management. Automation. Cmdlet. Write Team Object \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) -Methode übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="9fe8a-248">Diese Objekte werden an das nächste Cmdlet in der Pipeline übergeben, oder Sie werden von einem Skript verwendet.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="9fe8a-249">Wenn Sie die Handles für die Objekte beibehalten, werden die einzelnen Objekte von zwei Entitäten übernommen, was zu Fehlern führt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="9fe8a-250">Fehler robuster behandeln (RC06)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="9fe8a-251">Eine Verwaltungs Umgebung erkennt von Natur aus wichtige Änderungen am System, das Sie verwalten.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="9fe8a-252">Daher ist es wichtig, dass Cmdlets Fehler ordnungsgemäß behandeln.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="9fe8a-253">Weitere Informationen zu Fehler Datensätzen finden Sie unter [Windows PowerShell-Fehlerberichterstattung](./error-reporting-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="9fe8a-254">Wenn ein Fehler verhindert, dass ein Cmdlet die Verarbeitung von weiteren Datensätzen fortsetzt, ist dies ein Abbruch Fehler.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="9fe8a-255">Das Cmdlet muss die [System. Management. Automation. Cmdlet. ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) -Methode, die auf ein [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) -Objekt verweist, aufruft.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="9fe8a-256">Wenn eine Ausnahme vom Cmdlet nicht abgefangen wird, löst die Windows PowerShell-Laufzeit selbst einen Abbruch Fehler aus, der weniger Informationen enthält.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="9fe8a-257">Bei einem Fehler ohne Abbruch, bei dem der Vorgang für den nächsten Datensatz, der aus der Pipeline stammt (z. b. ein von einem anderen Prozess generierender Datensatz), nicht beendet wird, muss das Cmdlet die [System. Management. Automation. Cmdlet. Write-error \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) -Methode aufrufen, die auf ein [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) -Objekt verweist.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="9fe8a-258">Ein Beispiel für einen Fehler ohne Abbruch ist der Fehler, der auftritt, wenn ein bestimmter Prozess nicht beendet wird.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="9fe8a-259">Durch Aufrufen der [System. Management. Automation. Cmdlet. Write-error \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) -Methode kann der Benutzer die angeforderten Aktionen konsistent ausführen und die Informationen für bestimmte Aktionen beibehalten, die fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="9fe8a-260">Ihr Cmdlet sollte jeden Datensatz so unabhängig wie möglich verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="9fe8a-261">Das [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) -Objekt, auf das von der [System. Management. Automation. Cmdlet. ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) -und der [System. Management. Automation. Cmdlet. Write-error \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) -Methode verwiesen wird, erfordert im Kern eine Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="9fe8a-262">Befolgen Sie die Entwurfs Richtlinien für .NET Framework, wenn Sie die zu verwendende Ausnahme bestimmen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="9fe8a-263">Wenn der Fehler semantisch identisch mit einer vorhandenen Ausnahme ist, verwenden Sie diese Ausnahme oder leiten Sie von dieser Ausnahme ab.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="9fe8a-264">Leiten Sie andernfalls eine neue Ausnahme-oder eine Ausnahme Hierarchie direkt vom [System. Exception](/dotnet/api/System.Exception) -Typ ab.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="9fe8a-265">Ein [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) -Objekt benötigt außerdem eine Fehler Kategorie, in der Fehler für den Benutzer gruppiert werden.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="9fe8a-266">Der Benutzer kann Fehler basierend auf der Kategorie anzeigen, indem er den Wert der `$ErrorView` Shellvariablen auf categoryview festlegt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="9fe8a-267">Die möglichen Kategorien werden von der [System. Management. Automation. ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) -Enumeration definiert.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="9fe8a-268">Wenn ein Cmdlet einen neuen Thread erstellt und der Code, der in diesem Thread ausgeführt wird, eine nicht behandelte Ausnahme auslöst, wird der Fehler von Windows PowerShell nicht abgefangen, und der Prozess wird beendet.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="9fe8a-269">Wenn ein Objekt über Code in seinem Debuggen verfügt, der zu einer nicht behandelten Ausnahme führt, wird der Fehler von Windows PowerShell nicht abgefangen, und der Prozess wird beendet.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="9fe8a-270">Dies tritt auch auf, wenn ein Objektmethoden zum Verwerfen von Methoden aufruft, die zu einer nicht behandelten Ausnahme führen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="9fe8a-271">Verwenden eines Windows PowerShell-Moduls zum Bereitstellen von Cmdlets (RC07)</span><span class="sxs-lookup"><span data-stu-id="9fe8a-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="9fe8a-272">Erstellen Sie ein Windows PowerShell-Modul, um die Cmdlets zu verpacken und bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="9fe8a-273">Die Unterstützung für Module wird in Windows PowerShell 2,0 eingeführt.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="9fe8a-274">Sie können die Assemblys, die ihre Cmdlet-Klassen enthalten, direkt als binäre Moduldateien verwenden (Dies ist sehr nützlich, wenn Sie die Cmdlets testen), oder Sie können ein Modul Manifest erstellen, das auf die Cmdlet-Assemblys verweist.</span><span class="sxs-lookup"><span data-stu-id="9fe8a-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="9fe8a-275">(Sie können auch vorhandene Snap-in-Assemblys hinzufügen, wenn Sie Module verwenden.) Weitere Informationen zu Modulen finden Sie unter [Schreiben eines Windows PowerShell-Moduls](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="9fe8a-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="9fe8a-276">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="9fe8a-276">See Also</span></span>

[<span data-ttu-id="9fe8a-277">Ausdrücklich empfohlene Entwicklungsrichtlinien</span><span class="sxs-lookup"><span data-stu-id="9fe8a-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="9fe8a-278">Empfohlene Entwicklungsrichtlinien</span><span class="sxs-lookup"><span data-stu-id="9fe8a-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="9fe8a-279">Schreiben eines Windows PowerShell-Cmdlets</span><span class="sxs-lookup"><span data-stu-id="9fe8a-279">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
