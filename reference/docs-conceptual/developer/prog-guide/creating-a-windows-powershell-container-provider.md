---
ms.date: 09/13/2016
ms.topic: reference
title: Erstellen eines Windows PowerShell-Containeranbieters
description: Erstellen eines Windows PowerShell-Containeranbieters
ms.openlocfilehash: 999bd69e3c16bfc0a74519986654ec15bbc0da6d
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/10/2020
ms.locfileid: "92645353"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="0e8ef-103">Erstellen eines Windows PowerShell-Containeranbieters</span><span class="sxs-lookup"><span data-stu-id="0e8ef-103">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="0e8ef-104">In diesem Thema wird beschrieben, wie Sie einen Windows PowerShell-Anbieter erstellen, der in Daten speichern mit mehreren Ebenen verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-104">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="0e8ef-105">Bei dieser Art von Datenspeicher enthält die oberste Ebene des Stores die Stamm Elemente, und jede nachfolgende Ebene wird als Knoten untergeordneter Elemente bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-105">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="0e8ef-106">Da der Benutzer an diesen untergeordneten Knoten arbeiten kann, kann er hierarchisch über den Datenspeicher interagieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-106">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="0e8ef-107">Anbieter, die an Daten speichern mit mehreren Ebenen arbeiten können, werden als Windows PowerShell-Container Anbieter bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-107">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="0e8ef-108">Beachten Sie jedoch, dass ein Windows PowerShell-Container Anbieter nur verwendet werden kann, wenn es einen Container (keine unter-Container) mit Elementen gibt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-108">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="0e8ef-109">Wenn es sich um Container handelt, müssen Sie einen Windows PowerShell-Navigations Anbieter implementieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-109">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="0e8ef-110">Weitere Informationen zum Implementieren des Windows PowerShell-navigationsanbieters finden Sie unter [Erstellen eines Windows PowerShell-navigationsanbieters](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-110">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="0e8ef-111">Sie können die c#-Quelldatei (AccessDBSampleProvider04.cs) für diesen Anbieter mit dem Microsoft Windows Software Development Kit für Windows Vista und .NET Framework 3,0-Laufzeitkomponenten herunterladen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-111">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="0e8ef-112">Anweisungen zum Herunterladen finden Sie unter [Installieren von Windows PowerShell und Herunterladen des Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-112">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="0e8ef-113">Die heruntergeladenen Quelldateien sind im **\<PowerShell Samples>** Verzeichnis verfügbar.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-113">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="0e8ef-114">Weitere Informationen zu anderen Windows PowerShell-Anbieter Implementierungen finden [Sie unter Entwerfen des Windows PowerShell-Anbieters](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-114">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="0e8ef-115">Mit dem hier beschriebenen Windows PowerShell-Container Anbieter wird die Datenbank als einzelner Container definiert, wobei die Tabellen und Zeilen der Datenbank als Container Elemente definiert sind.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-115">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="0e8ef-116">Beachten Sie, dass bei diesem Entwurf eine Datenbank mit einem Feld mit der namens-ID und der Typ des Felds longinteger ist.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-116">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="0e8ef-117">Definieren einer Windows PowerShell-Container Anbieter Klasse</span><span class="sxs-lookup"><span data-stu-id="0e8ef-117">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="0e8ef-118">Ein Windows PowerShell-Container Anbieter muss eine .NET-Klasse definieren, die von der [System. Management. Automation. Provider. containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) -Basisklasse abgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-118">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="0e8ef-119">Hier ist die Klassendefinition für den Windows PowerShell-Container Anbieter, der in diesem Abschnitt beschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-119">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
[CmdletProvider("AccessDB", ProviderCapabilities.None)]
public class AccessDBProvider : ContainerCmdletProvider
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="34-35":::

<span data-ttu-id="0e8ef-120">Beachten Sie, dass in dieser Klassendefinition das [System. Management. Automation. Provider. cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) -Attribut zwei Parameter enthält.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-120">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="0e8ef-121">Der erste Parameter gibt einen benutzerfreundlichen Namen für den Anbieter an, der von Windows PowerShell verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-121">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="0e8ef-122">Der zweite Parameter gibt die Windows PowerShell-spezifischen Funktionen an, die der Anbieter während der Befehls Verarbeitung für die Windows PowerShell-Laufzeit verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-122">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="0e8ef-123">Für diesen Anbieter gibt es keine Windows PowerShell-spezifischen Funktionen, die hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-123">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="0e8ef-124">Definieren der Basisfunktionalität</span><span class="sxs-lookup"><span data-stu-id="0e8ef-124">Defining Base Functionality</span></span>

<span data-ttu-id="0e8ef-125">Wie unter [Entwerfen des Windows PowerShell-Anbieters](./designing-your-windows-powershell-provider.md)beschrieben, wird die [System. Management. Automation. Provider. containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) -Klasse von mehreren anderen Klassen abgeleitet, die unterschiedliche Anbieter Funktionen bereitgestellt haben.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-125">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="0e8ef-126">Ein Windows PowerShell-Container Anbieter muss daher alle Funktionen definieren, die von diesen Klassen bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-126">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="0e8ef-127">Informationen zum Implementieren von Funktionen zum Hinzufügen von Sitzungs spezifischen Initialisierungs Informationen und zum Freigeben von Ressourcen, die vom Anbieter verwendet werden, finden Sie unter [Erstellen eines einfachen Windows PowerShell-Anbieters](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-127">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span>
<span data-ttu-id="0e8ef-128">Die meisten Anbieter (einschließlich des hier beschriebenen Anbieters) können jedoch die Standard Implementierung dieser Funktionalität verwenden, die von Windows PowerShell bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-128">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="0e8ef-129">Um Zugriff auf den Datenspeicher zu erhalten, muss der Anbieter die Methoden der [System. Management. Automation. Provider. drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) -Basisklasse implementieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-129">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="0e8ef-130">Weitere Informationen zum Implementieren dieser Methoden finden Sie unter [Erstellen eines Windows PowerShell-Laufwerks Anbieters](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-130">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="0e8ef-131">Zum Bearbeiten der Elemente eines Datenspeicher, z. b. zum erhalten, festlegen und Löschen von Elementen, muss der Anbieter die von der [System. Management. Automation. Provider. itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) -Basisklasse bereitgestellten Methoden implementieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-131">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="0e8ef-132">Weitere Informationen zum Implementieren dieser Methoden finden Sie unter [Erstellen eines Windows PowerShell-Element Anbieters](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-132">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="0e8ef-133">Abrufen von untergeordneten Elementen</span><span class="sxs-lookup"><span data-stu-id="0e8ef-133">Retrieving Child Items</span></span>

<span data-ttu-id="0e8ef-134">Zum Abrufen eines untergeordneten Elements muss der Windows PowerShell-Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) -Methode überschreiben, um Aufrufe aus dem `Get-ChildItem` Cmdlet zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-134">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="0e8ef-135">Diese Methode ruft untergeordnete Elemente aus dem Datenspeicher ab und schreibt Sie als-Objekte in die Pipeline.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-135">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="0e8ef-136">Wenn der- `recurse` Parameter des Cmdlets angegeben ist, ruft die-Methode alle untergeordneten Elemente unabhängig von der Ebene ab, auf der Sie sich befinden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-136">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="0e8ef-137">Wenn der- `recurse` Parameter nicht angegeben ist, ruft die-Methode nur eine einzelne Ebene von untergeordneten Elementen ab.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-137">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="0e8ef-138">Hier ist die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) -Methode für diesen Anbieter.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-138">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="0e8ef-139">Beachten Sie, dass diese Methode die untergeordneten Elemente in allen Datenbanktabellen abruft, wenn der Pfad die Access-Datenbank angibt, und die untergeordneten Elemente aus den Zeilen dieser Tabelle abruft, wenn der Pfad eine Datentabelle angibt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-139">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="311-362":::

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="0e8ef-140">Dinge, die Sie beim Implementieren von getchilditems beachten sollten</span><span class="sxs-lookup"><span data-stu-id="0e8ef-140">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="0e8ef-141">Die folgenden Bedingungen können für Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)gelten:</span><span class="sxs-lookup"><span data-stu-id="0e8ef-141">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="0e8ef-142">Wenn Sie die Anbieter Klasse definieren, kann ein Windows PowerShell-Container Anbieter die Anbieter Funktionen von expandwildcards, Filtern, einschließen oder Ausschließen von der [System. Management. Automation. Provider. providerfunktionalitäten](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -Enumeration deklarieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-142">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0e8ef-143">In diesen Fällen muss die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) -Methode sicherstellen, dass der Pfad, der an die-Methode übergeben wird, die Anforderungen der angegebenen Funktionen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-143">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0e8ef-144">Zu diesem Zweck sollte die-Methode auf die entsprechende Eigenschaft zugreifen, z. b. die [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) -und [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) -Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-144">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="0e8ef-145">Die Implementierung dieser Methode muss jede Art von Zugriff auf das Element berücksichtigen, das das Element für den Benutzer sichtbar machen könnte.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-145">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="0e8ef-146">Wenn ein Benutzer beispielsweise über den File System-Anbieter Schreibzugriff auf eine Datei hat (von Windows PowerShell bereitgestellt), aber nicht über Lesezugriff verfügt, ist die Datei weiterhin vorhanden, und [System. Management. Automation. Provider. itemcmdletprovider. itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) gibt zurück `true` .</span><span class="sxs-lookup"><span data-stu-id="0e8ef-146">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="0e8ef-147">Ihre Implementierung erfordert möglicherweise das Überprüfen eines übergeordneten Elements, um festzustellen, ob das untergeordnete Element aufgelistet werden kann.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-147">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="0e8ef-148">Wenn Sie mehrere Elemente schreiben, kann die [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) -Methode einige Zeit in Anspruch nehmen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-148">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="0e8ef-149">Sie können Ihren Anbieter so entwerfen, dass die Elemente mithilfe der [System. Management. Automation. Provider. cmdletprovider. Write-temuject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) -Methode nacheinander geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-149">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="0e8ef-150">Mit dieser Technik werden die Elemente für den Benutzer in einem Stream angezeigt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-150">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="0e8ef-151">Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) ist dafür verantwortlich, eine unendliche Rekursion zu verhindern, wenn zirkuläre Verknüpfungen vorhanden sind, und wie.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-151">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="0e8ef-152">Eine entsprechende Beendigungs Ausnahme sollte ausgelöst werden, um eine solche Bedingung widerzuspiegeln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-152">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="0e8ef-153">Anfügen dynamischer Parameter an das Cmdlet "Get-ChildItem"</span><span class="sxs-lookup"><span data-stu-id="0e8ef-153">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="0e8ef-154">Manchmal `Get-ChildItem` erfordert das Cmdlet, das [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) aufruft, zusätzliche Parameter, die zur Laufzeit dynamisch angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-154">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0e8ef-155">Um diese dynamischen Parameter bereitzustellen, muss der Windows PowerShell-Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. getchilditemsdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) -Methode implementieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-155">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="0e8ef-156">Diese Methode ruft dynamische Parameter für das Element an dem angezeigten Pfad ab und gibt ein Objekt zurück, das über Eigenschaften und Felder mit ähnlichen Attributen wie eine Cmdlet-Klasse oder ein [System. Management. Automation. runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -Objekt verfügt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-156">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0e8ef-157">Die Windows PowerShell-Laufzeit verwendet das zurückgegebene-Objekt, um die Parameter zum `Get-ChildItem` Cmdlet hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-157">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="0e8ef-158">Diese Methode wird von diesem Windows PowerShell-Container Anbieter nicht implementiert.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-158">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="0e8ef-159">Der folgende Code ist jedoch die Standard Implementierung dieser Methode.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-159">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="0e8ef-160">Abrufen von untergeordneten Elementnamen</span><span class="sxs-lookup"><span data-stu-id="0e8ef-160">Retrieving Child Item Names</span></span>

<span data-ttu-id="0e8ef-161">Zum Abrufen der Namen von untergeordneten Elementen muss der Windows PowerShell-Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) -Methode überschreiben, um Aufrufe aus dem Cmdlet zu unterstützen, `Get-ChildItem` Wenn der `Name` Parameter angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-161">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="0e8ef-162">Diese Methode ruft die Namen der untergeordneten Elemente für den angegebenen Pfad oder die untergeordneten Elementnamen für alle Container ab, wenn der- `returnAllContainers` Parameter des Cmdlets angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-162">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="0e8ef-163">Ein untergeordneter Name ist der Blatt Teil eines Pfads.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-163">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="0e8ef-164">Der untergeordnete Name für den Pfad c:\windows\system32\abc.dll z. b. "abc.dll".</span><span class="sxs-lookup"><span data-stu-id="0e8ef-164">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="0e8ef-165">Der untergeordnete Name für das Verzeichnis c:\Windows\System32 lautet "System32".</span><span class="sxs-lookup"><span data-stu-id="0e8ef-165">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="0e8ef-166">Hier ist die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) -Methode für diesen Anbieter.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-166">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="0e8ef-167">Beachten Sie, dass die-Methode Tabellennamen abruft, wenn der angegebene Pfad die Zugriffs Datenbank (das Laufwerk) und die Zeilennummern angibt, wenn der Pfad eine Tabelle angibt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-167">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="369-411":::

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="0e8ef-168">Dinge, die Sie beim Implementieren von getchildnames beachten sollten</span><span class="sxs-lookup"><span data-stu-id="0e8ef-168">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="0e8ef-169">Die folgenden Bedingungen können für Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)gelten:</span><span class="sxs-lookup"><span data-stu-id="0e8ef-169">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="0e8ef-170">Wenn Sie die Anbieter Klasse definieren, kann ein Windows PowerShell-Container Anbieter die Anbieter Funktionen von expandwildcards, Filtern, einschließen oder Ausschließen von der [System. Management. Automation. Provider. providerfunktionalitäten](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -Enumeration deklarieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-170">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0e8ef-171">In diesen Fällen muss die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) -Methode sicherstellen, dass der Pfad, der an die-Methode übergeben wird, die Anforderungen der angegebenen Funktionen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-171">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0e8ef-172">Zu diesem Zweck sollte die-Methode auf die entsprechende Eigenschaft zugreifen, z. b. die [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) -und [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) -Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-172">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="0e8ef-173">Eine Ausnahme zu dieser Regel tritt auf, wenn der- `returnAllContainers` Parameter des Cmdlets angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-173">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="0e8ef-174">In diesem Fall sollte die-Methode jeden untergeordneten Namen für einen Container abrufen, auch wenn Sie nicht den Werten der Eigenschaften [System. Management. Automation. Provider. cmdletprovider. Filter \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)oder [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) entspricht.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-174">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="0e8ef-175">Standardmäßig sollten über schreibungen dieser Methode keine Namen von Objekten abrufen, die im Allgemeinen für den Benutzer ausgeblendet sind, es sei denn, die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft ist angegeben.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-175">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="0e8ef-176">Wenn der angegebene Pfad einen Container angibt, ist die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-176">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="0e8ef-177">Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) ist dafür verantwortlich, eine unendliche Rekursion zu verhindern, wenn zirkuläre Verknüpfungen vorhanden sind, und wie.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-177">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="0e8ef-178">Eine entsprechende Beendigungs Ausnahme sollte ausgelöst werden, um eine solche Bedingung widerzuspiegeln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-178">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="0e8ef-179">Anfügen dynamischer Parameter an das Cmdlet "Get-ChildItem" (Name)</span><span class="sxs-lookup"><span data-stu-id="0e8ef-179">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="0e8ef-180">Manchmal `Get-ChildItem` benötigt das Cmdlet (mit dem- `Name` Parameter) zusätzliche Parameter, die zur Laufzeit dynamisch angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-180">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0e8ef-181">Um diese dynamischen Parameter bereitzustellen, muss der Windows PowerShell-Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. getchildnamesdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) -Methode implementieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-181">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="0e8ef-182">Diese Methode ruft die dynamischen Parameter für das Element im angezeigten Pfad ab und gibt ein Objekt zurück, das über Eigenschaften und Felder mit Attribut Attributen verfügt, die einer Cmdlet-Klasse oder einem [System. Management. Automation. runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -Objekt ähneln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-182">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0e8ef-183">Die Windows PowerShell-Laufzeit verwendet das zurückgegebene-Objekt, um die Parameter zum `Get-ChildItem` Cmdlet hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-183">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="0e8ef-184">Diese Methode wird von diesem Anbieter nicht implementiert.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-184">This provider does not implement this method.</span></span> <span data-ttu-id="0e8ef-185">Der folgende Code ist jedoch die Standard Implementierung dieser Methode.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-185">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="0e8ef-186">Umbenennen von Elementen</span><span class="sxs-lookup"><span data-stu-id="0e8ef-186">Renaming Items</span></span>

<span data-ttu-id="0e8ef-187">Zum Umbenennen eines Elements muss ein Windows PowerShell-Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) -Methode überschreiben, um Aufrufe aus dem `Rename-Item` Cmdlet zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-187">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="0e8ef-188">Diese Methode ändert den Namen des Elements im angegebenen Pfad in den angegebenen neuen Namen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-188">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="0e8ef-189">Der neue Name muss immer relativ zum übergeordneten Element (Container) sein.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-189">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="0e8ef-190">Dieser Anbieter überschreibt nicht die [System. Management. Automation. Provider. containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) -Methode.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-190">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="0e8ef-191">Im folgenden finden Sie jedoch die Standard Implementierung.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-191">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="0e8ef-192">Dinge, die Sie beim Implementieren von RenameItem beachten sollten</span><span class="sxs-lookup"><span data-stu-id="0e8ef-192">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="0e8ef-193">Die folgenden Bedingungen können für Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem)gelten:</span><span class="sxs-lookup"><span data-stu-id="0e8ef-193">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="0e8ef-194">Wenn Sie die Anbieter Klasse definieren, kann ein Windows PowerShell-Container Anbieter die Anbieter Funktionen von expandwildcards, Filtern, einschließen oder Ausschließen von der [System. Management. Automation. Provider. providerfunktionalitäten](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -Enumeration deklarieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-194">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0e8ef-195">In diesen Fällen muss die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) -Methode sicherstellen, dass der Pfad, der an die-Methode übergeben wird, die Anforderungen der angegebenen Funktionen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-195">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0e8ef-196">Zu diesem Zweck sollte die-Methode auf die entsprechende Eigenschaft zugreifen, z. b. die [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) -und [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) -Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-196">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="0e8ef-197">Die [System. Management. Automation. Provider. containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) -Methode ist nur für die Änderung des Namens eines Elements und nicht für Verschiebe Vorgänge vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-197">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span>
  <span data-ttu-id="0e8ef-198">Die Implementierung der-Methode sollte einen Fehler schreiben, wenn der- `newName` Parameter Pfad Trennzeichen enthält oder andernfalls bewirkt, dass das Element seinen übergeordneten Speicherort ändert.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-198">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="0e8ef-199">Standardmäßig sollten über schreibungen dieser Methode Objekte nicht umbenennen, es sei denn, die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft ist angegeben.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-199">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="0e8ef-200">Wenn der angegebene Pfad einen Container angibt, ist die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-200">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="0e8ef-201">Ihre Implementierung der [System. Management. Automation. Provider. containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) -Methode sollte [System. Management. Automation. Provider. cmdletprovider. rechtdprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) aufzurufen und ihren Rückgabewert überprüfen, bevor Änderungen am Datenspeicher vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-201">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0e8ef-202">Diese Methode wird verwendet, um die Ausführung eines Vorgangs zu bestätigen, wenn eine Änderung am Systemstatus vorgenommen wird, z. b. beim Umbenennen von Dateien.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-202">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span>
  <span data-ttu-id="0e8ef-203">[System. Management. Automation. Provider. cmdletprovider. undprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sendet den Namen der Ressource, die an den Benutzer geändert werden soll, wobei die Windows PowerShell-Laufzeit alle Befehlszeilen Einstellungen oder Einstellungs Variablen unternimmt, um zu bestimmen, was angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-203">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="0e8ef-204">Nachdem der System. [Management. Automation. Provider. cmdletprovider. schuldprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) -Befehl zurückgegeben `true` wurde, sollte die [System. Management. Automation. Provider. containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) -Methode die [System. Management. Automation. Provider. cmdletprovider. schuldcontinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) -Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-204">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="0e8ef-205">Diese Methode sendet eine Meldung eine Bestätigungsmeldung an den Benutzer, um zusätzliche Feedback zu geben, um zu bestätigen, dass der Vorgang fortgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-205">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="0e8ef-206">Ein Anbieter sollte [System. Management. Automation. Provider. cmdletprovider. undcontinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) als zusätzliche Überprüfung auf potenziell gefährliche System Änderungen abrufen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-206">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="0e8ef-207">Anfügen dynamischer Parameter an das Cmdlet "Rename-Item"</span><span class="sxs-lookup"><span data-stu-id="0e8ef-207">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="0e8ef-208">Manchmal `Rename-Item` benötigt das Cmdlet zusätzliche Parameter, die zur Laufzeit dynamisch angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-208">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0e8ef-209">Um diese dynamischen Parameter bereitzustellen, muss der Windows PowerShell-Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. renameitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) -Methode implementieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-209">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="0e8ef-210">Diese Methode ruft die Parameter für das Element im angezeigten Pfad ab und gibt ein Objekt zurück, das über Eigenschaften und Felder mit Attribut Attributen verfügt, die einer Cmdlet-Klasse oder einem [System. Management. Automation. runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -Objekt ähneln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-210">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0e8ef-211">Die Windows PowerShell-Laufzeit verwendet das zurückgegebene-Objekt, um die Parameter zum `Rename-Item` Cmdlet hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-211">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="0e8ef-212">Dieser Container Anbieter implementiert diese Methode nicht.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-212">This container provider does not implement this method.</span></span> <span data-ttu-id="0e8ef-213">Der folgende Code ist jedoch die Standard Implementierung dieser Methode.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-213">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="0e8ef-214">Erstellen neuer Elemente</span><span class="sxs-lookup"><span data-stu-id="0e8ef-214">Creating New Items</span></span>

<span data-ttu-id="0e8ef-215">Um neue Elemente zu erstellen, muss ein Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) -Methode implementieren, um Aufrufe vom `New-Item` Cmdlet zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-215">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="0e8ef-216">Diese Methode erstellt ein Datenelement, das sich unter dem angegebenen Pfad befindet.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-216">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="0e8ef-217">Der `type` -Parameter des Cmdlets enthält den Anbieter definierten Typ für das neue Element.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-217">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="0e8ef-218">Beispielsweise verwendet der File System-Anbieter einen `type` Parameter mit dem Wert "file" oder "Directory".</span><span class="sxs-lookup"><span data-stu-id="0e8ef-218">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="0e8ef-219">Der `newItemValue` -Parameter des Cmdlets gibt einen anbieterspezifischen Wert für das neue Element an.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-219">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="0e8ef-220">Hier ist die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) -Methode für diesen Anbieter.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-220">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type, object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="939-955":::

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="0e8ef-221">Dinge, die Sie beim Implementieren von "netwitem</span><span class="sxs-lookup"><span data-stu-id="0e8ef-221">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="0e8ef-222">Die folgenden Bedingungen können für Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)gelten:</span><span class="sxs-lookup"><span data-stu-id="0e8ef-222">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="0e8ef-223">Die [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) -Methode sollte einen Vergleich der im-Parameter übergebenen Zeichenfolge ohne Beachtung der Groß-/Kleinschreibung durchführen `type` .</span><span class="sxs-lookup"><span data-stu-id="0e8ef-223">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span>
  <span data-ttu-id="0e8ef-224">Außerdem sollten Sie mindestens mehrdeutige Übereinstimmungen zulassen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-224">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="0e8ef-225">Beispielsweise ist für die Typen "file" und "Directory" nur der erste Buchstabe erforderlich, um die Eindeutigkeit zu unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-225">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="0e8ef-226">Wenn der- `type` Parameter einen Typ angibt, der vom Anbieter nicht erstellt werden kann, sollte die [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) -Methode eine ArgumentException mit einer Meldung schreiben, die die Typen angibt, die der Anbieter erstellen kann.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-226">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="0e8ef-227">Für den- `newItemValue` Parameter wird empfohlen, dass die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) -Methode mindestens Zeichen folgen akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-227">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="0e8ef-228">Außerdem sollte Sie den Typ des Objekts akzeptieren, das von der [System. Management. Automation. Provider. itemcmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) -Methode für denselben Pfad abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-228">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="0e8ef-229">Die [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) -Methode kann die [System. Management. Automation. LanguagePrimitives. ConvertTo \*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) -Methode verwenden, um Typen in den gewünschten Typ zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-229">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="0e8ef-230">Ihre Implementierung der [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) -Methode sollte [System. Management. Automation. Provider. cmdletprovider. rechtdprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) und den zugehörigen Rückgabewert überprüfen, bevor Änderungen am Datenspeicher vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-230">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0e8ef-231">Nachdem der System. [Management. Automation. Provider. cmdletprovider. rechtdprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) -Befehl true zurückgegeben hat, sollte die [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) -Methode die [System. Management. Automation. Provider. cmdletprovider. rechtdcontinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) -Methode als zusätzliche Überprüfung auf potenziell gefährliche System Änderungen abrufen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-231">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="0e8ef-232">Anfügen dynamischer Parameter an das Cmdlet "New-Item"</span><span class="sxs-lookup"><span data-stu-id="0e8ef-232">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="0e8ef-233">Manchmal `New-Item` benötigt das Cmdlet zusätzliche Parameter, die zur Laufzeit dynamisch angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-233">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0e8ef-234">Um diese dynamischen Parameter bereitzustellen, muss der Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. netwitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) -Methode implementieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-234">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="0e8ef-235">Diese Methode ruft die Parameter für das Element im angezeigten Pfad ab und gibt ein Objekt zurück, das über Eigenschaften und Felder mit Attribut Attributen verfügt, die einer Cmdlet-Klasse oder einem [System. Management. Automation. runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -Objekt ähneln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-235">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0e8ef-236">Die Windows PowerShell-Laufzeit verwendet das zurückgegebene-Objekt, um die Parameter zum `New-Item` Cmdlet hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-236">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="0e8ef-237">Diese Methode wird von diesem Anbieter nicht implementiert.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-237">This provider does not implement this method.</span></span> <span data-ttu-id="0e8ef-238">Der folgende Code ist jedoch die Standard Implementierung dieser Methode.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-238">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="0e8ef-239">Entfernen von Elementen</span><span class="sxs-lookup"><span data-stu-id="0e8ef-239">Removing Items</span></span>

<span data-ttu-id="0e8ef-240">Zum Entfernen von Elementen muss der Windows PowerShell-Anbieter die [System. Management. Automation. Provider. containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) -Methode überschreiben, um Aufrufe aus dem `Remove-Item` Cmdlet zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-240">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="0e8ef-241">Diese Methode löscht ein Element im angegebenen Pfad aus dem Datenspeicher.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-241">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="0e8ef-242">Wenn der- `recurse` Parameter des `Remove-Item` Cmdlets auf festgelegt ist `true` , entfernt die Methode alle untergeordneten Elemente unabhängig von ihrer Ebene.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-242">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="0e8ef-243">Wenn der-Parameter auf festgelegt ist `false` , wird von der-Methode nur ein einzelnes Element im angegebenen Pfad entfernt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-243">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="0e8ef-244">Dieser Anbieter unterstützt das Entfernen von Elementen nicht.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-244">This provider does not support item removal.</span></span> <span data-ttu-id="0e8ef-245">Der folgende Code ist jedoch die Standard Implementierung von [System. Management. Automation. Provider. containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-245">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="0e8ef-246">Dinge, die Sie beim Implementieren von RemoveItem beachten sollten</span><span class="sxs-lookup"><span data-stu-id="0e8ef-246">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="0e8ef-247">Die folgenden Bedingungen können für Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. netwitem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)gelten:</span><span class="sxs-lookup"><span data-stu-id="0e8ef-247">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="0e8ef-248">Wenn Sie die Anbieter Klasse definieren, kann ein Windows PowerShell-Container Anbieter die Anbieter Funktionen von expandwildcards, Filtern, einschließen oder Ausschließen von der [System. Management. Automation. Provider. providerfunktionalitäten](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -Enumeration deklarieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-248">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0e8ef-249">In diesen Fällen muss die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) -Methode sicherstellen, dass der Pfad, der an die-Methode übergeben wird, die Anforderungen der angegebenen Funktionen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-249">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0e8ef-250">Zu diesem Zweck sollte die-Methode auf die entsprechende Eigenschaft zugreifen, z. b. die [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) -und [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) -Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-250">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="0e8ef-251">Standardmäßig sollten über schreibungen dieser Methode Objekte nicht entfernen, es sei denn, die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft ist auf true festgelegt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-251">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="0e8ef-252">Wenn der angegebene Pfad einen Container angibt, ist die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-252">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="0e8ef-253">Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) ist dafür verantwortlich, eine unendliche Rekursion zu verhindern, wenn zirkuläre Verknüpfungen vorhanden sind, und wie.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-253">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="0e8ef-254">Eine entsprechende Beendigungs Ausnahme sollte ausgelöst werden, um eine solche Bedingung widerzuspiegeln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-254">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="0e8ef-255">Ihre Implementierung der [System. Management. Automation. Provider. containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) -Methode sollte [System. Management. Automation. Provider. cmdletprovider. rechtdprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) aufzurufen und ihren Rückgabewert überprüfen, bevor Änderungen am Datenspeicher vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-255">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0e8ef-256">Nachdem der System. [Management. Automation. Provider. cmdletprovider. rechtdprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) -Befehl zurückgegeben `true` wurde, sollte die [System. Management. Automation. Provider. containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) -Methode die [System. Management. Automation. Provider. cmdletprovider. rechtdcontinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) -Methode als zusätzliche Überprüfung auf potenziell gefährliche System Änderungen aufruft.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-256">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="0e8ef-257">Anfügen dynamischer Parameter an das Cmdlet "Remove-Item"</span><span class="sxs-lookup"><span data-stu-id="0e8ef-257">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="0e8ef-258">Manchmal `Remove-Item` benötigt das Cmdlet zusätzliche Parameter, die zur Laufzeit dynamisch angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-258">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0e8ef-259">Um diese dynamischen Parameter bereitzustellen, muss der Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. removeitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) -Methode implementieren, um diese Parameter zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-259">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="0e8ef-260">Diese Methode ruft die dynamischen Parameter für das Element im angezeigten Pfad ab und gibt ein Objekt zurück, das über Eigenschaften und Felder mit Attribut Attributen verfügt, die einer Cmdlet-Klasse oder einem [System. Management. Automation. runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -Objekt ähneln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-260">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0e8ef-261">Die Windows PowerShell-Laufzeit verwendet das zurückgegebene-Objekt, um die Parameter zum `Remove-Item` Cmdlet hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-261">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="0e8ef-262">Dieser Container Anbieter implementiert diese Methode nicht.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-262">This container provider does not implement this method.</span></span> <span data-ttu-id="0e8ef-263">Der folgende Code ist jedoch die Standard Implementierung von [System. Management. Automation. Provider. containercmdletprovider. removeitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-263">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="0e8ef-264">Abfragen von untergeordneten Elementen</span><span class="sxs-lookup"><span data-stu-id="0e8ef-264">Querying for Child Items</span></span>

<span data-ttu-id="0e8ef-265">Um festzustellen, ob untergeordnete Elemente im angegebenen Pfad vorhanden sind, muss der Windows PowerShell-Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) -Methode überschreiben.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-265">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="0e8ef-266">Diese Methode gibt zurück `true` , wenn das Element über untergeordnete Elemente verfügt, und `false` andernfalls.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-266">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="0e8ef-267">Bei einem NULL-oder leeren Pfad betrachtet die Methode alle Elemente im Datenspeicher als untergeordnete Elemente und gibt zurück `true` .</span><span class="sxs-lookup"><span data-stu-id="0e8ef-267">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="0e8ef-268">Dies ist die außer Kraft setzung der [System. Management. Automation. Provider. containercmdletprovider. haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) -Methode.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-268">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="0e8ef-269">Wenn mehr als zwei Pfad Teile von der Hilfsmethode "chunkpath" erstellt werden, gibt die Methode zurück `false` , da nur ein Daten Bank Container und ein Tabellen Container definiert werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-269">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="0e8ef-270">Weitere Informationen zu dieser Hilfsmethode finden Sie unter [Erstellen eines Windows PowerShell-Element Anbieters](./creating-a-windows-powershell-item-provider.md)mithilfe der Methode "chunkpath".</span><span class="sxs-lookup"><span data-stu-id="0e8ef-270">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="1094-1097":::

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="0e8ef-271">Dinge, die Sie beim Implementieren von haschilditems beachten sollten</span><span class="sxs-lookup"><span data-stu-id="0e8ef-271">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="0e8ef-272">Die folgenden Bedingungen können für Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems)gelten:</span><span class="sxs-lookup"><span data-stu-id="0e8ef-272">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="0e8ef-273">Wenn der Container Anbieter einen Stamm verfügbar macht, der interessante Bereitstellungs Punkte enthält, sollte die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) -Methode zurückgeben, `true` Wenn für den Pfad eine NULL-oder eine leere Zeichenfolge übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-273">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="0e8ef-274">Kopieren von Elementen</span><span class="sxs-lookup"><span data-stu-id="0e8ef-274">Copying Items</span></span>

<span data-ttu-id="0e8ef-275">Zum Kopieren von Elementen muss der Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) -Methode implementieren, um Aufrufe aus dem `Copy-Item` Cmdlet zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-275">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="0e8ef-276">Diese Methode kopiert ein Datenelement von dem Speicherort, der durch den- `path` Parameter des Cmdlets angegeben wird, an die durch den-Parameter festgelegten Speicherort `copyPath` .</span><span class="sxs-lookup"><span data-stu-id="0e8ef-276">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="0e8ef-277">Wenn der- `recurse` Parameter angegeben wird, kopiert die-Methode alle unter Container.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-277">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="0e8ef-278">Wenn der-Parameter nicht angegeben wird, kopiert die-Methode nur eine einzelne Element Ebene.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-278">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="0e8ef-279">Diese Methode wird von diesem Anbieter nicht implementiert.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-279">This provider does not implement this method.</span></span> <span data-ttu-id="0e8ef-280">Der folgende Code ist jedoch die Standard Implementierung von [System. Management. Automation. Provider. containercmdletprovider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-280">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="0e8ef-281">Dinge, die Sie bei der Implementierung von CopyItem beachten sollten</span><span class="sxs-lookup"><span data-stu-id="0e8ef-281">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="0e8ef-282">Die folgenden Bedingungen können für Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem)gelten:</span><span class="sxs-lookup"><span data-stu-id="0e8ef-282">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="0e8ef-283">Wenn Sie die Anbieter Klasse definieren, kann ein Windows PowerShell-Container Anbieter die Anbieter Funktionen von expandwildcards, Filtern, einschließen oder Ausschließen von der [System. Management. Automation. Provider. providerfunktionalitäten](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -Enumeration deklarieren.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-283">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0e8ef-284">In diesen Fällen muss die Implementierung der [System. Management. Automation. Provider. containercmdletprovider. getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) -Methode sicherstellen, dass der Pfad, der an die-Methode übergeben wird, die Anforderungen der angegebenen Funktionen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-284">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="0e8ef-285">Zu diesem Zweck sollte die-Methode auf die entsprechende Eigenschaft zugreifen, z. b. die [System. Management. Automation. Provider. cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) -und [System. Management. Automation. Provider. cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) -Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-285">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="0e8ef-286">Standardmäßig sollten über schreibungen dieser Methode Objekte nicht über vorhandene Objekte kopieren, es sei denn, die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft ist auf festgelegt `true` .</span><span class="sxs-lookup"><span data-stu-id="0e8ef-286">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="0e8ef-287">Beispielsweise kopiert der File System-Anbieter c:\temp\abc.txt nicht über eine vorhandene c:\abc.txt Datei, es sei denn, die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft ist auf festgelegt `true` .</span><span class="sxs-lookup"><span data-stu-id="0e8ef-287">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="0e8ef-288">Wenn der im `copyPath` -Parameter angegebene Pfad vorhanden ist und einen Container angibt, ist die [System. Management. Automation. Provider. cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaft nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-288">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="0e8ef-289">In diesem Fall sollte [System. Management. Automation. Provider. containercmdletprovider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) das durch den-Parameter festgestellte Element in den Container kopieren, der `path` durch den-Parameter als untergeordnetes Element angegeben wird `copyPath` .</span><span class="sxs-lookup"><span data-stu-id="0e8ef-289">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="0e8ef-290">Ihre Implementierung von [System. Management. Automation. Provider. containercmdletprovider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) ist dafür verantwortlich, eine unendliche Rekursion zu verhindern, wenn zirkuläre Verknüpfungen vorhanden sind, und wie.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-290">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="0e8ef-291">Eine entsprechende Beendigungs Ausnahme sollte ausgelöst werden, um eine solche Bedingung widerzuspiegeln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-291">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="0e8ef-292">Ihre Implementierung der [System. Management. Automation. Provider. containercmdletprovider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) -Methode sollte [System. Management. Automation. Provider. cmdletprovider. rechtdprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) aufzurufen und ihren Rückgabewert überprüfen, bevor Änderungen am Datenspeicher vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-292">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0e8ef-293">Nachdem der System. [Management. Automation. Provider. cmdletprovider. rechtdprocess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) -Befehl true zurückgegeben hat, sollte die [System. Management. Automation. Provider. containercmdletprovider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) -Methode die [System. Management. Automation. Provider. cmdletprovider. rechtdcontinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) -Methode als zusätzliche Überprüfung auf potenziell gefährliche System Änderungen aufruft.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-293">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="0e8ef-294">Weitere Informationen zum Aufrufen dieser Methoden finden Sie unter [Umbenennen von Elementen](#renaming-items).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-294">For more information about calling these methods, see [Rename Items](#renaming-items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="0e8ef-295">Anfügen dynamischer Parameter an das Cmdlet "Copy-Item"</span><span class="sxs-lookup"><span data-stu-id="0e8ef-295">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="0e8ef-296">Manchmal `Copy-Item` benötigt das Cmdlet zusätzliche Parameter, die zur Laufzeit dynamisch angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-296">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="0e8ef-297">Um diese dynamischen Parameter bereitzustellen, muss der Windows PowerShell-Container Anbieter die [System. Management. Automation. Provider. containercmdletprovider. copyitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) -Methode implementieren, um diese Parameter zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-297">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="0e8ef-298">Diese Methode ruft die Parameter für das Element im angezeigten Pfad ab und gibt ein Objekt zurück, das über Eigenschaften und Felder mit Attribut Attributen verfügt, die einer Cmdlet-Klasse oder einem [System. Management. Automation. runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -Objekt ähneln.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-298">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="0e8ef-299">Die Windows PowerShell-Laufzeit verwendet das zurückgegebene-Objekt, um die Parameter zum `Copy-Item` Cmdlet hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-299">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="0e8ef-300">Diese Methode wird von diesem Anbieter nicht implementiert.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-300">This provider does not implement this method.</span></span> <span data-ttu-id="0e8ef-301">Der folgende Code ist jedoch die Standard Implementierung von [System. Management. Automation. Provider. containercmdletprovider. copyitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-301">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="0e8ef-302">Codebeispiel</span><span class="sxs-lookup"><span data-stu-id="0e8ef-302">Code Sample</span></span>

<span data-ttu-id="0e8ef-303">Einen umfassenden Beispielcode finden Sie unter [AccessDbProviderSample04-Codebeispiel](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-303">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="0e8ef-304">Entwickeln des Windows PowerShell-Anbieters</span><span class="sxs-lookup"><span data-stu-id="0e8ef-304">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="0e8ef-305">Weitere Informationen finden [Sie unter Registrieren von Cmdlets, Anbietern und Host Anwendungen](/previous-versions/ms714644(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="0e8ef-305">See [How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85)).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="0e8ef-306">Testen des Windows PowerShell-Anbieters</span><span class="sxs-lookup"><span data-stu-id="0e8ef-306">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="0e8ef-307">Wenn Ihr Windows PowerShell-Anbieter bei Windows PowerShell registriert wurde, können Sie ihn testen, indem Sie die unterstützten Cmdlets in der Befehlszeile ausführen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-307">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="0e8ef-308">Beachten Sie, dass die folgende Beispielausgabe eine fiktive Access-Datenbank verwendet.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-308">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="0e8ef-309">Führen Sie das- `Get-ChildItem` Cmdlet aus, um die Liste der untergeordneten Elemente aus einer Customers-Tabelle in der Access-Datenbank abzurufen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-309">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="0e8ef-310">Die folgende Ausgabe wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-310">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="0e8ef-311">Führen `Get-ChildItem` Sie das Cmdlet erneut aus, um die Daten einer Tabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-311">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="0e8ef-312">Die folgende Ausgabe wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-312">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="0e8ef-313">Verwenden Sie nun das `Get-Item` Cmdlet, um die Elemente in Zeile 0 in der Datentabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-313">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="0e8ef-314">Die folgende Ausgabe wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-314">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="0e8ef-315">Wird verwendet `Get-Item` , um die Daten für die Elemente in Zeile 0 abzurufen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-315">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="0e8ef-316">Die folgende Ausgabe wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-316">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="0e8ef-317">Verwenden Sie nun das `New-Item` Cmdlet, um eine Zeile zu einer vorhandenen Tabelle hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-317">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="0e8ef-318">Der `Path` -Parameter gibt den vollständigen Pfad zur Zeile an und muss eine Zeilennummer angeben, die größer ist als die vorhandene Anzahl von Zeilen in der Tabelle.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-318">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="0e8ef-319">Der- `Type` Parameter gibt "Row" an, um den Typ des hinzu zufügenden Elements anzugeben.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-319">The `Type` parameter indicates "row" to specify that type of item to add.</span></span>
   <span data-ttu-id="0e8ef-320">Schließlich gibt der- `Value` Parameter eine durch Trennzeichen getrennte Liste von Spaltenwerten für die Zeile an.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-320">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="0e8ef-321">Überprüfen Sie die Richtigkeit des Vorgangs des neuen Elements wie folgt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-321">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="0e8ef-322">Die folgende Ausgabe wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="0e8ef-322">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="0e8ef-323">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="0e8ef-323">See Also</span></span>

[<span data-ttu-id="0e8ef-324">Erstellen von Windows PowerShell-Anbietern</span><span class="sxs-lookup"><span data-stu-id="0e8ef-324">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="0e8ef-325">Entwerfen eines Windows PowerShell-Anbieters</span><span class="sxs-lookup"><span data-stu-id="0e8ef-325">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="0e8ef-326">Implementieren eines Windows PowerShell-Anbieters für Elemente</span><span class="sxs-lookup"><span data-stu-id="0e8ef-326">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="0e8ef-327">Implementieren eines Windows PowerShell-navigationsanbieters</span><span class="sxs-lookup"><span data-stu-id="0e8ef-327">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

<span data-ttu-id="0e8ef-328">[Registrieren von Cmdlets, Anbietern und Host Anwendungen](/previous-versions/ms714644(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="0e8ef-328">[How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85))</span></span>

[<span data-ttu-id="0e8ef-329">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="0e8ef-329">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="0e8ef-330">Windows PowerShell-Programmiererhandbuch</span><span class="sxs-lookup"><span data-stu-id="0e8ef-330">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)
