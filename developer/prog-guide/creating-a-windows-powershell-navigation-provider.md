---
title: Erstellen eine Windows PowerShell-Navigationsanbieter | Microsoft-Dokumentation
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- navigation providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], navigation provider
ms.assetid: 8bd3224d-ca6f-4640-9464-cb4d9f4e13b1
caps.latest.revision: 5
ms.openlocfilehash: 5f7a61e261399d3d2abe62fe4523e8c9895d5ad4
ms.sourcegitcommit: 01b81317029b28dd9b61d167045fd31f1ec7bc06
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/17/2019
ms.locfileid: "65855171"
---
# <a name="creating-a-windows-powershell-navigation-provider"></a><span data-ttu-id="15298-102">Erstellen eines Windows PowerShell-Navigationsanbieters</span><span class="sxs-lookup"><span data-stu-id="15298-102">Creating a Windows PowerShell Navigation Provider</span></span>

<span data-ttu-id="15298-103">Dieses Thema beschreibt, wie Sie eine Windows PowerShell-Navigationsanbieter zu erstellen, die den Datenspeicher navigieren kann.</span><span class="sxs-lookup"><span data-stu-id="15298-103">This topic describes how to create a Windows PowerShell navigation provider that can navigate the data store.</span></span> <span data-ttu-id="15298-104">Dieser Anbieter unterstützt rekursive Befehle, geschachtelte Container und relative Pfade.</span><span class="sxs-lookup"><span data-stu-id="15298-104">This type of provider supports recursive commands, nested containers, and relative paths.</span></span>

> [!NOTE]
> <span data-ttu-id="15298-105">Sie können die C# Quelldatei (AccessDBSampleProvider05.cs) für diesen Anbieter, die mit dem Microsoft Windows Software Development Kit für Windows Vista und .NET Framework 3.0-Laufzeitkomponenten.</span><span class="sxs-lookup"><span data-stu-id="15298-105">You can download the C# source file (AccessDBSampleProvider05.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="15298-106">Anweisungen zum Herunterladen, finden Sie unter [das Installieren von Windows PowerShell und das Windows PowerShell-SDK-Download](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="15298-106">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="15298-107">Die heruntergeladene Quelldateien stehen in der  **\<PowerShell-Beispiele >** Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="15298-107">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="15298-108">Weitere Informationen zu anderen Implementierungen der Windows PowerShell-Anbieter, finden Sie unter [Entwerfen Ihrer Windows PowerShell-Anbieter](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="15298-108">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="15298-109">Der Anbieter, die hier beschriebenen ermöglicht der Benutzerhandle einer Access-Datenbank als Laufwerk, sodass der Benutzer, um die Datentabellen in der Datenbank navigieren können.</span><span class="sxs-lookup"><span data-stu-id="15298-109">The provider described here enables the user handle an Access database as a drive so that the user can navigate to the data tables in the database.</span></span> <span data-ttu-id="15298-110">Wenn Sie Ihren eigenen Navigationsanbieter zu erstellen, können Sie Methoden implementieren, die laufwerkbezogenen Pfade, die für die Navigation erforderlich machen, relative Pfade zu normalisieren, Verschieben von Elementen, die Data-Speicher als auch Methoden, die untergeordnete Namen zu erhalten, rufen Sie den übergeordneten Pfad eines Elements und testen können um zu identifizieren, wenn ein Element ein Container ist.</span><span class="sxs-lookup"><span data-stu-id="15298-110">When creating your own navigation provider, you can implement methods that can make drive-qualified paths required for navigation, normalize relative paths, move items of the data store, as well as methods that get child names, get the parent path of an item, and test to identify if an item is a container.</span></span>

> [!CAUTION]
> <span data-ttu-id="15298-111">Denken Sie daran, dass dieser Entwurf einer Datenbank geht davon aus, die ein Feld mit der namens-ID und der Typ des Felds LongInteger ist.</span><span class="sxs-lookup"><span data-stu-id="15298-111">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

## <a name="define-the-windows-powershell-provider"></a><span data-ttu-id="15298-112">Definieren Sie den Windows PowerShell-Anbieter</span><span class="sxs-lookup"><span data-stu-id="15298-112">Define the Windows PowerShell provider</span></span>

<span data-ttu-id="15298-113">Ein Windows PowerShell-Navigationsanbieter muss eine abgeleitete Klasse .NET erstellen, die [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) Basisklasse.</span><span class="sxs-lookup"><span data-stu-id="15298-113">A Windows PowerShell navigation provider must create a .NET class that derives from the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class.</span></span> <span data-ttu-id="15298-114">Hier ist die Definition der Klasse für den Navigationsbereich-Anbieter, die in diesem Abschnitt beschrieben.</span><span class="sxs-lookup"><span data-stu-id="15298-114">Here is the class definition for the navigation provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L31-L32 "AccessDBProviderSample05.cs")]

<span data-ttu-id="15298-115">Beachten Sie, dass in diesem Anbieter die [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) Attribut enthält zwei Parameter.</span><span class="sxs-lookup"><span data-stu-id="15298-115">Note that in this provider, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="15298-116">Der erste Parameter gibt einen benutzerfreundlichen Namen für den Anbieter, der von Windows PowerShell verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="15298-116">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="15298-117">Der zweite Parameter gibt die spezifischen Windows PowerShell-Funktionen, die der Anbieter für die Windows PowerShell-Laufzeit während der befehlsverarbeitung verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="15298-117">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="15298-118">Für diesen Anbieter sind keine bestimmten Windows PowerShell-Funktionen, die hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="15298-118">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="15298-119">Definiert die grundlegenden Funktionen</span><span class="sxs-lookup"><span data-stu-id="15298-119">Defining Base Functionality</span></span>

<span data-ttu-id="15298-120">Siehe [Ihr Design-PS-Anbieter](./designing-your-windows-powershell-provider.md), [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) Basisklasse abgeleitet wird, von anderen Klassen, die anderen Anbieter bereitgestellt die Funktionalität.</span><span class="sxs-lookup"><span data-stu-id="15298-120">As described in [Design Your PS Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="15298-121">Ein Windows PowerShell-Navigationsanbieter, muss daher alle die Funktionalität von diesen Klassen definieren.</span><span class="sxs-lookup"><span data-stu-id="15298-121">A Windows PowerShell navigation provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="15298-122">Zum Implementieren der Funktionalität, die sitzungsspezifischen Initialisierungsinformationen hinzufügen und Freigeben von Ressourcen, die vom Anbieter verwendet werden, finden Sie unter [Erstellen eines grundlegenden PS-Anbieters](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="15298-122">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic PS Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="15298-123">Die meisten Anbieter (einschließlich des Anbieters, die hier beschriebene) können jedoch die standardmäßige Implementierung dieser Funktionalität von Windows PowerShell verwenden.</span><span class="sxs-lookup"><span data-stu-id="15298-123">However, most providers (including the provider described here) can use the default implementation of this functionality provided by Windows PowerShell.</span></span>

<span data-ttu-id="15298-124">Um Zugriff auf den Datenspeicher über ein Windows PowerShell-Laufwerk zu erhalten, müssen Sie die Methoden der implementieren die [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) Basisklasse.</span><span class="sxs-lookup"><span data-stu-id="15298-124">To get access to the data store through a Windows PowerShell drive, you must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="15298-125">Weitere Informationen zu diesen Methoden implementiert werden, finden Sie unter [erstellen ein Windows PowerShell-Laufwerk-Anbieter](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="15298-125">For more information about implementing these methods, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="15298-126">Der Anbieter muss zum Bearbeiten der Elemente von einem Datenspeicher, z. B. abrufen, festlegen und Löschen von Elementen, die vom bereitgestellten Methoden implementieren die [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) Basisklasse.</span><span class="sxs-lookup"><span data-stu-id="15298-126">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="15298-127">Weitere Informationen zu diesen Methoden implementiert werden, finden Sie unter [erstellen eine Windows PowerShell-Elementanbieter](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="15298-127">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

<span data-ttu-id="15298-128">Rufen Sie die untergeordneten Elemente oder ihren Namen, der die Data-Speicher als auch Methoden, die zu erstellen, kopieren, umbenennen und Entfernen von Elementen, müssen Sie die vom bereitgestellten Methoden implementieren die [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)Basisklasse.</span><span class="sxs-lookup"><span data-stu-id="15298-128">To get to the child items, or their names, of the data store, as well as methods that create, copy, rename, and remove items, you must implement the methods provided by the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="15298-129">Weitere Informationen zu diesen Methoden implementiert werden, finden Sie unter [erstellen eine Windows PowerShell-Containeranbieter](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="15298-129">For more information about implementing these methods, see [Creating a Windows PowerShell Container Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="creating-a-windows-powershell-path"></a><span data-ttu-id="15298-130">Beim Erstellen eines Windows PowerShell-Pfads</span><span class="sxs-lookup"><span data-stu-id="15298-130">Creating a Windows PowerShell Path</span></span>

<span data-ttu-id="15298-131">Windows PowerShell-Navigationsanbieter verwenden einen internen Anbieter-Windows PowerShell-Pfad, um die Elemente des Datenspeichers zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="15298-131">Windows PowerShell navigation provider use a provider-internal Windows PowerShell path to navigate the items of the data store.</span></span> <span data-ttu-id="15298-132">Zum Erstellen von eines Anbieter-internen Pfads des Anbieters müssen implementieren die [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) Methodenaufrufe für die Unterstützung des kombinieren-Path-Cmdlets.</span><span class="sxs-lookup"><span data-stu-id="15298-132">To create a provider-internal path the provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method to supports calls from the Combine-Path cmdlet.</span></span> <span data-ttu-id="15298-133">Diese Methode kombiniert einen übergeordneten und untergeordneten Pfad zu einer internen Anbieter-Pfad mit einem anbieterspezifischen Pfadtrennzeichen zwischen übergeordneten und untergeordneten Pfade an.</span><span class="sxs-lookup"><span data-stu-id="15298-133">This method combines a parent and child path into a provider-internal path, using a provider-specific path separator between the parent and child paths.</span></span>

<span data-ttu-id="15298-134">Die Standardimplementierung akzeptiert Pfade mit "/" oder "\\"als Pfadtrennzeichen, normalisiert auf Pfadtrennzeichen"\\", die Teile mit übergeordneten und untergeordneten Pfad kombiniert, mit dem Trennzeichen zwischen ihnen und gibt dann eine Zeichenfolge, enthält die kombinierten Pfade.</span><span class="sxs-lookup"><span data-stu-id="15298-134">The default implementation takes paths with "/" or "\\" as the path separator, normalizes the path separator to "\\", combines the parent and child path parts with the separator between them, and then returns a string that contains the combined paths.</span></span>

<span data-ttu-id="15298-135">Dieser Navigationsanbieter implementiert diese Methode nicht.</span><span class="sxs-lookup"><span data-stu-id="15298-135">This navigation provider does not implement this method.</span></span> <span data-ttu-id="15298-136">Der folgende Code ist jedoch die standardmäßige Implementierung der [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) Methode.</span><span class="sxs-lookup"><span data-stu-id="15298-136">However, the following code is the default implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermakepath](Msh_samplestestcmdlets#testprovidermakepath)]  -->

#### <a name="things-to-remember-about-implementing-makepath"></a><span data-ttu-id="15298-137">Punkte zu beachten, die zum Implementieren von MakePath</span><span class="sxs-lookup"><span data-stu-id="15298-137">Things to Remember About Implementing MakePath</span></span>

<span data-ttu-id="15298-138">Die folgenden Bedingungen für Ihre Implementierung der gelten möglicherweise [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span><span class="sxs-lookup"><span data-stu-id="15298-138">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span></span>

- <span data-ttu-id="15298-139">Die Implementierung von der [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) Methode den Pfad als rechtliche den vollqualifizierten Pfad für den Namespace des Anbieters sollte nicht überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="15298-139">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method should not validate the path as a legal fully-qualified path in the provider namespace.</span></span> <span data-ttu-id="15298-140">Denken Sie daran, dass jeder Parameter kann nur einen Teil eines Pfads darstellen, und die kombinierten Teile kann möglicherweise einen vollständig qualifizierten Pfad nicht generiert.</span><span class="sxs-lookup"><span data-stu-id="15298-140">Be aware that each parameter can only represent a part of a path, and the combined parts might not generate a fully-qualified path.</span></span> <span data-ttu-id="15298-141">Z. B. die [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) -Methode für der Filesystem-Anbieter wird möglicherweise "windows\system32" in der `parent` Parameter und "abc.dll" in der `child` Parameter.</span><span class="sxs-lookup"><span data-stu-id="15298-141">For example, the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method for the filesystem provider might receive "windows\system32" in the `parent` parameter and "abc.dll" in the `child` parameter.</span></span> <span data-ttu-id="15298-142">Die Methode verbindet diese Werte mit der "\\" als Trennzeichen und gibt "windows\system32\abc.dll", die nicht vollqualifiziert Dateisystempfad ist.</span><span class="sxs-lookup"><span data-stu-id="15298-142">The method joins these values with the "\\" separator and returns "windows\system32\abc.dll", which is not a fully-qualified file system path.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="15298-143">Die pfadanteile, die im Aufruf angegeben [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) enthalten möglicherweise Zeichen, die in den Namespace des Anbieters nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="15298-143">The path parts provided in the call to [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) might contain characters not allowed in the provider namespace.</span></span> <span data-ttu-id="15298-144">Diese Zeichen in den meisten Fällen für die platzhaltererweiterung verwendet werden, und die Implementierung dieser Methode sollte nicht entfernt.</span><span class="sxs-lookup"><span data-stu-id="15298-144">These characters are most likely used for wildcard expansion and the implementation of this method should not remove them.</span></span>

## <a name="retrieving-the-parent-path"></a><span data-ttu-id="15298-145">Den übergeordnete Pfad abrufen</span><span class="sxs-lookup"><span data-stu-id="15298-145">Retrieving the Parent Path</span></span>

<span data-ttu-id="15298-146">Windows PowerShell-Navigationsanbieter implementieren die [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) Methode zum Abrufen des übergeordneten Teils des angezeigten vollständig oder teilweise Anbieter-spezifischen Pfad.</span><span class="sxs-lookup"><span data-stu-id="15298-146">Windows PowerShell navigation providers implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method to retrieve the parent part of the indicated full or partial provider-specific path.</span></span> <span data-ttu-id="15298-147">Die Methode entfernt die untergeordneten Teil des Pfads und gibt das übergeordnete Pfad aber unverändert zurück.</span><span class="sxs-lookup"><span data-stu-id="15298-147">The method removes the child part of the path and returns the parent path part.</span></span> <span data-ttu-id="15298-148">Die `root` Parameter gibt an, die den vollqualifizierten Pfad zum Stamm eines Laufwerks.</span><span class="sxs-lookup"><span data-stu-id="15298-148">The `root` parameter specifies the fully-qualified path to the root of a drive.</span></span> <span data-ttu-id="15298-149">Dieser Parameter kann null oder leer, wenn ein bereitgestelltes Laufwerk nicht für den Abrufvorgang wird sein.</span><span class="sxs-lookup"><span data-stu-id="15298-149">This parameter can be null or empty if a mounted drive is not in use for the retrieval operation.</span></span> <span data-ttu-id="15298-150">Wenn ein Stamm angegeben wird, muss die Methode einen Pfad zu einem Container in der gleichen Struktur als Stamm zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="15298-150">If a root is specified, the method must return a path to a container in the same tree as the root.</span></span>

<span data-ttu-id="15298-151">Die Beispiel-Navigationsanbieter überschreibt diese Methode nicht, aber es verwendet die Standardimplementierung.</span><span class="sxs-lookup"><span data-stu-id="15298-151">The sample navigation provider does not override this method, but uses the default implementation.</span></span> <span data-ttu-id="15298-152">Akzeptiert Pfade, die sowohl "/" und "\\" als Pfadtrennzeichen.</span><span class="sxs-lookup"><span data-stu-id="15298-152">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="15298-153">Es zuerst normalisiert den Pfad zur nur "\\" Trennzeichen, teilt dann des letzten deaktivieren den übergeordnete Pfad "\\" und gibt den übergeordneten Pfad zurück.</span><span class="sxs-lookup"><span data-stu-id="15298-153">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the parent path.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetparentpath](Msh_samplestestcmdlets#testprovidergetparentpath)]  -->

#### <a name="to-remember-about-implementing-getparentpath"></a><span data-ttu-id="15298-154">Zum Implementieren von GetParentPath merken</span><span class="sxs-lookup"><span data-stu-id="15298-154">To Remember About Implementing GetParentPath</span></span>

<span data-ttu-id="15298-155">Die Implementierung von der [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) Methode sollte den Pfad auf dem die Trennzeichen im Pfad für den Namespace des Anbieters lexikalisch aufgeteilt wird.</span><span class="sxs-lookup"><span data-stu-id="15298-155">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method should split the path lexically on the path separator for the provider namespace.</span></span> <span data-ttu-id="15298-156">Beispielsweise verwendet der Filesystem-Anbieter diese Methode nach der letzten gesucht werden soll "\\" und gibt alle Elemente auf der linken Seite des Trennzeichens.</span><span class="sxs-lookup"><span data-stu-id="15298-156">For example, the filesystem provider uses this method to look for the last "\\" and returns everything to the left of the separator.</span></span>

## <a name="retrieve-the-child-path-name"></a><span data-ttu-id="15298-157">Der Name der untergeordneten Pfad abrufen</span><span class="sxs-lookup"><span data-stu-id="15298-157">Retrieve the Child Path Name</span></span>

<span data-ttu-id="15298-158">Die Navigation-Anbieter implementiert die [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) Methode zum Abrufen des Namens (Leaf-Element) des untergeordneten Elements des Elements befindet sich in den angegebenen vollständigen oder anbieterspezifische Teilpfad.</span><span class="sxs-lookup"><span data-stu-id="15298-158">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method to retrieve the name (leaf element) of the child of the item located at the indicated full or partial provider-specific path.</span></span>

<span data-ttu-id="15298-159">Navigation Beispielanbieter überschreibt diese Methode nicht.</span><span class="sxs-lookup"><span data-stu-id="15298-159">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="15298-160">Die Standardimplementierung ist unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="15298-160">The default implementation is shown below.</span></span> <span data-ttu-id="15298-161">Akzeptiert Pfade, die sowohl "/" und "\\" als Pfadtrennzeichen.</span><span class="sxs-lookup"><span data-stu-id="15298-161">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="15298-162">Es zuerst normalisiert den Pfad zur nur "\\" Trennzeichen, klicken Sie dann den übergeordneten Pfad Deaktivieren des letzten teilt "\\" und der Name des untergeordneten Pfad aber unverändert zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="15298-162">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the name of the child path part.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildname](Msh_samplestestcmdlets#testprovidergetchildname)]  -->

#### <a name="things-to-remember-about-implementing-getchildname"></a><span data-ttu-id="15298-163">Punkte zu beachten, die zum Implementieren von GetChildName</span><span class="sxs-lookup"><span data-stu-id="15298-163">Things to Remember About Implementing GetChildName</span></span>

<span data-ttu-id="15298-164">Die Implementierung von der [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) Methode sollte den Pfad für das Pfadtrennzeichen lexikalisch aufgeteilt wird.</span><span class="sxs-lookup"><span data-stu-id="15298-164">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method should split the path lexically on the path separator.</span></span> <span data-ttu-id="15298-165">Wenn der angegebene Pfad keine Trennzeichen im Pfad enthält, sollte die Methode der Pfad, der unverändert zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="15298-165">If the supplied path contains no path separators, the method should return the path unmodified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="15298-166">Der Pfad, in dem Aufruf dieser Methode bereitgestellte kann Zeichen enthalten, die in den Namespace des Anbieters nicht zulässig sind.</span><span class="sxs-lookup"><span data-stu-id="15298-166">The path provided in the call to this method might contain characters that are illegal in the provider namespace.</span></span> <span data-ttu-id="15298-167">Diese Zeichen befinden sich wahrscheinlich für die platzhaltererweiterung oder Suche mit regulären Ausdrücken verwendet, und die Implementierung dieser Methode sollte nicht entfernt.</span><span class="sxs-lookup"><span data-stu-id="15298-167">These characters are most likely used for wildcard expansion or regular expression matching, and the implementation of this method should not remove them.</span></span>

## <a name="determining-if-an-item-is-a-container"></a><span data-ttu-id="15298-168">Bestimmen, ob ein Element ein Container ist.</span><span class="sxs-lookup"><span data-stu-id="15298-168">Determining if an Item is a Container</span></span>

<span data-ttu-id="15298-169">Der Navigationsbereich-Anbieter implementieren kann die [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) Methode, um zu bestimmen, ob es sich bei der angegebene Pfad einen Container angibt.</span><span class="sxs-lookup"><span data-stu-id="15298-169">The navigation provider can implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) method to determine if the specified path indicates a container.</span></span> <span data-ttu-id="15298-170">True, wenn der Pfad einen Container, und klicken Sie auf "false", andernfalls darstellt gibt es zurück.</span><span class="sxs-lookup"><span data-stu-id="15298-170">It returns true if the path represents a container, and false otherwise.</span></span> <span data-ttu-id="15298-171">Der Benutzer benötigt diese Methode verwenden, können die `Test-Path` Cmdlet für den angegebenen Pfad.</span><span class="sxs-lookup"><span data-stu-id="15298-171">The user needs this method to be able to use the `Test-Path` cmdlet for the supplied path.</span></span>

<span data-ttu-id="15298-172">Der folgende code zeigt die [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) -Implementierung in unserem Beispiel Navigation-Anbieter.</span><span class="sxs-lookup"><span data-stu-id="15298-172">The following code shows the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementation in our sample navigation provider.</span></span> <span data-ttu-id="15298-173">Die Methode überprüft, ob der angegebene Pfad richtig ist und wenn die Tabelle vorhanden ist, und "true" gibt, wenn der Pfad ein Containers gibt.</span><span class="sxs-lookup"><span data-stu-id="15298-173">The method verifies that  the specified path is correct and if the table exists, and returns true if the path indicates a container.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L847-L872 "AccessDBProviderSample05.cs")]

#### <a name="things-to-remember-about-implementing-isitemcontainer"></a><span data-ttu-id="15298-174">Punkte zu beachten, die zum Implementieren von IsItemContainer</span><span class="sxs-lookup"><span data-stu-id="15298-174">Things to Remember About Implementing IsItemContainer</span></span>

<span data-ttu-id="15298-175">Ihre Navigationsanbieter .NET-Klasse kann die Funktionen des Anbieters der ExpandWildcards, Filter, einschließen oder ausschließen, deklarieren, aus der [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) Enumeration.</span><span class="sxs-lookup"><span data-stu-id="15298-175">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="15298-176">In diesem Fall ist die Implementierung der [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) muss sicherstellen, dass der übergebene Pfad Anforderungen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="15298-176">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) needs to ensure that the path passed meets requirements.</span></span> <span data-ttu-id="15298-177">Zu diesem Zweck die Methode sollte Zugriff auf die entsprechende Eigenschaft, z. B. die [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="15298-177">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) property.</span></span>

## <a name="moving-an-item"></a><span data-ttu-id="15298-178">Verschieben eines Elements</span><span class="sxs-lookup"><span data-stu-id="15298-178">Moving an Item</span></span>

<span data-ttu-id="15298-179">Unterstützung des der `Move-Item` -Cmdlet, um den Navigationsbereich-Anbieter implementiert die [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) Methode.</span><span class="sxs-lookup"><span data-stu-id="15298-179">In support of the `Move-Item` cmdlet, your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="15298-180">Diese Methode verschiebt das Element, die gemäß der `path` Parameter, um den Container unter dem im angegebenen Pfad die `destination` Parameter.</span><span class="sxs-lookup"><span data-stu-id="15298-180">This method moves the item specified by the `path` parameter to the container at the path supplied in the `destination` parameter.</span></span>

<span data-ttu-id="15298-181">Navigation Beispielanbieter überschreibt nicht die [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) Methode.</span><span class="sxs-lookup"><span data-stu-id="15298-181">The sample navigation provider does not override the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="15298-182">Im folgenden wird die standardmäßige Implementierung.</span><span class="sxs-lookup"><span data-stu-id="15298-182">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitem](Msh_samplestestcmdlets#testprovidermoveitem)]  -->

#### <a name="things-to-remember-about-implementing-moveitem"></a><span data-ttu-id="15298-183">Punkte zu beachten, die zum Implementieren von MoveItem</span><span class="sxs-lookup"><span data-stu-id="15298-183">Things to Remember About Implementing MoveItem</span></span>

<span data-ttu-id="15298-184">Ihre Navigationsanbieter .NET-Klasse kann die Funktionen des Anbieters der ExpandWildcards, Filter, einschließen oder ausschließen, deklarieren, aus der [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) Enumeration.</span><span class="sxs-lookup"><span data-stu-id="15298-184">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="15298-185">In diesem Fall ist die Implementierung der [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) müssen sicherstellen, dass der übergebene Pfad Anforderungen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="15298-185">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) must ensure that the path passed meets requirements.</span></span> <span data-ttu-id="15298-186">Zu diesem Zweck die Methode sollte Zugriff auf die entsprechende Eigenschaft, z. B. die **CmdletProvider.Exclude** Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="15298-186">To do this, the method should access the appropriate property, for example, the **CmdletProvider.Exclude** property.</span></span>

<span data-ttu-id="15298-187">Standardmäßig überschreibt diese Methode sollte nicht Objekte verschieben über vorhandene Objekte, sofern die [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaftensatz auf `true`.</span><span class="sxs-lookup"><span data-stu-id="15298-187">By default, overrides of this method should not move objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="15298-188">Z. B. der Filesystem-Anbieter werden nicht kopiert c:\temp\abc.txt über eine vorhandene c:\bar.txt-Datei, wenn die [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) -Eigenschaftensatz auf `true`.</span><span class="sxs-lookup"><span data-stu-id="15298-188">For example, the filesystem provider will not copy c:\temp\abc.txt over an existing c:\bar.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="15298-189">Wenn der Pfad, in angegeben der `destination` Parameter vorhanden ist und einen Container, der [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) Eigenschaft ist nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="15298-189">If the path specified in the `destination` parameter exists and is a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="15298-190">In diesem Fall [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) verschoben werden soll das Element, angegeben durch die `path` Parameter, um den Container angegeben wird, durch die `destination` Parameter als ein untergeordnetes Element.</span><span class="sxs-lookup"><span data-stu-id="15298-190">In this case, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) should move the item indicated by the `path` parameter to the container indicated by the `destination` parameter as a child.</span></span>

<span data-ttu-id="15298-191">Die Implementierung von der [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) Methodenaufruf sollten [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) , und überprüfen Sie den Rückgabewert, bevor Änderungen an den Datenspeicher.</span><span class="sxs-lookup"><span data-stu-id="15298-191">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="15298-192">Diese Methode wird verwendet, um die Ausführung eines Vorgangs zu bestätigen, wenn eine Änderung z. B. um den Systemstatus erfolgt Dateien werden gelöscht.</span><span class="sxs-lookup"><span data-stu-id="15298-192">This method is used to confirm execution of an operation when a change is made to system state, for example, deleting files.</span></span> <span data-ttu-id="15298-193">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sendet den Namen der Ressource, die für den Benutzer geändert werden, mit der Windows PowerShell-Laufzeit berücksichtigt alle über die befehlszeileneinstellungen oder der Preference-Variablen in bestimmen, was dem Benutzer angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="15298-193">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed to the user.</span></span>

<span data-ttu-id="15298-194">Nach dem Aufruf von [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) gibt `true`, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) Methodenaufruf sollte die [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) Methode.</span><span class="sxs-lookup"><span data-stu-id="15298-194">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="15298-195">Diese Methode sendet eine Nachricht an den Benutzer können Sie Feedback zu sagen, wenn der Vorgang fortgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="15298-195">This method sends a message to the user to allow feedback to say if the operation should be continued.</span></span> <span data-ttu-id="15298-196">Ihr Anbieter sollte Aufrufen [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) als eine zusätzliche Überprüfung auf potenziell gefährliche systemmodifizierungen.</span><span class="sxs-lookup"><span data-stu-id="15298-196">Your provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-move-item-cmdlet"></a><span data-ttu-id="15298-197">Das Cmdlet "Move-Item" Anfügen dynamische Parameter</span><span class="sxs-lookup"><span data-stu-id="15298-197">Attaching Dynamic Parameters to the Move-Item Cmdlet</span></span>

<span data-ttu-id="15298-198">In einigen Fällen die `Move-Item` Cmdlet erfordert zusätzliche Parameter, die zur Laufzeit dynamisch bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="15298-198">Sometimes the `Move-Item` cmdlet requires additional parameters that are provided dynamically at runtime.</span></span> <span data-ttu-id="15298-199">Um diese dynamischen Parameter zu gewährleisten, muss der Navigationsanbieter implementieren die [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) Methode, um die erforderlichen Parameterwerte abzurufen. ein Objekt mit Eigenschaften und Felder mit der Analyse Attribute aus dem Element am angegebenen Pfad, und Rückgabe ähnlich einer Cmdlet-Klasse oder ein [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) Objekt.</span><span class="sxs-lookup"><span data-stu-id="15298-199">To provide these dynamic parameters, the navigation provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) method to get the required parameter values from the item at the indicated path, and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="15298-200">Dieser Navigationsanbieter implementiert diese Methode nicht.</span><span class="sxs-lookup"><span data-stu-id="15298-200">This navigation provider does not implement this method.</span></span> <span data-ttu-id="15298-201">Der folgende Code ist jedoch die standardmäßige Implementierung des [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="15298-201">However, the following code is the default implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters](Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters)]  -->

## <a name="normalizing-a-relative-path"></a><span data-ttu-id="15298-202">Das Normalisieren eines relativen Pfads</span><span class="sxs-lookup"><span data-stu-id="15298-202">Normalizing a Relative Path</span></span>

<span data-ttu-id="15298-203">Die Navigation-Anbieter implementiert die [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) Methode, um den vollqualifizierten Pfad zu normalisieren angegeben wird, der `path` Parameter als relativ zum angegebenen Pfad die `basePath` Parameter.</span><span class="sxs-lookup"><span data-stu-id="15298-203">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) method to normalize the fully-qualified path indicated in the `path` parameter as being relative to the path specified by the `basePath` parameter.</span></span> <span data-ttu-id="15298-204">Die Methode gibt eine Zeichenfolgendarstellung der normalisierte Pfad zurück.</span><span class="sxs-lookup"><span data-stu-id="15298-204">The method returns a string representation of the normalized path.</span></span> <span data-ttu-id="15298-205">Er schreibt einen Fehler, wenn die `path` Parameter gibt den Pfad nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="15298-205">It writes an error if the `path` parameter specifies a nonexistent path.</span></span>

<span data-ttu-id="15298-206">Navigation Beispielanbieter überschreibt diese Methode nicht.</span><span class="sxs-lookup"><span data-stu-id="15298-206">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="15298-207">Im folgenden wird die standardmäßige Implementierung.</span><span class="sxs-lookup"><span data-stu-id="15298-207">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernormalizepath](Msh_samplestestcmdlets#testprovidernormalizepath)]  -->

#### <a name="things-to-remember-about-implementing-normalizerelativepath"></a><span data-ttu-id="15298-208">Punkte zu beachten, die zum Implementieren von NormalizeRelativePath</span><span class="sxs-lookup"><span data-stu-id="15298-208">Things to Remember About Implementing NormalizeRelativePath</span></span>

<span data-ttu-id="15298-209">Die Implementierung von [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) analysieren soll, die `path` -Parameter, aber es muss keine rein syntaktischen Analyse verwenden.</span><span class="sxs-lookup"><span data-stu-id="15298-209">Your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) should parse the `path` parameter, but it does not have to use purely syntactical parsing.</span></span> <span data-ttu-id="15298-210">Sie werden aufgefordert, entwerfen, dass diese Methode verwenden Sie den Pfad für die Suche der Pfadangaben in den Datenspeicher aus, und erstellen Sie einen Pfad, der die Groß-/Kleinschreibung übereinstimmt und standardisierten Syntax für elementpfade.</span><span class="sxs-lookup"><span data-stu-id="15298-210">You are encouraged to design this method to use the path to look up the path information in the data store and create a path that matches the casing and standardized path syntax.</span></span>

## <a name="code-sample"></a><span data-ttu-id="15298-211">Codebeispiel</span><span class="sxs-lookup"><span data-stu-id="15298-211">Code Sample</span></span>

<span data-ttu-id="15298-212">Vollständigen Beispielcode finden Sie unter [AccessDbProviderSample05 Codebeispiel](./accessdbprovidersample05-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="15298-212">For complete sample code, see [AccessDbProviderSample05 Code Sample](./accessdbprovidersample05-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="15298-213">Definieren von Objekttypen und Formatierung</span><span class="sxs-lookup"><span data-stu-id="15298-213">Defining Object Types and Formatting</span></span>

<span data-ttu-id="15298-214">Es ist möglich, für einen Anbieter zum Hinzufügen von Mitgliedern zu vorhandenen Objekten oder neue Objekte zu definieren.</span><span class="sxs-lookup"><span data-stu-id="15298-214">It is possible for a provider to add members to existing objects or define new objects.</span></span> <span data-ttu-id="15298-215">Weitere Informationen finden Sie unter[Objekttypen erweitern und Formatierung](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="15298-215">For more information, see[Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="15298-216">Erstellen den Windows PowerShell-Anbieter</span><span class="sxs-lookup"><span data-stu-id="15298-216">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="15298-217">Weitere Informationen finden Sie unter [wie zum Registrieren von Cmdlets, Anbietern und Hostanwendungen](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="15298-217">For more information, see [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="15298-218">Testen des Windows PowerShell-Anbieters</span><span class="sxs-lookup"><span data-stu-id="15298-218">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="15298-219">Wenn Ihre Windows PowerShell-Anbieter mit Windows PowerShell registriert wurde, können Sie es testen, durch Ausführen der unterstützten Cmdlets in der Befehlszeile, einschließlich Cmdlets, die durch Ableitung zur Verfügung gestellt.</span><span class="sxs-lookup"><span data-stu-id="15298-219">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line, including cmdlets made available by derivation.</span></span> <span data-ttu-id="15298-220">In diesem Beispiel wird die Navigation Beispielanbieter testen.</span><span class="sxs-lookup"><span data-stu-id="15298-220">This example will test the sample navigation provider.</span></span>

1. <span data-ttu-id="15298-221">Führen Sie Ihre neue Shell, und Verwenden der `Set-Location` Cmdlet, um den Pfad zu die Access-Datenbank anzugeben.</span><span class="sxs-lookup"><span data-stu-id="15298-221">Run your new shell and use the `Set-Location` cmdlet to set the path to indicate the Access database.</span></span>

   ```powershell
   Set-Location mydb:
   ```

2. <span data-ttu-id="15298-222">Führen Sie nun die `Get-Childitem` -Cmdlet zum Abrufen einer Liste von der Datenbank-Elemente, die den Tabellen der verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="15298-222">Now run the `Get-Childitem` cmdlet to retrieve a list of the database items, which are the available database tables.</span></span> <span data-ttu-id="15298-223">Für jede Tabelle ruft dieses Cmdlet auch die Anzahl der Zeilen der Tabelle ab.</span><span class="sxs-lookup"><span data-stu-id="15298-223">For each table, this cmdlet also retrieves the number of table rows.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rowcount,name -AutoSize
   ```

   ```output
   RowCount   Name
   --------   ----
        180   MSysAccessObjects
          0   MSysACEs
          1   MSysCmdbars
          0   MSysIMEXColumns
          0   MSysIMEXSpecs
          0   MSysObjects
          0   MSysQueries
          7   MSysRelationships
          8   Categories
         91   Customers
          9   Employees
       2155   Order Details
        830   Orders
         77   Products
          3   Shippers
         29   Suppliers
   ```

3. <span data-ttu-id="15298-224">Verwenden der `Set-Location` Cmdlet erneut aus, um den Speicherort der Mitarbeiter Datentabelle festgelegt.</span><span class="sxs-lookup"><span data-stu-id="15298-224">Use the `Set-Location` cmdlet again to set the location of the Employees data table.</span></span>

   ```powershell
   Set-Location Employees
   ```

4. <span data-ttu-id="15298-225">Wir stellen jetzt mit der `Get-Location` Cmdlet, um den Pfad zu der Employees-Tabelle abrufen.</span><span class="sxs-lookup"><span data-stu-id="15298-225">Let's now use the `Get-Location` cmdlet to retrieve the path to the Employees table.</span></span>

   ```powershell
   Get-Location
   ```

   ```output
   Path
   ----
   mydb:\Employees
   ```

5. <span data-ttu-id="15298-226">Verwenden Sie jetzt die `Get-Childitem` Cmdlet über die Pipeline an das `Format-Table` Cmdlet.</span><span class="sxs-lookup"><span data-stu-id="15298-226">Now use the `Get-Childitem` cmdlet piped to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="15298-227">Dieser Satz von Cmdlets Ruft die Elemente für die Mitarbeiter-Datentabelle, die Zeilen der Tabelle ab.</span><span class="sxs-lookup"><span data-stu-id="15298-227">This set of cmdlets retrieves the items for the Employees data table, which are the table rows.</span></span> <span data-ttu-id="15298-228">Sie werden formatiert entsprechend der Angabe durch die `Format-Table` Cmdlet.</span><span class="sxs-lookup"><span data-stu-id="15298-228">They are formatted as specified by the `Format-Table` cmdlet.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rownumber,psiscontainer,data -AutoSize
   ```

   ```output
   RowNumber   PSIsContainer   Data
   ---------   --------------   ----
   0           False            System.Data.DataRow
   1           False            System.Data.DataRow
   2           False            System.Data.DataRow
   3           False            System.Data.DataRow
   4           False            System.Data.DataRow
   5           False            System.Data.DataRow
   6           False            System.Data.DataRow
   7           False            System.Data.DataRow
   8           False            System.Data.DataRow
   ```

6. <span data-ttu-id="15298-229">Sie können jetzt ausführen der `Get-Item` Cmdlet, um die Elemente für die Zeile "0" der Tabelle Employees Daten abgerufen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="15298-229">You can now run the `Get-Item` cmdlet to retrieve the items for row 0 of the Employees data table.</span></span>

   ```powershell
   Get-Item 0
   ```

   ```output
   PSPath        : AccessDB::C:\PS\Northwind.mdb\Employees\0
   PSParentPath  : AccessDB::C:\PS\Northwind.mdb\Employees
   PSChildName   : 0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data           : System.Data.DataRow
   RowNumber      : 0
   ```

7. <span data-ttu-id="15298-230">Verwenden der `Get-Item` Cmdlet erneut aus, um die Mitarbeiterdaten für die Elemente in Zeile 0 abzurufen.</span><span class="sxs-lookup"><span data-stu-id="15298-230">Use the `Get-Item` cmdlet again to retrieve the employee data for the items in row 0.</span></span>

   ```powershell
   (Get-Item 0).data
   ```

   ```output
   EmployeeID      : 1
   LastName        : Davis
   FirstName       : Sara
   Title           : Sales Representative
   TitleOfCourtesy : Ms.
   BirthDate       : 12/8/1968 12:00:00 AM
   HireDate        : 5/1/1992 12:00:00 AM
   Address         : 4567 Main Street
                     Apt. 2A
   City            : Buffalo
   Region          : NY
   PostalCode      : 98052
   Country         : USA
   HomePhone       : (206) 555-9857
   Extension       : 5467
   Photo           : EmpID1.bmp
   Notes           : Education includes a BA in psychology from
                     Colorado State University. She also completed "The
                     Art of the Cold Call."  Nancy is a member of
                     Toastmasters International.
   ReportsTo       : 2
   ```

## <a name="see-also"></a><span data-ttu-id="15298-231">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="15298-231">See Also</span></span>

[<span data-ttu-id="15298-232">Erstellen von Windows PowerShell-Anbieter</span><span class="sxs-lookup"><span data-stu-id="15298-232">Creating Windows PowerShell providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="15298-233">Entwurf der Windows-PowerShell-Anbieter</span><span class="sxs-lookup"><span data-stu-id="15298-233">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="15298-234">Erweitern die Objekttypen und Formatierung</span><span class="sxs-lookup"><span data-stu-id="15298-234">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="15298-235">Implementieren eines Containers Windows PowerShell-Anbieters</span><span class="sxs-lookup"><span data-stu-id="15298-235">Implement a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="15298-236">So registrieren die Cmdlets, Anbieter, und Hosten von Anwendungen</span><span class="sxs-lookup"><span data-stu-id="15298-236">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="15298-237">Windows PowerShell Handbuch für Programmierer</span><span class="sxs-lookup"><span data-stu-id="15298-237">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="15298-238">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="15298-238">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)