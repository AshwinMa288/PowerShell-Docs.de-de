---
ms.date: 06/12/2017
keywords: jea,powershell,security
title: JEA-Sicherheitsüberlegungen
ms.openlocfilehash: 9526e141517601ae3b6d6932cd3536fdf49aa9a6
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "62084775"
---
# <a name="jea-security-considerations"></a><span data-ttu-id="9bb17-103">JEA-Sicherheitsüberlegungen</span><span class="sxs-lookup"><span data-stu-id="9bb17-103">JEA Security Considerations</span></span>

> <span data-ttu-id="9bb17-104">Gilt für: Windows PowerShell 5.0</span><span class="sxs-lookup"><span data-stu-id="9bb17-104">Applies to: Windows PowerShell 5.0</span></span>

<span data-ttu-id="9bb17-105">JEA unterstützt Sie bei der Verbesserung Ihres Sicherheitsniveaus und reduziert die Anzahl der permanenten Administratoren auf Ihren Computern.</span><span class="sxs-lookup"><span data-stu-id="9bb17-105">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span>
<span data-ttu-id="9bb17-106">Dies geschieht durch Erstellen eines neuen Einstiegspunkts für Benutzer zum Verwalten des Systems (eine PowerShell-Sitzungskonfiguration), der standardmäßig gesperrt ist, um Missbrauch zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="9bb17-106">It does so by creating a new entry point for users to manage the system (a PowerShell session configuration) which is tightly locked down by default to prevent misuse.</span></span>
<span data-ttu-id="9bb17-107">Benutzer, die einen gewissen, aber nicht unbegrenzten Zugriff auf den Computer benötigen, um administrative Aufgaben zu erledigen, können Zugriff auf den JEA-Endpunkt erhalten.</span><span class="sxs-lookup"><span data-stu-id="9bb17-107">Users who need some, but not unlimited, access to the machine to perform administrative tasks can be granted access to the JEA endpoint.</span></span>
<span data-ttu-id="9bb17-108">Da JEA das Ausführen von Admin-Befehlen ohne direkten Administratorzugriff ermöglicht, können Sie diese Benutzer aus Sicherheitsgruppen mit weitreichenden Berechtigungen entfernen (und sie zu Standardbenutzern machen).</span><span class="sxs-lookup"><span data-stu-id="9bb17-108">Because JEA allows them to run admin commands without directly having admin access, you can then remove those users from highly privileged security groups (make them standard users).</span></span>

<span data-ttu-id="9bb17-109">Dieses Thema enthält eine detaillierte Beschreibung des JEA-Sicherheitsmodells und bewährter Methoden.</span><span class="sxs-lookup"><span data-stu-id="9bb17-109">This topic describes the JEA security model and best practices in more detail.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="9bb17-110">Ausführendes Konto</span><span class="sxs-lookup"><span data-stu-id="9bb17-110">Run As account</span></span>

<span data-ttu-id="9bb17-111">Jeder JEA-Endpunkt verfügt über ein festgelegtes ausführendes Konto, in dem die Aktionen des Benutzers erfolgen, der eine Verbindung herstellt.</span><span class="sxs-lookup"><span data-stu-id="9bb17-111">Each JEA endpoint has a designated "run as" account, which is the account under which the connecting user's actions are performed.</span></span>
<span data-ttu-id="9bb17-112">Dieses Konto lässt sich in der [Sitzungskonfigurationsdatei](session-configurations.md) konfigurieren und hat einen erheblichen Einfluss auf die Sicherheit Ihres Endpunkts.</span><span class="sxs-lookup"><span data-stu-id="9bb17-112">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="9bb17-113">Für das Konfigurieren eines ausführenden Kontos werden **virtuelle Konten** empfohlen.</span><span class="sxs-lookup"><span data-stu-id="9bb17-113">**Virtual accounts** are the recommended way of configuring the run as account.</span></span>
<span data-ttu-id="9bb17-114">Virtuelle Konten sind einmalige, temporäre lokale Konten, die während der Dauer der JEA-Sitzung für den Benutzer erstellt werden, der die Verbindung herstellt.</span><span class="sxs-lookup"><span data-stu-id="9bb17-114">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span>
<span data-ttu-id="9bb17-115">Unmittelbar nach Ende der Sitzung wird das virtuelle Konto gelöscht und kann nicht mehr verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9bb17-115">As soon as their session is terminated, the virtual account will be destroyed and cannot be used anymore.</span></span>
<span data-ttu-id="9bb17-116">Der Benutzer, der die Verbindung herstellt, kennt die Anmeldeinformation des virtuellen Kontos nicht und kann es nicht dazu verwenden, um anderweitig auf das System zuzugreifen, z.B. über Remotedesktop oder einen uneingeschränkten PowerShell-Endpunkt.</span><span class="sxs-lookup"><span data-stu-id="9bb17-116">The connecting user does not know the credentials for the virtual account and cannot use the virtual account to access the system via other means, such as Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="9bb17-117">Virtuelle Konten gehören standardmäßig zur Gruppe der lokalen Administratoren auf dem Computer.</span><span class="sxs-lookup"><span data-stu-id="9bb17-117">By default, virtual accounts belong to the local administrators group on the machine.</span></span>
<span data-ttu-id="9bb17-118">Dadurch erhalten sie Vollzugriff zum Verwalten aller Elemente auf dem System, aber keine Rechte zum Verwalten von Ressourcen im Netzwerk.</span><span class="sxs-lookup"><span data-stu-id="9bb17-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="9bb17-119">Für die Authentifizierung an anderen Computern wird statt des virtuellen Kontos das lokale Computerkonto als Benutzerkontext verwendet.</span><span class="sxs-lookup"><span data-stu-id="9bb17-119">When authenticating with other machines, the user context will be that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="9bb17-120">Domänencontroller sind ein Sonderfall, da es bei ihnen das Konzept der lokalen Administratorgruppe nicht gibt.</span><span class="sxs-lookup"><span data-stu-id="9bb17-120">Domain controllers are a special case since there is no concept of a local administrators group.</span></span>
<span data-ttu-id="9bb17-121">Stattdessen gehören virtuelle Konten zu Domänen-Admins und können die Verzeichnisdienste auf dem Domänencontroller verwalten.</span><span class="sxs-lookup"><span data-stu-id="9bb17-121">Instead, virtual accounts belong to Domain Admins instead and can manage the directory services on the domain controller.</span></span>
<span data-ttu-id="9bb17-122">Die Gültigkeit der Domänenidentität ist auf den Domänencontroller beschränkt, auf dem die JEA-Sitzung instanziiert wurde. Bei jedem Netzwerkzugriff wird es stattdessen so aussehen, als erfolge dieser vom Computerobjekt des Domänencontrollers.</span><span class="sxs-lookup"><span data-stu-id="9bb17-122">The domain identity is still restricted to use on the domain controller where the JEA session was instantiated, and any network access will appear to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="9bb17-123">In beiden Fällen können Sie auch explizit definieren, zu welchen Sicherheitsgruppen das virtuelle Konto gehören soll.</span><span class="sxs-lookup"><span data-stu-id="9bb17-123">In both cases, you can also explicitly define which security groups the virtual account should belong to.</span></span>
<span data-ttu-id="9bb17-124">Dies wird empfohlen, wenn Sie Ihre Aufgabe ohne lokale Administrator- bzw. Domänen-Adminberechtigungen ausführen können.</span><span class="sxs-lookup"><span data-stu-id="9bb17-124">This is a good practice when the task you are performing can be done without local/domain admin privileges.</span></span>
<span data-ttu-id="9bb17-125">Wenn Sie bereits eine Sicherheitsgruppe für Ihre Administratoren definiert haben, können Sie das virtuelle Konto einfach zum Mitglied dieser Gruppe machen, damit es über die notwendigen Berechtigungen verfügt.</span><span class="sxs-lookup"><span data-stu-id="9bb17-125">If you already have a security group defined for your admins, you can simply grant the virtual account membership to that group to give it the permissions it needs.</span></span>
<span data-ttu-id="9bb17-126">Die Gruppenmitgliedschaft virtueller Konten beschränkt sich auf lokale Sicherheitsgruppen auf Arbeitsstationen und Mitgliedsservern. Auf einem Domänencontroller können sie nur Mitglieder von Sicherheitsgruppen einer Domäne sein.</span><span class="sxs-lookup"><span data-stu-id="9bb17-126">Virtual account group membership is limited to local security groups on workstation and member servers, but on a domain controller they can only be members of domain security groups.</span></span>
<span data-ttu-id="9bb17-127">Nachdem Sie eine oder mehrere Sicherheitsgruppen für das virtuelle Konto angegeben haben, gehört es nicht mehr zu den Standardgruppen (lokale Administratoren oder Domänen-Admins).</span><span class="sxs-lookup"><span data-stu-id="9bb17-127">Once you specify one or more security groups for the virtual account to belong to, it will no longer belong to the default groups (local admin or domain admin).</span></span>

<span data-ttu-id="9bb17-128">In der folgenden Tabelle werden die möglichen Konfigurationsoptionen und die sich daraus ergebenden Berechtigungen für virtuelle Konten zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="9bb17-128">The table below summarizes the possible configuration options and resulting permissions for virtual accounts</span></span>

<span data-ttu-id="9bb17-129">Computertyp</span><span class="sxs-lookup"><span data-stu-id="9bb17-129">Computer type</span></span>                | <span data-ttu-id="9bb17-130">Konfiguration virtueller Kontogruppen</span><span class="sxs-lookup"><span data-stu-id="9bb17-130">Virtual account group configuration</span></span> | <span data-ttu-id="9bb17-131">Lokaler Benutzerkontext</span><span class="sxs-lookup"><span data-stu-id="9bb17-131">Local user context</span></span>                                      | <span data-ttu-id="9bb17-132">Netzwerkbenutzerkontext</span><span class="sxs-lookup"><span data-stu-id="9bb17-132">Network user context</span></span>
-----------------------------|-------------------------------------|---------------------------------------------------------|--------------------------------------------------
<span data-ttu-id="9bb17-133">Domänencontroller</span><span class="sxs-lookup"><span data-stu-id="9bb17-133">Domain controller</span></span>            | <span data-ttu-id="9bb17-134">Standardwert</span><span class="sxs-lookup"><span data-stu-id="9bb17-134">Default</span></span>                             | <span data-ttu-id="9bb17-135">Domänenbenutzer, Mitglied von „*DOMÄNE*\Domänen-Admins“</span><span class="sxs-lookup"><span data-stu-id="9bb17-135">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="9bb17-136">Computerkonto</span><span class="sxs-lookup"><span data-stu-id="9bb17-136">Computer account</span></span>
<span data-ttu-id="9bb17-137">Domänencontroller</span><span class="sxs-lookup"><span data-stu-id="9bb17-137">Domain controller</span></span>            | <span data-ttu-id="9bb17-138">Domänengruppen A und B</span><span class="sxs-lookup"><span data-stu-id="9bb17-138">Domain groups A and B</span></span>               | <span data-ttu-id="9bb17-139">Domänenbenutzer, Mitglied von „*DOMAIN*\A“, „*DOMAIN*\B“</span><span class="sxs-lookup"><span data-stu-id="9bb17-139">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="9bb17-140">Computerkonto</span><span class="sxs-lookup"><span data-stu-id="9bb17-140">Computer account</span></span>
<span data-ttu-id="9bb17-141">Mitgliedsserver oder Arbeitsstation</span><span class="sxs-lookup"><span data-stu-id="9bb17-141">Member server or workstation</span></span> | <span data-ttu-id="9bb17-142">Standardwert</span><span class="sxs-lookup"><span data-stu-id="9bb17-142">Default</span></span>                             | <span data-ttu-id="9bb17-143">Lokaler Benutzer, Mitglied von „*BUILTIN*\Administrators“</span><span class="sxs-lookup"><span data-stu-id="9bb17-143">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="9bb17-144">Computerkonto</span><span class="sxs-lookup"><span data-stu-id="9bb17-144">Computer account</span></span>
<span data-ttu-id="9bb17-145">Mitgliedsserver oder Arbeitsstation</span><span class="sxs-lookup"><span data-stu-id="9bb17-145">Member server or workstation</span></span> | <span data-ttu-id="9bb17-146">Lokale Gruppen C und D</span><span class="sxs-lookup"><span data-stu-id="9bb17-146">Local groups C and D</span></span>                | <span data-ttu-id="9bb17-147">Lokale Gruppen, Mitglied von „*COMPUTER*\C“ und „*COMPUTER*\D“</span><span class="sxs-lookup"><span data-stu-id="9bb17-147">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="9bb17-148">Computerkonto</span><span class="sxs-lookup"><span data-stu-id="9bb17-148">Computer account</span></span>

<span data-ttu-id="9bb17-149">Wenn Sie Sicherheitsüberwachungsereignisse und Anwendungsereignisprotokolle genauer betrachten, erkennen Sie, dass jede JEA-Benutzersitzung über ein eindeutiges virtuelles Konto verfügt.</span><span class="sxs-lookup"><span data-stu-id="9bb17-149">When you look at security audit events and application event logs, you will see that each JEA user session has a unique virtual account.</span></span>
<span data-ttu-id="9bb17-150">Dadurch können Sie die Benutzeraktionen in einem JEA-Endpunkt zum ursprünglichen Benutzer zurückverfolgen, der den Befehl ausgeführt hat.</span><span class="sxs-lookup"><span data-stu-id="9bb17-150">This helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span>
<span data-ttu-id="9bb17-151">Virtuelle Kontonamen haben folgendes Format: Virtuelle Benutzer\\WinRM\_VA\_*KONTONUMMER*\_*DOMÄNE*\_*sAMKontoName*. Wenn beispielsweise Benutzer „Alice“ in der Domäne „Contoso“ einen Dienst in einem JEA-Endpunkt neu startet, so lautet der Benutzername, der einem beliebigen Ereignis eines Dienststeuerungs-Managers zugeordnet ist, „WinRM\\WinRM\_VA\_1\_Contoso\_alice“.</span><span class="sxs-lookup"><span data-stu-id="9bb17-151">Virtual account names follow the format "WinRM Virtual Users\\WinRM\_VA\_*ACCOUNTNUMBER*\_*DOMAIN*\_*sAMAccountName*" For example, if user "Alice" in domain "Contoso" restarts a service in a JEA endpoint, the username associated with any service control manager events would be "WinRM Virtual Users\\WinRM\_VA\_1\_contoso\_alice".</span></span>


<span data-ttu-id="9bb17-152">**Gruppenverwaltete Dienstkonten (gMSAs)** erweisen sich als nützlich, wenn ein Mitgliedsserver in der JEA-Sitzung auf Netzwerkressourcen zugreifen muss.</span><span class="sxs-lookup"><span data-stu-id="9bb17-152">**Group managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span>
<span data-ttu-id="9bb17-153">Ein Anwendungsbeispiel dafür ist ein JEA-Endpunkt, der zur Zugriffssteuerung für eine REST-API genutzt wird, die auf einem anderen Computer gehostet wird.</span><span class="sxs-lookup"><span data-stu-id="9bb17-153">An example use case for this is a JEA endpoint that is used to control access to a REST API hosted on a different machine.</span></span>
<span data-ttu-id="9bb17-154">Für die gewünschten Aufrufe auf der REST-API lassen sich leicht Funktionen schreiben, die Authentifizierung mit der API setzt jedoch eine Netzwerkidentität voraus.</span><span class="sxs-lookup"><span data-stu-id="9bb17-154">It is easy to write functions to make the desired invocations on the REST API, but in order to authenticate with the API you need a network identity.</span></span>
<span data-ttu-id="9bb17-155">Die Verwendung eines gruppenverwalteten Dienstkontos ermöglicht den „zweiten Hop“, während Sie weiterhin die Kontrolle darüber behalten, welche Computer das Konto verwenden können.</span><span class="sxs-lookup"><span data-stu-id="9bb17-155">Using a group managed service account makes the "second hop" possible while still having control over which computers can use the account.</span></span>
<span data-ttu-id="9bb17-156">Die effektiven Berechtigungen des gMSA werden durch die Sicherheitsgruppen (lokal oder Domäne) definiert, zu denen das gMSA-Konto gehört.</span><span class="sxs-lookup"><span data-stu-id="9bb17-156">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="9bb17-157">Wenn ein JEA-Endpunkt für die Verwendung eines gMSA-Kontos konfiguriert ist, sieht es aus, als stammten die Aktionen aller JEA-Benutzer aus demselben gruppenverwalteten Dienstkonto.</span><span class="sxs-lookup"><span data-stu-id="9bb17-157">When a JEA endpoint is configured to use a gMSA account, the actions of all JEA users will appear to come from the same group managed service account.</span></span>
<span data-ttu-id="9bb17-158">Sie können die Aktionen eines bestimmten Benutzers nur dann zurückverfolgen, wenn Sie die ausgeführten Befehle identifizieren können, die in einer PowerShell-Sitzungsaufzeichnung erfasst sind.</span><span class="sxs-lookup"><span data-stu-id="9bb17-158">The only way you can trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="9bb17-159">**Pass-Through-Anmeldeinformationen** werden verwendet, wenn Sie kein ausführendes Konto angeben und möchten, dass PowerShell für die Ausführung von Befehlen auf dem Remoteserver die Anmeldeinformationen des Benutzers verwendet, der die Verbindung herstellt.</span><span class="sxs-lookup"><span data-stu-id="9bb17-159">**Pass-thru credentials** are used when you do not specify a run as account and want PowerShell to use the connecting user's credential to run commands on the remote server.</span></span>
<span data-ttu-id="9bb17-160">Diese Konfiguration wird für JEA *nicht* empfohlen. Sie setzt voraus, dass Sie dem Benutzer, der eine Verbindung herstellt, direkten Zugriff auf privilegierte Verwaltungsgruppen gewähren.</span><span class="sxs-lookup"><span data-stu-id="9bb17-160">This configuration is *not* recommended for JEA as it would require you to grant the connecting user direct access to privileged management groups.</span></span>
<span data-ttu-id="9bb17-161">Benutzer, die eine Verbindung herstellen und über Administratorberechtigungen verfügen, können JEA gänzlich umgehen und das System über andere, uneingeschränkte Möglichkeiten verwalten.</span><span class="sxs-lookup"><span data-stu-id="9bb17-161">If the connecting user already has admin privileges, they can avoid JEA altogether and manage the system via other, unconstrained means.</span></span>
<span data-ttu-id="9bb17-162">Weitere Informationen dazu, warum [JEA keinen Schutz von Administratoren bietet](#jea-does-not-protect-against-admins), finden Sie im Abschnitt weiter unten.</span><span class="sxs-lookup"><span data-stu-id="9bb17-162">See the section below on how [JEA does not protect against admins](#jea-does-not-protect-against-admins) for more information.</span></span>

<span data-ttu-id="9bb17-163">**Standard-RunAS-Konten** ermöglichen Ihnen, ein beliebiges Benutzerkonto anzugeben, unter dem die gesamte PowerShell-Sitzung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9bb17-163">**Standard run as accounts** allow you to specify any user account under which the entire PowerShell session will run.</span></span>
<span data-ttu-id="9bb17-164">Dies ist ein wichtiger Unterschied, denn eine Sitzungskonfiguration, die die Ausführung eines festen ausführenden Kontos vorsieht (mit dem `-RunAsCredential`-Parameter), ist nicht mit JEA kompatibel.</span><span class="sxs-lookup"><span data-stu-id="9bb17-164">This is an important distinction, because a session configuration set to use a fixed run as account (with the `-RunAsCredential` parameter) is not JEA-aware.</span></span>
<span data-ttu-id="9bb17-165">Das bedeutet, dass Rollendefinitionen nicht mehr wie erwartet funktionieren und dass jedem Benutzer, der für den Zugriff auf den Endpunkt berechtigt ist, die gleiche Rolle zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="9bb17-165">That means that role definitions no longer function as expected, and every user authorized to access the endpoint will be assigned the same role.</span></span>

<span data-ttu-id="9bb17-166">RunAsCredential sollte nicht auf einem JEA-Endpunkt verwendet werden, da Aktionen schwer auf bestimmte Benutzer zurückzuverfolgen sind und die Zuordnung von Benutzern zu Rollen nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="9bb17-166">You should not use a RunAsCredential on a JEA endpoint because of the difficulty in tracing actions back to specific users and the lack of support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="9bb17-167">WinRM-Endpunkt-ACL</span><span class="sxs-lookup"><span data-stu-id="9bb17-167">WinRM Endpoint ACL</span></span>

<span data-ttu-id="9bb17-168">Wie auch bei regulären PowerShell-Remoting-Endpunkten verfügt jeder JEA-Endpunkt über eine separate Zugriffssteuerungsliste (ACL) in der WinRM-Konfiguration. Sie legt fest, wer für eine Authentifizierung mit dem JEA-Endpunkt berechtigt ist.</span><span class="sxs-lookup"><span data-stu-id="9bb17-168">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) set in the WinRM configuration that controls who can authenticate with the JEA endpoint.</span></span>
<span data-ttu-id="9bb17-169">Bei einer nicht ordnungsgemäßen Konfiguration können vertrauenswürdige Benutzer möglicherweise nicht auf den JEA-Endpunkt zugreifen und nicht vertrauenswürdige Benutzer Zugriff erhalten.</span><span class="sxs-lookup"><span data-stu-id="9bb17-169">If improperly configured, trusted users may not be able to access the JEA endpoint and/or untrusted users may gain access.</span></span>
<span data-ttu-id="9bb17-170">Die WinRM-ACL wirkt sich allerdings nicht auf die Zuordnung von Benutzern zu JEA-Rollen aus.</span><span class="sxs-lookup"><span data-stu-id="9bb17-170">The WinRM ACL does not, however, affect the mapping of users to JEA roles.</span></span>
<span data-ttu-id="9bb17-171">Dies wird über das *RoleDefinitions*-Feld in der Sitzungskonfigurationsdatei gesteuert, die auf dem System registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="9bb17-171">That is controlled by the *RoleDefinitions* field in the session configuration file that was registered on the system.</span></span>

<span data-ttu-id="9bb17-172">Wenn Sie einen JEA-Endpunkt mithilfe einer Sitzungskonfigurationsdatei und einer oder mehrerer Rollenfunktionen registrieren, wird die WinRM-ACL standardmäßig so konfiguriert, dass alle Benutzer, denen eine oder mehrere Rollen zugeordnet sind, Zugriff auf den Endpunkt haben.</span><span class="sxs-lookup"><span data-stu-id="9bb17-172">By default, when you register a JEA endpoint using a session configuration file and one or more role capabilities, the WinRM ACL will be configured to allow all users mapping to one or more roles access to the endpoint.</span></span>
<span data-ttu-id="9bb17-173">So bietet beispielsweise eine mit den folgenden Befehlen konfigurierte JEA-Sitzung vollen Zugriff auf *CONTOSO\JEA\_Lev1* und *CONTOSO\JEA\_Lev2*.</span><span class="sxs-lookup"><span data-stu-id="9bb17-173">For example, a JEA session configured using the following commands will grant full access to *CONTOSO\JEA\_Lev1* and *CONTOSO\JEA\_Lev2*.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="9bb17-174">Sie können Benutzerberechtigungen über das [Get-PSSessionConfiguration](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration)-Cmdlet überwachen.</span><span class="sxs-lookup"><span data-stu-id="9bb17-174">You can audit user permissions with the [Get-PSSessionConfiguration](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
PS C:\> Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission

Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="9bb17-175">Sie können den Zugriff der einzelnen Benutzer ändern, indem Sie entweder `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` für eine interaktive Aufforderung oder `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` ausführen, um die Berechtigungen zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="9bb17-175">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span>
<span data-ttu-id="9bb17-176">Benutzer müssen mindestens Rechte zum *Aufrufen* haben, um auf den JEA-Endpunkt zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="9bb17-176">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="9bb17-177">Wenn zusätzliche Benutzer Zugriffsrechte für den JEA-Endpunkt erhalten, aber nicht unter eine der in der Sitzungskonfigurationsdatei definierten Rollen fallen, können sie zwar eine JEA-Sitzung starten, sie haben aber nur Zugriff auf die Standard-Cmdlets.</span><span class="sxs-lookup"><span data-stu-id="9bb17-177">If additional users are granted access to the JEA endpoint but do not fall into any of the roles defined in the session configuration file, they will be able to start a JEA session but only have access to the default cmdlets.</span></span>
<span data-ttu-id="9bb17-178">Sie können die Benutzerberechtigungen in einem JEA-Endpunkt überwachen, indem Sie `Get-PSSessionCapability` ausführen.</span><span class="sxs-lookup"><span data-stu-id="9bb17-178">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span>
<span data-ttu-id="9bb17-179">Weitere Informationen dazu, wie Sie überprüfen können, auf welche Befehle ein Benutzer auf einem JEA-Endpunkt zugreifen kann, finden Sie unter [Überwachung und Berichterstellung zu JEA](audit-and-report.md).</span><span class="sxs-lookup"><span data-stu-id="9bb17-179">Check out the [Auditing and Reporting on JEA](audit-and-report.md) article for more information about auditing which commands a user has access to in a JEA endpoint.</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="9bb17-180">Rollen mit geringsten Rechten</span><span class="sxs-lookup"><span data-stu-id="9bb17-180">Least privilege roles</span></span>

<span data-ttu-id="9bb17-181">Wenn Sie JEA-Rollen entwickeln, sollten Sie beachten, dass das im Hintergrund ausgeführte virtuelle oder gruppenverwaltete Dienstkonto häufig uneingeschränkten Zugriff auf die Verwaltung des lokalen Computers hat.</span><span class="sxs-lookup"><span data-stu-id="9bb17-181">When designing JEA roles, it is important to remember that the virtual or group managed service account running behind the scenes often has unrestricted access to manage the local machine.</span></span>
<span data-ttu-id="9bb17-182">Mithilfe von JEA-Rollenfunktionen können Sie die Verwendungsmöglichkeiten dieses Kontos einschränken. Begrenzen Sie dazu die Befehle und Anwendungen, die im Rahmen des privilegierten Kontexts ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="9bb17-182">JEA role capabilities help restrict what that account can be used for by limiting the commands and applications that can be run using that privileged context.</span></span>
<span data-ttu-id="9bb17-183">Aufgrund nicht ordnungsgemäß entwickelter Rollen lassen sich gefährliche Befehle ausführen: Benutzer können die JEA-Grenzen überschreiten oder sich Zugriff auf vertrauliche Informationen verschaffen.</span><span class="sxs-lookup"><span data-stu-id="9bb17-183">Improperly designed roles can allow dangerous commands to run that may allow a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="9bb17-184">Betrachten Sie beispielsweise den folgenden Rollenfunktionseintrag:</span><span class="sxs-lookup"><span data-stu-id="9bb17-184">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="9bb17-185">Über diese Rollenfunktion können Benutzer jedes beliebige PowerShell-Cmdlet mit dem Namen „Process“ aus dem Microsoft.PowerShell.Management-Modul ausführen.</span><span class="sxs-lookup"><span data-stu-id="9bb17-185">This role capability allows users to run any PowerShell cmdlet with the noun "Process" from the Microsoft.PowerShell.Management module.</span></span>
<span data-ttu-id="9bb17-186">Benutzer benötigen möglicherweise Zugriff auf Cmdlets wie `Get-Process`, um zu erfahren, welche Anwendungen auf dem System ausgeführt werden, oder auf `Stop-Process`, um Anwendungen zu beenden, die nicht mehr reagieren.</span><span class="sxs-lookup"><span data-stu-id="9bb17-186">Users may need to access cmdlets like `Get-Process` to understand what applications are running on the system and `Stop-Process` to kill any applications that are not responding.</span></span>
<span data-ttu-id="9bb17-187">Der Eintrag ermöglicht aber auch den Befehl `Start-Process`, um ein beliebiges Programm mit vollständigen Administratorberechtigungen zu starten.</span><span class="sxs-lookup"><span data-stu-id="9bb17-187">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span>
<span data-ttu-id="9bb17-188">Das Programm muss nicht zwangsläufig lokal auf dem System installiert werden. Ein Angreifer könnte einfach ein Programm auf einer Dateifreigabe starten, die dem Benutzer, der eine Verbindung herstellt, lokale Administratorrechte gibt und die Ausführung von Malware und vieles mehr ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="9bb17-188">The program doesn't need to be installed locally on the system, so an adversary could simply start a program on a file share that gives the connecting user local admin privileges, runs malware, and more.'</span></span>

<span data-ttu-id="9bb17-189">Eine sicherere Version der gleichen Rollenfunktion würde so aussehen:</span><span class="sxs-lookup"><span data-stu-id="9bb17-189">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="9bb17-190">Vermeiden Sie Platzhalter in Rollenfunktionen, und gewährleisten Sie, dass effektive Benutzerberechtigungen regelmäßig überwacht werden (siehe [Überwachung und Berichterstellung zu JEA](audit-and-report.md#check-effective-rights-for-a-specific-user)), damit Sie wissen, auf welche Befehle ein Benutzer Zugriff hat.</span><span class="sxs-lookup"><span data-stu-id="9bb17-190">Avoid using wildcards in role capabilities, and be sure to [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) regularly to understand which commands a user has access to.</span></span>

## <a name="jea-does-not-protect-against-admins"></a><span data-ttu-id="9bb17-191">JEA bietet keinen Schutz vor Administratoren</span><span class="sxs-lookup"><span data-stu-id="9bb17-191">JEA does not protect against admins</span></span>

<span data-ttu-id="9bb17-192">Eines der wichtigsten Prinzipien von JEA ist, dass auch Nichtadministratoren *gewisse* Administratoraufgaben ausführen können.</span><span class="sxs-lookup"><span data-stu-id="9bb17-192">One of the core principles of JEA is that it allows non-admins to perform *some* admin tasks.</span></span>
<span data-ttu-id="9bb17-193">JEA bietet keinen Schutz vor Benutzern, die bereits über Administratorberechtigungen verfügen.</span><span class="sxs-lookup"><span data-stu-id="9bb17-193">JEA does not protect against those who already have administrator privileges.</span></span>
<span data-ttu-id="9bb17-194">Benutzer, die „Domänen-Admins“, „lokalen Administratoren“ oder anderen hoch privilegierten Gruppen in Ihrer Umgebung angehören, können JEA-Schutzmaßnahmen weiterhin umgehen, indem sie sich auf andere Weise beim Computer anmelden.</span><span class="sxs-lookup"><span data-stu-id="9bb17-194">Users who belong "domain admins," "local admins," or other highly privileged groups in your environment will still be able to get around JEA's protections by signing into the machine via another means.</span></span>
<span data-ttu-id="9bb17-195">Sie könnten sich z.B. mit RDP anmelden, Remote-MMC-Konsolen verwenden oder eine Verbindung zu uneingeschränkten PowerShell-Endpunkten herstellen.</span><span class="sxs-lookup"><span data-stu-id="9bb17-195">They could, for example, sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span>
<span data-ttu-id="9bb17-196">Lokale Administratoren auf dem System können JEA-Konfigurationen ebenfalls ändern und zusätzlichen Benutzern Berechtigungen zur Verwaltung des Systems oder zur Änderung von Rollenfunktionen geben, um den Spielraum von Benutzern in ihrer JEA-Sitzung zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="9bb17-196">Local admins on the system can also modify JEA configurations to allow additional users to manage the system or change a role capability to extend the scope of what a user can do in their JEA session.</span></span>
<span data-ttu-id="9bb17-197">Sie sollten daher die erweiterten Berechtigungen Ihrer JEA-Benutzer unbedingt überprüfen, um festzustellen, ob sie sich auf andere Art und Weise einen privilegierten Zugriff auf das System verschaffen könnten.</span><span class="sxs-lookup"><span data-stu-id="9bb17-197">It is therefore important to evaluate your JEA users' extended permissions to see if there are other ways they could gain privileged access to the system.</span></span>

<span data-ttu-id="9bb17-198">Üblicherweise wird JEA für regelmäßige tägliche Wartungsaufgaben verwendet. Benutzer können dank dieser privilegierten Just-in-Time-Zugriffsverwaltungslösung in Notfallsituationen vorübergehend zu lokalen Administratoren werden.</span><span class="sxs-lookup"><span data-stu-id="9bb17-198">A common practice is to use JEA for regular day-to-day maintenance and have a "just in time" privileged access management solution allow users to temporarily become local admins in emergency situations.</span></span>
<span data-ttu-id="9bb17-199">Dadurch wird sichergestellt, dass Benutzer nicht zu permanenten Administratoren auf dem System werden. Sie erhalten diese Berechtigung nur dann, wenn sie einen Workflow ausführen, der die Verwendung dieser Berechtigungen dokumentiert.</span><span class="sxs-lookup"><span data-stu-id="9bb17-199">This helps ensure users are not permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>